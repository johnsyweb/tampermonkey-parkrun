{
  "w-index.user.js": {
    "name": "parkrun Wilson index display",
    "description": "The \"Wilson index\" in parkrun is the highest consecutive event number completed, starting from #1. This script calculates and displays a parkrunner's Wilson index on their results page.",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/w-index.user.js",
    "bookmarklet": "javascript:function _regenerator(){var y,t=\"function\"==typeof Symbol?Symbol:{},e=t.iterator||\"@@iterator\",r=t.toStringTag||\"@@toStringTag\";function n(t,e,r,n){var o,a,i,l,s,c,u,d,f,e=e&&e.prototype instanceof m?e:m,e=Object.create(e.prototype);return _regeneratorDefine2(e,\"_invoke\",(o=t,a=r,u=n||[],d=!1,f={p:c=0,n:0,v:y,a:p,f:p.bind(y,4),d:function(t,e){return i=t,l=0,s=y,f.n=e,h}},function(t,e,r){if(1<c)throw TypeError(\"Generator is already running\");for(d&&1===e&&p(e,r),l=e,s=r;(g=l<2?y:s)||!d;){i||(l?l<3?(1<l&&(f.n=-1),p(l,s)):f.n=s:f.v=s);try{if(c=2,i){if(g=i[t=l?t:\"next\"]){if(!(g=g.call(i,s)))throw TypeError(\"iterator result is not an object\");if(!g.done)return g;s=g.value,l<2&&(l=0)}else 1===l&&(g=i.return)&&g.call(i),l<2&&(s=TypeError(\"The iterator does not provide a '\"+t+\"' method\"),l=1);i=y}else if((g=(d=f.n<0)?s:o.call(a,f))!==h)break}catch(t){i=y,l=1,s=t}finally{c=1}}return{value:g,done:d}}),!0),e;function p(t,e){for(l=t,s=e,g=0;!d&&c&&!r&&g<u.length;g++){var r,n=u[g],o=f.p,a=n[2];3<t?(r=a===e)&&(s=n[(l=n[4])?5:l=3],n[4]=n[5]=y):n[0]<=o&&((r=t<2&&o<n[1])?(l=0,f.v=e,f.n=n[1]):o<a&&(r=t<3||n[0]>e||a<e)&&(n[4]=t,n[5]=e,f.n=a,l=0))}if(r||1<t)return h;throw d=!0,e}}var h={};function m(){}function o(){}function a(){}var g=Object.getPrototypeOf,t=[][e]?g(g([][e]())):(_regeneratorDefine2(g={},e,function(){return this}),g),i=a.prototype=m.prototype=Object.create(t);function l(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,_regeneratorDefine2(t,r,\"GeneratorFunction\")),t.prototype=Object.create(i),t}return _regeneratorDefine2(i,\"constructor\",o.prototype=a),_regeneratorDefine2(a,\"constructor\",o),_regeneratorDefine2(a,r,o.displayName=\"GeneratorFunction\"),_regeneratorDefine2(i),_regeneratorDefine2(i,r,\"Generator\"),_regeneratorDefine2(i,e,function(){return this}),_regeneratorDefine2(i,\"toString\",function(){return\"[object Generator]\"}),(_regenerator=function(){return{w:n,m:l}})()}function _regeneratorDefine2(t,e,r,n){var a=Object.defineProperty;try{a({},\"\",{})}catch(t){a=0}(_regeneratorDefine2=function(t,e,r,n){function o(e,r){_regeneratorDefine2(t,e,function(t){return this._invoke(e,r,t)})}e?a?a(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(o(\"next\",0),o(\"throw\",1),o(\"return\",2))})(t,e,r,n)}function asyncGeneratorStep(t,e,r,n,o,a,i){try{var l=t[a](i),s=l.value}catch(t){return void r(t)}l.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(l){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=l.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,\"next\",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,\"throw\",t)}o(void 0)})}}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _iterableToArray(t){if(\"undefined\"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t[\"@@iterator\"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var r,n,o,a,i=\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(i)return o=!(n=!0),{s:function(){i=i.call(t)},n:function(){var t=i.next();return n=t.done,t},e:function(t){o=!0,r=t},f:function(){try{n||null==i.return||i.return()}finally{if(o)throw r}}};if(Array.isArray(t)||(i=_unsupportedIterableToArray(t))||e&&t&&\"number\"==typeof t.length)return i&&(t=i),a=0,{s:e=function(){},n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:e};throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(t,e){var r;if(t)return\"string\"==typeof t?_arrayLikeToArray(t,e):\"Map\"===(r=\"Object\"===(r={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||\"Set\"===r?Array.from(t):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}(()=>{function c(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:7,n=null,o=_createForOfIteratorHelper(t.querySelectorAll('[id=\"results\"]'));try{for(o.s();!(e=o.n()).done;){var a=e.value,i=a.querySelector(\"tr\");if(i)if(i.querySelectorAll(\"th, td\").length===r){n=a;break}}}catch(t){o.e(t)}finally{o.f()}return n}function u(t){return Array.from(t.querySelectorAll(\"tbody > tr\")).reverse().map(function(t){var e=t.querySelector(\"td:nth-child(1)\").textContent.trim(),r=t.querySelector(\"td:nth-child(2)\").textContent.trim(),t=t.querySelector(\"td:nth-child(3)\").textContent.trim();return{eventName:e,eventDate:r,eventNumber:parseInt(t,10)}})}function d(t){var e,r=0,n=_createForOfIteratorHelper(t.map(function(t){return t.eventNumber}).sort(function(t,e){return t-e}));try{for(n.s();!(e=n.n()).done;){var o=e.value;if(r+2<=o)break;o===r+1&&r++}}catch(t){n.e(t)}finally{n.f()}return r}function f(t){for(var e=[],r=0;r<t.length;r++){var n=t.slice(0,r+1),o=r+1,a=\"\".concat(t[r].eventName,\" # \").concat(t[r].eventNumber,\" on \").concat(t[r].eventDate),n=d(n);e.push({parkruns:o,event:a,wilsonIndex:n})}return e}function p(){return window.innerWidth<768?{isMobile:!0,spacing:{small:\"10px\",medium:\"15px\"},container:{padding:\"10px\",marginTop:\"10px\"},typography:{wilsonIndex:\"1.2em\",input:\"16px\",button:\"16px\"},chart:{height:\"250px\",fonts:{title:14,axisTitle:12,axisTicks:10,legend:11,tooltipTitle:12,tooltipBody:11}},form:{marginBottom:\"10px\",input:{width:\"calc(100% - 20px)\",maxWidth:\"300px\",padding:\"8px\",marginRight:\"0\"},button:{padding:\"8px 15px\",width:\"calc(100% - 20px)\",maxWidth:\"300px\"},layout:{display:\"flex\",flexDirection:\"column\",gap:\"10px\",alignItems:\"center\"}}}:{isMobile:!1,spacing:{small:\"20px\",medium:\"20px\"},container:{padding:\"20px\",marginTop:\"20px\"},typography:{wilsonIndex:\"1.5em\",input:\"inherit\",button:\"inherit\"},chart:{height:\"300px\",fonts:{title:16,axisTitle:14,axisTicks:12,legend:12,tooltipTitle:14,tooltipBody:12}},form:{marginBottom:\"20px\",input:{width:\"300px\",maxWidth:\"300px\",padding:\"5px\",marginRight:\"10px\"},button:{padding:\"5px 10px\",width:\"auto\",maxWidth:\"none\"},layout:{display:\"block\",flexDirection:\"row\",gap:\"0\",alignItems:\"flex-start\"}}}}function y(){return(y=_asyncToGenerator(_regenerator().m(function t(e,r){var n,o,a,i,l=arguments;return _regenerator().w(function(t){for(;;)switch(t.n){case 0:if(n=2<l.length&&void 0!==l[2]?l[2]:36e5,o=sessionStorage.getItem(r))if(i=JSON.parse(o),a=i.data,i=i.timestamp,Date.now()-i<n)return t.a(2,a);t.n=1;break;case 1:return t.a(2,fetch(e).then(function(t){if(t.ok)return t.text();throw new Error(\"Failed to fetch: \".concat(t.status,\" \").concat(t.statusText))}).then(function(t){return sessionStorage.setItem(r,JSON.stringify({data:t,timestamp:Date.now()})),t}).catch(function(t){if(console.error(\"Error fetching \".concat(e,\":\"),t),o)return console.warn(\"Using stale cached data after fetch failure\"),JSON.parse(o).data;throw t}))}},t)}))).apply(this,arguments)}function s(){return(s=_asyncToGenerator(_regenerator().m(function t(e){var r,n,o,a,i,l,s;return _regenerator().w(function(t){for(;;)switch(t.n){case 0:return n=\"parkrunner_\".concat(e,\"_all\"),r=\"\".concat(window.location.origin,\"/parkrunner/\").concat(e,\"/all/\"),t.n=1,function(){return y.apply(this,arguments)}(r,n);case 1:if(r=t.v,n=new DOMParser,o=n.parseFromString(r,\"text/html\"),a=c(o)){t.n=2;break}return console.error(\"Friend results table not found\"),t.a(2,null);case 2:if(i=o.querySelector(\"h2\")){t.n=3;break}return console.error(\"Friend H2 element not found\"),t.a(2,null);case 3:if(l=m(i)){t.n=4;break}return console.error(\"Could not extract friend athlete info\"),t.a(2,null);case 4:return s=u(a),s=f(s),t.a(2,{friendIndices:s,friendInfo:l})}},t)}))).apply(this,arguments)}function h(t,a){var e=p(),r=document.createElement(\"form\"),i=(r.style.marginBottom=e.form.marginBottom,r.style.textAlign=\"center\",r.style.display=e.form.layout.display,r.style.flexDirection=e.form.layout.flexDirection,r.style.gap=e.form.layout.gap,r.style.alignItems=e.form.layout.alignItems,document.createElement(\"input\")),l=(i.style.width=e.form.input.width,i.style.maxWidth=e.form.input.maxWidth,i.type=\"text\",i.placeholder=\"Enter friend's athlete ID (e.g. A507)\",i.style.padding=e.form.input.padding,i.style.marginRight=e.form.input.marginRight,i.style.borderRadius=\"3px\",i.style.border=\"1px solid #ffa300\",i.style.backgroundColor=\"#2b223d\",i.style.color=\"#ffa300\",i.style.fontSize=e.typography.input,document.createElement(\"button\"));l.textContent=\"Compare\",l.style.padding=e.form.button.padding,l.style.width=e.form.button.width,l.style.maxWidth=e.form.button.maxWidth,l.style.backgroundColor=\"#ffa300\",l.style.color=\"#2b223d\",l.style.border=\"none\",l.style.borderRadius=\"3px\",l.style.cursor=\"pointer\",l.style.fontSize=e.typography.button,l.style.fontWeight=\"bold\",r.appendChild(i),r.appendChild(l),r.addEventListener(\"submit\",(()=>{var e=_asyncToGenerator(_regenerator().m(function t(e){var r,n,o;return _regenerator().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e.preventDefault(),r=i.value.trim().replace(/^[aA]/,\"\")){t.n=1;break}return t.a(2);case 1:return l.disabled=!0,l.textContent=\"Loading...\",t.p=2,t.n=3,function(){return s.apply(this,arguments)}(r);case 3:n=t.v,o=n.friendIndices,a(o,n.friendInfo),t.n=5;break;case 4:t.p=4,o=t.v,console.error(\"Failed to fetch friend's results:\",o),alert(\"Failed to fetch friend's results. Please check the ID and try again.\");case 5:return t.p=5,l.disabled=!1,l.textContent=\"Compare\",t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}));return function(t){return e.apply(this,arguments)}})()),t.insertBefore(r,t.firstChild)}function m(t){return t.textContent.trim()}function g(t){var e=[\"#FFA300\",\"#90EE90\",\"#FF69B4\",\"#4169E1\",\"#FFD700\",\"#9370DB\",\"#20B2AA\",\"#FF6347\",\"#DDA0DD\",\"#00CED1\"];return e[t%e.length]}function t(){var t,e,l,r,n,o,a,i,s=c(document);s?(t=document.querySelector(\"h2\"))?(a=m(t))?(r=d(s=u(s)),s=f(s),t&&(n=p(),(e=document.createElement(\"div\")).id=\"w-index-display\",e.style.width=\"100%\",e.style.maxWidth=\"800px\",e.style.margin=\"\".concat(n.container.marginTop,\" auto\"),e.style.backgroundColor=\"#2b223d\",e.style.padding=n.container.padding,e.style.borderRadius=\"5px\",(o=document.createElement(\"div\")).textContent=\"Wilson index: \".concat(r),o.style.fontSize=n.typography.wilsonIndex,o.style.color=\"#ffa300\",o.style.fontWeight=\"bold\",o.style.marginBottom=n.spacing.small,o.style.textAlign=\"center\",e.appendChild(o),r=s,n=e,o=a,s=p(),(a=document.createElement(\"div\")).style.width=\"100%\",a.style.maxWidth=\"100%\",a.style.height=s.chart.height,a.style.position=\"relative\",a.style.boxSizing=\"border-box\",a.style.overflow=\"hidden\",i=document.createElement(\"canvas\"),a.appendChild(i),n.appendChild(a),n=i.getContext(\"2d\"),l=new Chart(n,{type:\"line\",data:{labels:r.map(function(t){return t.parkruns}),datasets:[{label:o,data:r.map(function(t){return{x:t.parkruns,y:t.wilsonIndex,event:t.event}}),borderColor:g(0),backgroundColor:\"#2b223d\"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,title:{display:!0,text:\"Wilson Index\",font:{size:s.chart.fonts.axisTitle}},ticks:{font:{size:s.chart.fonts.axisTicks}},suggestedMax:Math.ceil(1.1*Math.max.apply(Math,_toConsumableArray(r.map(function(t){return t.wilsonIndex}))))},x:{title:{display:!0,text:\"parkruns\",font:{size:s.chart.fonts.axisTitle}},ticks:{font:{size:s.chart.fonts.axisTicks}},min:0,suggestedMax:Math.ceil(1.1*r.length)}},plugins:{title:{display:!0,text:\"Wilson Index Progress\",font:{size:s.chart.fonts.title}},legend:{labels:{font:{size:s.chart.fonts.legend}}},tooltip:{callbacks:{label:function(t){t=t.raw;return[\"Wilson Index: \".concat(t.y),\"Event: \".concat(t.event)]}},titleFont:{size:s.chart.fonts.tooltipTitle},bodyFont:{size:s.chart.fonts.tooltipBody}}}}}),h(e,(()=>{var r=_asyncToGenerator(_regenerator().m(function t(a,i){return _regenerator().w(function(t){for(;;)switch(t.n){case 0:r=a,n=i,o=void 0,o=(e=l).data.datasets.length,n={label:i,data:r.map(function(t){return{x:t.parkruns,y:t.wilsonIndex,event:t.event}}),borderColor:g(o),backgroundColor:\"#2b223d\"},e.data.datasets.push(n),e.update(),r=Math.max.apply(Math,_toConsumableArray(e.data.datasets.flatMap(function(t){return t.data.map(function(t){return t.x})}))),o=Math.max.apply(Math,_toConsumableArray(e.data.datasets.flatMap(function(t){return t.data.map(function(t){return t.y})}))),e.options.scales.x.suggestedMax=Math.ceil(1.1*r),e.options.scales.y.suggestedMax=Math.ceil(1.1*o),e.update();case 1:return t.a(2)}var e,r,n,o},t)}));return function(t,e){return r.apply(this,arguments)}})()),t.parentNode.insertBefore(e,t.nextSibling))):console.error(\"Could not extract athlete info\"):console.error(\"H2 element not found\"):console.error(\"Results table not found\")}\"undefined\"!=typeof module&&module.exports?module.exports={calculateWilsonIndex:d,calculateWilsonIndexOverTime:f,extractEventDetails:u,findResultsTable:c}:t()})();"
  },
  "volunteer-days-display.user.js": {
    "name": "parkrun Volunteer Days Display",
    "description": "Displays the number of volunteer days for parkrun finishers on results pages, for celebration purposes (and let's not make assumptions about ratios)",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/volunteer-days-display.user.js",
    "bookmarklet": "javascript:(function(){!function t(){var e,a,o,n;function s(n){var t;e&&((t=Array.from(e.querySelectorAll(\"tr\")).map(function(t,e){return{row:t,index:e}})).sort(function(t,e){var a=parseInt(t.row.getAttribute(\"data-vols\")||\"0\",10),o=parseInt(e.row.getAttribute(\"data-vols\")||\"0\",10);return a===o?t.index-e.index:\"asc\"===n?a-o:o-a}),t.forEach(function(t){return t=t.row,e.appendChild(t)}))}document.querySelector(\"tr[data-vols]\")?(document.querySelectorAll(\"tr[data-vols] > td.Results-table-td.Results-table-td--name > div.detailed\").forEach(function(t){var e,a,o=t.closest(\"tr\").getAttribute(\"data-vols\");o&&0<parseInt(o)&&((e=document.createElement(\"span\")).classList.add(\"spacer\"),e.textContent=\" | \",(a=document.createElement(\"span\")).textContent=\"\".concat(o,\" volunteer day\").concat(\"1\"===o?\"\":\"s\"),a.classList.add(\"volunteer-days\"),(o=t.firstElementChild)?(o.insertAdjacentElement(\"afterend\",e),e.insertAdjacentElement(\"afterend\",a)):t.appendChild(a))}),(n=document.querySelector(\"tr[data-vols]\"))&&(e=n.closest(\"tbody\"),n=document.querySelector('select[name=\"sort\"], .Results-sort select, select.Results-sort, .Results-controls select'))&&(n.querySelector('option[value=\"vols-asc\"]')||(a=new Option(\"Sort by Volunteer days ‚ñ≤\",\"vols-asc\"),o=new Option(\"Sort by Volunteer days ‚ñº\",\"vols-desc\"),n.appendChild(a),n.appendChild(o)),n.dataset.volsSortWired||(n.addEventListener(\"change\",function(t){var e=t.target.value||\"\";\"vols-asc\"!==e&&\"vols-desc\"!==e||(t.cancelable&&t.preventDefault(),\"function\"==typeof t.stopImmediatePropagation&&t.stopImmediatePropagation(),\"function\"==typeof t.stopPropagation&&t.stopPropagation(),s(e.endsWith(\"asc\")?\"asc\":\"desc\"))},!0),n.addEventListener(\"change\",function(t){\"vols-asc\"===(t=t.target.value||\"\")?s(\"asc\"):\"vols-desc\"===t&&s(\"desc\")}),n.dataset.volsSortWired=\"true\"))):setTimeout(t,500)}();})()"
  },
  "visited-countries.user.js": {
    "name": "parkrun Countries Visited",
    "description": "Shows country flag emojis next to parkrunner name for all countries they have completed parkruns in",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/visited-countries.user.js",
    "bookmarklet": "javascript:function _slicedToArray(e,a){return _arrayWithHoles(e)||_iterableToArrayLimit(e,a)||_unsupportedIterableToArray(e,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(e,a){var n;if(e)return\"string\"==typeof e?_arrayLikeToArray(e,a):\"Map\"===(n=\"Object\"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,a):void 0}function _arrayLikeToArray(e,a){(null==a||a>e.length)&&(a=e.length);for(var n=0,t=Array(a);n<a;n++)t[n]=e[n];return t}function _iterableToArrayLimit(e,a){var n=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=n){var t,r,l,o,i=[],u=!0,c=!1;try{if(l=(n=n.call(e)).next,0===a){if(Object(n)!==n)return;u=!1}else for(;!(u=(t=l.call(n)).done)&&(i.push(t.value),i.length!==a);u=!0);}catch(e){c=!0,r=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}(()=>{var e,a,r,n,t,l={at:{flag:\"üá¶üáπ\",name:\"Austria\"},ru:{flag:\"üá∑üá∫\",name:\"Russia\"},au:{flag:\"üá¶üá∫\",name:\"Australia\"},ca:{flag:\"üá®üá¶\",name:\"Canada\"},com:{flag:\"üá∫üá∏\",name:\"United States\"},de:{flag:\"üá©üá™\",name:\"Germany\"},dk:{flag:\"üá©üá∞\",name:\"Denmark\"},fi:{flag:\"üá´üáÆ\",name:\"Finland\"},fr:{flag:\"üá´üá∑\",name:\"France\"},ie:{flag:\"üáÆüá™\",name:\"Ireland\"},is:{flag:\"üáÆüá∏\",name:\"Iceland\"},it:{flag:\"üáÆüáπ\",name:\"Italy\"},jp:{flag:\"üáØüáµ\",name:\"Japan\"},lt:{flag:\"üá±üáπ\",name:\"Lithuania\"},my:{flag:\"üá≤üáæ\",name:\"Malaysia\"},nl:{flag:\"üá≥üá±\",name:\"Netherlands\"},no:{flag:\"üá≥üá¥\",name:\"Norway\"},nz:{flag:\"üá≥üáø\",name:\"New Zealand\"},pl:{flag:\"üáµüá±\",name:\"Poland\"},se:{flag:\"üá∏üá™\",name:\"Sweden\"},sg:{flag:\"üá∏üá¨\",name:\"Singapore\"},uk:{flag:\"üá¨üáß\",name:\"United Kingdom\"},us:{flag:\"üá∫üá∏\",name:\"United States \"},za:{flag:\"üáøüá¶\",name:\"South Africa\"}};function o(e){var e=e.hostname.split(\".\"),a=e[e.length-1];return a=\"com\"===a&&2===e[0].length?e[0]:a}\"undefined\"!=typeof module&&module.exports?module.exports={getCountryCodeFromUrl:o}:(t=(t=document.querySelectorAll(\"#results\"))[t.length-1])?(t.querySelectorAll(\"tr\").forEach(function(e){var a,n,e=e.querySelector('td a[href*=\"parkrun\"]');e&&(a=o(new URL(e.href)),a=l[a])&&((n=document.createElement(\"span\")).textContent=\" \".concat(a.flag),n.title=a.name,n.style.cursor=\"help\",e.appendChild(n))}),t=t,n=new Map,t.querySelectorAll(\"tr\").forEach(function(e){var e=e.querySelector('td a[href*=\"parkrun\"]');e&&(e=o(new URL(e.href)),n.set(e,(n.get(e)||0)+1))}),(t=t=Array.from(n.entries()).sort(function(e,a){var n=(null==(n=l[e[0]])?void 0:n.name)||e[0],e=(null==(e=l[a[0]])?void 0:e.name)||a[0];return n.localeCompare(e)}).map(function(e){var e=_slicedToArray(e,2),a=e[0],e=e[1],n=l[a];return{symbol:n?n.flag:a,name:n?n.name:a.toUpperCase(),count:e}})).length?(e=document.querySelector(\"h2\"))?((a=document.createElement(\"div\")).id=\"countries-visited\",a.style.marginLeft=\"10px\",a.style.fontSize=\"1.8em\",a.style.marginTop=\"5px\",a.title=\"\".concat(t.length,\" Countries visited, according to parkrun's domains. Political boundaries may not be accurate.\"),(r=document.createElement(\"span\")).style.lineHeight=\"1.5\",r.style.display=\"inline-block\",t.forEach(function(e){var a=e.symbol,n=e.name,e=e.count,t=document.createElement(\"span\");t.textContent=a,t.title=\"\".concat(n,\" (\").concat(e,\")\"),t.style.cursor=\"help\",r.appendChild(t),r.appendChild(document.createTextNode(\" \"))}),a.appendChild(r),e.appendChild(a)):console.log(\"No title\"):console.log(\"No countries visited\")):console.log(\"Results table not found\")})();"
  },
  "stopwatch-bingo.user.js": {
    "name": "parkrun Stopwatch Bingo",
    "description": "Visualizes your progress on the stopwatch bingo challenge (collecting seconds 00-59)",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/stopwatch-bingo.user.js",
    "bookmarklet": "javascript:(()=>{var k={backgroundColor:\"#2b223d\",clockBorderColor:\"#FFA300\",clockFaceColor:\"#333\",completedColor:\"#FFA300\",textColor:\"#e0e0e0\",subtleTextColor:\"#cccccc\"};function o(){var t=document.querySelectorAll(\"#results\");return t[t.length-1]}function n(t){for(var e={},o={},n=0,l=0,r=null,a=null,t=t.querySelectorAll(\"tr\"),i=[],c=(t.forEach(function(t){t=t.querySelectorAll(\"td\");if(!(t.length<5)){var e=t[0].textContent.trim(),o=t[1].textContent.trim(),n=t[2].textContent.trim(),t=t[4].textContent.trim();if(t&&n&&o&&e){var l,e=\"\".concat(e,\" # \").concat(n),n=t.match(/(\\d+):(\\d+):(\\d+)/);if(n)l=parseInt(n[3],10);else{n=t.match(/(\\d+):(\\d+)/);if(!n)return;l=parseInt(n[2],10)}i.push({secondValue:l,date:o,event:e,time:t})}}}),i.reverse()),d=0;d<c.length;d++){var s=c[d],p=s.secondValue,u=s.date,m=s.event,s=s.time;if(l++,!(p in e||(e[p]={date:u,event:m,time:s},60!=++n)||a)){o[p]=[{date:a=u,event:r=m,time:s}];break}o[p]||(o[p]=[]),o[p].push({date:u,event:m,time:s})}return{seconds:e,timeData:o,collectedCount:n,totalParkruns:l,dateOfCompletion:a,firstCompleteEvent:r}}function l(g){t=\"Stopwatch Bingo Challenge\",(o=document.createElement(\"div\")).id||(o.id=\"stopwatchBingoContainer\"),o.className=\"parkrun-bingo-container\",o.style.width=\"100%\",o.style.maxWidth=\"800px\",o.style.margin=\"20px auto\",o.style.padding=window.innerWidth<768?\"10px\":\"20px\",o.style.backgroundColor=k.backgroundColor,o.style.borderRadius=\"8px\",o.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",o.style.textAlign=\"center\",(e=document.createElement(\"h3\")).textContent=t,e.style.marginBottom=\"15px\",e.style.color=k.clockBorderColor,e.style.fontSize=window.innerWidth<768?\"1.1em\":\"1.3em\",o.appendChild(e);var t=o,e=window.innerWidth<768,o=document.createElement(\"div\");o.style.marginBottom=e?\"10px\":\"20px\",o.style.color=k.textColor;for(var n=e?\"0.95em\":\"1.1em\",l='<div style=\"font-size: '.concat(e?\"1em\":\"1.2em\",'; margin-bottom: 10px;\"><strong>').concat(g.collectedCount,\" of 60</strong> seconds collected</div>\"),x=(l+='<div style=\"font-size: '.concat(e?\"0.9em\":\"1em\",';\">After ').concat(g.totalParkruns,\" parkruns</div>\"),g.dateOfCompletion&&(l+='<div style=\"margin-top: 10px; font-size: '.concat(n,';\">üèÜ Bingo completed on ').concat(g.dateOfCompletion,\" (\").concat(g.firstCompleteEvent,\")</div>\")),o.innerHTML=l,t.appendChild(o),e?Math.min(320,window.innerWidth-40):500),b=x/500,C=document.createElement(\"div\"),f=(C.style.position=\"relative\",C.style.width=\"\".concat(x,\"px\"),C.style.height=\"\".concat(x,\"px\"),C.style.margin=\"0 auto\",C.style.borderRadius=\"50%\",C.style.border=\"\".concat(Math.round(10*b),\"px solid \").concat(k.clockBorderColor),C.style.backgroundColor=k.clockFaceColor,C.style.boxSizing=\"content-box\",1),r=0;r<60;r++){var a=g.timeData[r]?g.timeData[r].length:0;f<a&&(f=a)}for(var i=function(i){if(!(i in g.seconds))return 1;var t=g.timeData[i]?g.timeData[i].length:0,e=((i-.4)/60*360-90)*(Math.PI/180),o=Math.PI/180*((i+.4)/60*360-90),n=document.createElement(\"div\"),l=(n.style.position=\"absolute\",n.style.top=\"0\",n.style.left=\"0\",n.style.width=\"100%\",n.style.height=\"100%\",n.style.pointerEvents=\"none\",220*b),r=50*b,a=x/2,c=x/2,d=document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\"),s=(d.setAttribute(\"width\",\"100%\"),d.setAttribute(\"height\",\"100%\"),d.style.position=\"absolute\",d.style.top=\"0\",d.style.left=\"0\",d.style.zIndex=\"1\",document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\")),l=r+Math.max(0,Math.round(t/f*(l-r))),p=a+r*Math.cos(e),u=c+r*Math.sin(e),m=a+l*Math.cos(e),e=c+l*Math.sin(e),y=a+l*Math.cos(o),h=c+l*Math.sin(o),a=a+r*Math.cos(o),c=c+r*Math.sin(o),o=[\"M \".concat(p,\",\").concat(u),\"L \".concat(m,\",\").concat(e),\"A \".concat(l,\",\").concat(l,\" 0 0,1 \").concat(y,\",\").concat(h),\"L \".concat(a,\",\").concat(c),\"A \".concat(r,\",\").concat(r,\" 0 0,0 \").concat(p,\",\").concat(u),\"Z\"].join(\" \");s.setAttribute(\"d\",o),s.setAttribute(\"fill\",k.completedColor),s.setAttribute(\"opacity\",\"1\"),s.setAttribute(\"title\",\"\".concat(i.toString().padStart(2,\"0\"),\" Seconds - \").concat(t,\" \").concat(1===t?\"Time\":\"Times\")),s.style.cursor=\"pointer\",s.style.pointerEvents=\"auto\",s.addEventListener(\"click\",function(){var t,e,o,n,l,r,a;t=i,e=g.timeData[i],(o=document.getElementById(\"second-details-popup\"))&&o.remove(),(n=document.createElement(\"div\")).id=\"second-details-popup\",n.style.position=\"fixed\",n.style.top=\"50%\",n.style.left=\"50%\",n.style.transform=\"translate(-50%, -50%)\",n.style.width=\"400px\",n.style.maxHeight=\"500px\",n.style.overflowY=\"auto\",n.style.backgroundColor=k.backgroundColor,n.style.borderRadius=\"8px\",n.style.padding=\"20px\",n.style.boxShadow=\"0 0 20px rgba(0, 0, 0, 0.5)\",n.style.zIndex=\"1000\",n.style.color=k.textColor,(o=document.createElement(\"div\")).textContent=\"‚úï\",o.style.position=\"absolute\",o.style.top=\"10px\",o.style.right=\"15px\",o.style.fontSize=\"20px\",o.style.cursor=\"pointer\",o.addEventListener(\"click\",function(){return n.remove()}),n.appendChild(o),(o=document.createElement(\"h3\")).textContent=\"\".concat(t.toString().padStart(2,\"0\"),\" Seconds - \").concat(e.length,\" Times\"),o.style.marginBottom=\"15px\",o.style.color=k.clockBorderColor,n.appendChild(o),(t=document.createElement(\"table\")).style.width=\"100%\",t.style.borderCollapse=\"collapse\",t.style.marginTop=\"10px\",o=document.createElement(\"thead\"),l=document.createElement(\"tr\"),[{title:\"Date\",align:\"left\"},{title:\"Event\",align:\"left\"},{title:\"Time\",align:\"left\"}].forEach(function(t){var e=document.createElement(\"th\");e.textContent=t.title,e.style.textAlign=t.align,e.style.padding=\"8px\",e.style.borderBottom=\"1px solid #555\",l.appendChild(e)}),o.appendChild(l),t.appendChild(o),r=document.createElement(\"tbody\"),e.forEach(function(t,e){var o=document.createElement(\"tr\"),e=(o.style.backgroundColor=0===e?\"rgba(255, 163, 0, 0.2)\":\"transparent\",[{content:t.date},{content:t.event},{content:t.time}].map(function(t){return'<td style=\"padding: 8px; border-bottom: 1px solid #444;\">'.concat(t.content,\"</td>\")}).join(\"\"));o.innerHTML=e,r.appendChild(o)}),t.appendChild(r),n.appendChild(t),document.body.appendChild(n),(a=document.createElement(\"div\")).style.position=\"fixed\",a.style.top=\"0\",a.style.left=\"0\",a.style.width=\"100%\",a.style.height=\"100%\",a.style.backgroundColor=\"rgba(0, 0, 0, 0.5)\",a.style.zIndex=\"999\",a.addEventListener(\"click\",function(){n.remove(),a.remove()}),document.body.appendChild(a)}),d.appendChild(s),n.appendChild(d),C.appendChild(n)},c=0;c<60;c++)i(c);var d=document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\");d.setAttribute(\"width\",\"100%\"),d.setAttribute(\"height\",\"100%\"),d.style.position=\"absolute\",d.style.top=\"0\",d.style.left=\"0\",d.style.pointerEvents=\"none\",d.style.zIndex=\"2\";for(var s=0;s<60;s+=5){var p=(s/60*360-90)*(Math.PI/180),u=245*b,m=(s%15==0?210:225)*b,y=x/2,h=x/2,v=document.createElementNS(\"http://www.w3.org/2000/svg\",\"line\"),u=(v.setAttribute(\"x1\",y+m*Math.cos(p)),v.setAttribute(\"y1\",h+m*Math.sin(p)),v.setAttribute(\"x2\",y+u*Math.cos(p)),v.setAttribute(\"y2\",h+u*Math.sin(p)),v.setAttribute(\"stroke\",k.textColor),v.setAttribute(\"stroke-width\",(s%15==0?3:2)*b),d.appendChild(v),m-(s%15==0?25:20)*b),v=y+u*Math.cos(p),m=h+u*Math.sin(p),y=document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\");y.setAttribute(\"x\",v),y.setAttribute(\"y\",m),y.setAttribute(\"fill\",k.textColor),y.setAttribute(\"font-size\",\"\".concat((s%15==0?16:14)*b,\"px\")),y.setAttribute(\"font-weight\",\"bold\"),y.setAttribute(\"text-anchor\",\"middle\"),y.setAttribute(\"dominant-baseline\",\"middle\"),y.textContent=s.toString(),d.appendChild(y)}C.appendChild(d);var w,E,n=document.createElement(\"div\"),n=(n.style.position=\"absolute\",n.style.top=\"50%\",n.style.left=\"50%\",n.style.transform=\"translate(-50%, -50%)\",n.style.width=\"\".concat(100*b,\"px\"),n.style.height=\"\".concat(100*b,\"px\"),n.style.borderRadius=\"50%\",n.style.backgroundColor=k.clockBorderColor,n.style.display=\"flex\",n.style.justifyContent=\"center\",n.style.alignItems=\"center\",n.style.color=k.backgroundColor,n.style.fontWeight=\"bold\",n.style.fontSize=\"\".concat(20*b,\"px\"),n.style.zIndex=\"3\",n.textContent=\"\".concat(Math.round(g.collectedCount/60*100),\"%\"),C.appendChild(n),t.appendChild(C),w=t,l=window.innerWidth<768,(o=document.createElement(\"div\")).style.marginTop=l?\"10px\":\"15px\",o.id=\"bingo-download-btn-container\",(E=document.createElement(\"button\")).textContent=\"üíæ Save as Image\",E.style.padding=l?\"6px 12px\":\"8px 15px\",E.style.backgroundColor=k.clockBorderColor,E.style.color=k.backgroundColor,E.style.border=\"none\",E.style.borderRadius=\"4px\",E.style.cursor=\"pointer\",E.style.fontWeight=\"bold\",E.style.fontSize=l?\"0.9em\":\"1em\",E.addEventListener(\"mouseover\",function(){this.style.backgroundColor=\"#e59200\"}),E.addEventListener(\"mouseout\",function(){this.style.backgroundColor=k.clockBorderColor}),E.addEventListener(\"click\",function(){E.style.display=\"none\",html2canvas(w,{backgroundColor:k.backgroundColor,scale:2,logging:!1,allowTaint:!0,useCORS:!0}).then(function(t){E.style.display=\"block\";var e=document.createElement(\"a\"),o=(new Date).toISOString().split(\"T\")[0],n=window.location.pathname.split(\"/\")[2]||\"parkrunner\";e.download=\"stopwatch-bingo-\".concat(n,\"-\").concat(o,\".png\"),e.href=t.toDataURL(\"image/png\"),e.click()})}),o.appendChild(E),w.appendChild(o),document.createElement(\"div\"));return n.style.marginTop=e?\"10px\":\"20px\",n.style.color=k.subtleTextColor,n.style.fontSize=e?\"0.8em\":\"0.9em\",n.style.padding=e?\"0 5px\":\"0\",n.innerHTML=\"Stopwatch Bingo: collect finish times with every second from 00-59.<br>Orange segments show seconds you've collected. Segment length indicates frequency.<br>Click on any segment to see details.\",t.appendChild(n),t}function t(){var t,e;document.querySelector(\"#results\")?document.querySelector(\"h2\")&&(t=l(n(o())),t=t,e=document.querySelector(\"h2\"))&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)):console.log(\"Results table not found\")}\"undefined\"!=typeof module&&module.exports?module.exports={findResultsTable:o,extractFinishTimes:n}:t()})();"
  },
  "position-bingo.user.js": {
    "name": "parkrun Position Bingo Challenge",
    "description": "Tracks progress on the unofficial parkrun position bingo challenge (last two digits of position) with a 10x10 grid visualization and detailed event info.",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/position-bingo.user.js",
    "bookmarklet": "javascript:function _createForOfIteratorHelper(e,t){var n,o,i,r,a=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(a)return i=!(o=!0),{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){i=!0,n=e},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw n}}};if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&\"number\"==typeof e.length)return a&&(e=a),r=0,{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t};throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(e,t){var n;if(e)return\"string\"==typeof e?_arrayLikeToArray(e,t):\"Map\"===(n=\"Object\"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}(()=>{var e,t,c=100;function p(){return window.innerWidth<768?{isMobile:!0,container:{padding:\"10px\",marginTop:\"10px\"},typography:{heading:\"1.1em\",stats:\"1em\",statsSubtext:\"0.9em\"},grid:{boxSize:28,gapSize:3,cellFontSize:\"0.7em\",cellPadding:\"1px\",positionFontSize:\"0.9em\",eventFontSize:\"0.65em\",dateFontSize:\"0.6em\"},button:{padding:\"6px 12px\",fontSize:\"0.9em\",marginTop:\"10px\"}}:{isMobile:!1,container:{padding:\"20px\",marginTop:\"20px\"},typography:{heading:\"1.3em\",stats:\"1.2em\",statsSubtext:\"1em\"},grid:{boxSize:100,gapSize:5,cellFontSize:\"0.9em\",cellPadding:\"2px\",positionFontSize:\"1.2em\",eventFontSize:\"0.8em\",dateFontSize:\"0.7em\"},button:{padding:\"8px 15px\",fontSize:\"1em\",marginTop:\"15px\"}}}function n(r){for(var e,i,n=p(),t=document.createElement(\"div\"),o=(t.id=\"positionBingoContainer\",t.className=\"parkrun-position-bingo-container\",t.style.width=\"100%\",t.style.maxWidth=\"1200px\",t.style.margin=\"\".concat(n.container.marginTop,\" auto\"),t.style.padding=n.container.padding,t.style.backgroundColor=\"#2b223d\",t.style.borderRadius=\"8px\",t.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",t.style.color=\"#e0e0e0\",t.style.textAlign=\"center\",document.createElement(\"h3\")),o=(o.textContent=\"Position Bingo Challenge\",o.style.marginBottom=n.isMobile?\"8px\":\"10px\",o.style.color=\"#FFA300\",o.style.fontSize=n.typography.heading,t.appendChild(o),document.createElement(\"div\")),o=(o.innerHTML='<div style=\"font-size: '.concat(n.typography.stats,\"; margin-bottom: \").concat(n.isMobile?\"8px\":\"10px\",';\">')+\"<strong>\"+r.completedCount+\" of \"+c+\"</strong> positions completed</div>\"+'<div style=\"font-size: '.concat(n.typography.statsSubtext,';\">After ')+r.totalEvents+\" parkruns</div>\",t.appendChild(o),Math.ceil(c/10)),a=n.grid.boxSize,l=n.grid.gapSize,s=document.createElement(\"div\"),d=(s.style.display=\"grid\",s.style.gridTemplateColumns=\"repeat(\".concat(10,\", \").concat(a,\"px)\"),s.style.gridTemplateRows=\"repeat(\".concat(o,\", \").concat(a,\"px)\"),s.style.gap=\"\".concat(l,\"px\"),s.style.margin=\"0 auto\",s.style.justifyContent=\"center\",0);d<c;d++)(o=>{var e=document.createElement(\"div\"),t=(e.style.boxSizing=\"border-box\",e.style.border=\"1px solid #666\",e.style.borderRadius=\"4px\",e.style.backgroundColor=r.completedPositions[o]?\"#FFA300\":\"#008080\",e.style.color=\"#fff\",e.style.textAlign=\"left\",e.style.padding=n.grid.cellPadding,e.style.fontWeight=\"bold\",e.style.fontSize=n.grid.cellFontSize,e.style.cursor=r.completedPositions[o]?\"pointer\":\"default\",e.style.aspectRatio=\"1\",document.createElement(\"div\"));t.textContent=o.toString().padStart(2,\"0\"),t.style.fontSize=n.grid.positionFontSize,t.style.marginBottom=n.isMobile?\"2px\":\"5px\",e.appendChild(t),r.completedPositions[o]&&((t=document.createElement(\"div\")).innerHTML='<div style=\"font-size: '.concat(n.grid.eventFontSize,'; text-align: center;\">')+r.completedPositions[o][0].eventName+\"<br>\"+'<span style=\"font-size: '.concat(n.grid.dateFontSize,';\">')+r.completedPositions[o][0].date+\" (\"+r.completedPositions[o][0].position+\")</span></div>\",n.isMobile&&(t.style.display=\"none\"),e.appendChild(t),e.addEventListener(\"click\",function(){var e=p(),t=document.createElement(\"div\"),i=(t.style.position=\"fixed\",t.style.top=\"0\",t.style.left=\"0\",t.style.width=\"100%\",t.style.height=\"100%\",t.style.backgroundColor=\"rgba(0, 0, 0, 0.5)\",t.style.zIndex=\"999\",t.addEventListener(\"click\",function(){document.body.removeChild(t)}),document.createElement(\"div\")),n=(i.style.position=\"fixed\",i.style.top=\"50%\",i.style.left=\"50%\",i.style.transform=\"translate(-50%, -50%)\",i.style.backgroundColor=\"#2b223d\",i.style.color=\"#fff\",e.isMobile?\"15px\":\"20px\"),n=(i.style.padding=n,i.style.borderRadius=\"8px\",i.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.5)\",i.style.zIndex=\"1000\",i.style.maxWidth=e.isMobile?\"95%\":\"90%\",i.style.maxHeight=e.isMobile?\"85%\":\"80%\",i.style.overflowY=\"auto\",i.style.fontSize=e.isMobile?\"0.9em\":\"1em\",document.createElement(\"h4\"));n.textContent=\"Position \".concat(o.toString().padStart(2,\"0\")),n.style.marginBottom=\"10px\",n.style.color=\"#FFA300\",i.appendChild(n),r.completedPositions[o].forEach(function(e){var t=e.eventName,n=e.date,e=e.position,o=document.createElement(\"div\");o.style.marginBottom=\"10px\",o.innerHTML=\"<strong>\"+t+'</strong><br><span style=\"font-size: 0.9em;\">'+n+\" (\"+e+\")</span>\",i.appendChild(o)}),t.appendChild(i),document.body.appendChild(t)})),s.appendChild(e)})(d);return t.appendChild(s),e=t,o=p(),(a=document.createElement(\"div\")).style.marginTop=o.button.marginTop,a.id=\"position-bingo-download-btn-container\",(i=document.createElement(\"button\")).textContent=\"üíæ Save as Image\",i.style.padding=o.button.padding,i.style.backgroundColor=\"#FFA300\",i.style.color=\"#2b223d\",i.style.border=\"none\",i.style.borderRadius=\"4px\",i.style.cursor=\"pointer\",i.style.fontWeight=\"bold\",i.style.fontSize=o.button.fontSize,i.addEventListener(\"mouseover\",function(){this.style.backgroundColor=\"#e59200\"}),i.addEventListener(\"mouseout\",function(){this.style.backgroundColor=\"#FFA300\"}),i.addEventListener(\"click\",function(){i.style.display=\"none\",html2canvas(e,{backgroundColor:\"#2b223d\",scale:2,logging:!1,allowTaint:!0,useCORS:!0}).then(function(e){i.style.display=\"block\";var t=document.createElement(\"a\"),n=(new Date).toISOString().split(\"T\")[0],o=window.location.pathname.split(\"/\")[2]||\"parkrunner\";t.download=\"position-bingo-\".concat(o,\"-\").concat(n,\".png\"),t.href=e.toDataURL(\"image/png\"),t.click()})}),a.appendChild(i),e.appendChild(a),t}(t=(t=document.querySelectorAll(\"#results\"))[t.length-1])?(t=t=n((e=>{var t,n={},o=0,i=_createForOfIteratorHelper(Array.from(e.querySelectorAll(\"tr\")).reverse());try{for(i.s();!(t=i.n()).done;){var r=t.value.querySelectorAll(\"td\");if(!(r.length<5)){var a=r[3].textContent.trim(),l=parseInt(a.slice(-2),10),s=r[0].textContent.trim(),d=r[1].textContent.trim();if(!isNaN(l)&&0<=l&&l<c&&(n[l]||(n[l]=[]),n[l].push({eventName:s,date:d,position:a}),Object.keys(n).length===c))break;o++}}}catch(e){i.e(e)}finally{i.f()}return{completedPositions:n,remainingPositions:Array.from({length:c},function(e,t){return t}).filter(function(e){return!n[e]}),completedCount:Object.keys(n).length,totalEvents:o}})(t)),(e=document.querySelector(\"h2\"))&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t))):console.log(\"Results table not found\")})();"
  },
  "parkrun-walker-analysis.user.js": {
    "name": "parkrun Walker Analysis",
    "description": "Highlight and summarize walkers (>=10:00/km) and compare with faster participants on parkrun results pages.",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/parkrun-walker-analysis.user.js",
    "bookmarklet": "javascript:function _typeof(e){return(_typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function _regenerator(){var m,e=\"function\"==typeof Symbol?Symbol:{},t=e.iterator||\"@@iterator\",n=e.toStringTag||\"@@toStringTag\";function r(e,t,n,r){var o,i,a,l,u,c,s,d,p,t=t&&t.prototype instanceof g?t:g,t=Object.create(t.prototype);return _regeneratorDefine2(t,\"_invoke\",(o=e,i=n,s=r||[],d=!1,p={p:c=0,n:0,v:m,a:f,f:f.bind(m,4),d:function(e,t){return a=e,l=0,u=m,p.n=t,y}},function(e,t,n){if(1<c)throw TypeError(\"Generator is already running\");for(d&&1===t&&f(t,n),l=t,u=n;(b=l<2?m:u)||!d;){a||(l?l<3?(1<l&&(p.n=-1),f(l,u)):p.n=u:p.v=u);try{if(c=2,a){if(b=a[e=l?e:\"next\"]){if(!(b=b.call(a,u)))throw TypeError(\"iterator result is not an object\");if(!b.done)return b;u=b.value,l<2&&(l=0)}else 1===l&&(b=a.return)&&b.call(a),l<2&&(u=TypeError(\"The iterator does not provide a '\"+e+\"' method\"),l=1);a=m}else if((b=(d=p.n<0)?u:o.call(i,p))!==y)break}catch(e){a=m,l=1,u=e}finally{c=1}}return{value:b,done:d}}),!0),t;function f(e,t){for(l=e,u=t,b=0;!d&&c&&!n&&b<s.length;b++){var n,r=s[b],o=p.p,i=r[2];3<e?(n=i===t)&&(u=r[(l=r[4])?5:l=3],r[4]=r[5]=m):r[0]<=o&&((n=e<2&&o<r[1])?(l=0,p.v=t,p.n=r[1]):o<i&&(n=e<3||r[0]>t||i<t)&&(r[4]=e,r[5]=t,p.n=i,l=0))}if(n||1<e)return y;throw d=!0,t}}var y={};function g(){}function o(){}function i(){}var b=Object.getPrototypeOf,e=[][t]?b(b([][t]())):(_regeneratorDefine2(b={},t,function(){return this}),b),a=i.prototype=g.prototype=Object.create(e);function l(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,_regeneratorDefine2(e,n,\"GeneratorFunction\")),e.prototype=Object.create(a),e}return _regeneratorDefine2(a,\"constructor\",o.prototype=i),_regeneratorDefine2(i,\"constructor\",o),_regeneratorDefine2(i,n,o.displayName=\"GeneratorFunction\"),_regeneratorDefine2(a),_regeneratorDefine2(a,n,\"Generator\"),_regeneratorDefine2(a,t,function(){return this}),_regeneratorDefine2(a,\"toString\",function(){return\"[object Generator]\"}),(_regenerator=function(){return{w:r,m:l}})()}function _regeneratorDefine2(e,t,n,r){var i=Object.defineProperty;try{i({},\"\",{})}catch(e){i=0}(_regeneratorDefine2=function(e,t,n,r){function o(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o(\"next\",0),o(\"throw\",1),o(\"return\",2))})(e,t,n,r)}function asyncGeneratorStep(e,t,n,r,o,i,a){try{var l=e[i](a),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(l){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=l.apply(e,a);function o(e){asyncGeneratorStep(r,t,n,o,i,\"next\",e)}function i(e){asyncGeneratorStep(r,t,n,o,i,\"throw\",e)}o(void 0)})}}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,\"string\");return\"symbol\"==_typeof(e)?e:e+\"\"}function _toPrimitive(e,t){if(\"object\"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return(\"string\"===t?String:Number)(e);n=n.call(e,t||\"default\");if(\"object\"!=_typeof(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}var ChartRef=\"undefined\"!=typeof window&&window.Chart?window.Chart:void 0;function assignUnknownFinishTimes(o){return o.map(function(e,t){var n,r;return e.timeStr&&0<e.timeSec?e:(n=(n=(n=o).slice(0,t).reverse().find(function(e){return e.timeStr&&0<e.timeSec}))?n.timeSec:null,t=(r=(r=o).slice(t+1).find(function(e){return e.timeStr&&0<e.timeSec}))?r.timeSec:null,r=n||t||0,_objectSpread(_objectSpread({},e),{},{timeSec:r,estimatedTime:0<r}))})}function getEventMetadata(){var e,t=\"\",n=\"\",r=\"\",o=\"undefined\"!=typeof document?document.querySelector(\"h1\"):null,o=(o?t=o.textContent.trim():\"undefined\"!=typeof document&&document.title&&(t=document.title.split(\"-\")[0].trim()),\"undefined\"!=typeof document?document.querySelector(\"h3\"):null);return o&&((e=(o=o.textContent).match(/(\\d{1,2}\\/\\d{1,2}\\/\\d{2,4})/))&&(n=e[1]),e=o.match(/#(\\d+)/))&&(r=e[1]),{eventName:t,eventDate:n,eventNumber:r}}function generateExportFilename(e,t){var n=e.eventName?e.eventName.replace(/[^a-z0-9]+/gi,\"\").toLowerCase():\"event\",r=e.eventDate?e.eventDate.replace(/\\//g,\"_\"):\"date\",e=e.eventNumber||\"num\";return\"\".concat(n,\"_\").concat(r,\"_\").concat(e,\"_\").concat(t,\".png\")}function computeWalkerThreshold(e){var t=5;try{\"string\"==typeof e&&e&&e.toLowerCase().includes(\"-juniors\")&&(t=2)}catch(e){}return 10*t*60}function parkrunWalkerAnalysisMain(){var _,T,N,D,O,V,j,e=Array.from(document.querySelectorAll(\"tr.Results-table-row\"));function d(e,t){for(var n=0,r=[1e3,500,250,100,50,25,10];n<r.length;n++){var o=r[n];if(o<=e)return{status:\"\".concat(t,\" \").concat(o,\" Club\"),milestone:o}}return{status:null,milestone:0}}function M(){j.innerHTML=\"Breakdown: \"+N.map(function(e){return'<button style=\"margin:0 8px;padding:6px 12px;border-radius:4px;border:none;background:'.concat(D===e.key?\"#FFA300\":\"#00CEAE\",';color:#2b223d;font-weight:bold;cursor:pointer;\" data-key=\"').concat(e.key,'\">').concat(e.label,\"</button>\")}).join(\"\"),j.querySelectorAll(\"button\").forEach(function(t){t.onclick=function(){var e;e=t.getAttribute(\"data-key\"),D=e,n()}})}function n(){M();for(var o,r,n,i,a,t,l,u,c,s,d,p,f,e=document.getElementById(\"walkerRunnerSummaryTable\"),m=(e||((e=document.createElement(\"div\")).id=\"walkerRunnerSummaryTable\"),e.innerHTML=(o=D,t=computeWalkerThreshold(\"undefined\"!=typeof document&&document.location?document.location.href:\"\"),l=_.filter(function(e){return e.timeSec>=t}),u=_.filter(function(e){return 0<e.timeSec&&e.timeSec<t}),c=l.length,s=u.length,d=new Set,l.forEach(function(e){return d.add(e[o]||\"Unknown\")}),u.forEach(function(e){return d.add(e[o]||\"Unknown\")}),g=Array.from(d),\"ageGroup\"===o?((g=g.filter(function(e){return e&&\"Unknown\"!==e&&\"Not specified\"!==e})).sort(function(e,t){e=parseInt((e||\"\").split(\"-\")[0],10),t=parseInt((t||\"\").split(\"-\")[0],10);return isNaN(e)?1:isNaN(t)?-1:e-t}),d.has(\"Not specified\")&&g.push(\"Not specified\"),d.has(\"Unknown\")&&g.push(\"Unknown\")):\"parkrunExperience\"===o?(r=[\"First Timer (anywhere)\",\"First Timer (to this event)\",\"Multiple parkruns\",\"parkrun 10 Club\",\"parkrun 25 Club\",\"parkrun 50 Club\",\"parkrun 100 Club\",\"parkrun 250 Club\",\"parkrun 500 Club\",\"parkrun 1000 Club\"],n=function(e){var t,n=r.indexOf(e);return-1!==n?n:(n=e.match(/parkrun (\\d+) Club/))?(n=parseInt(n[1],10),-1!==(t=[10,25,50,100,250,500,1e3].indexOf(n))?3+t:200+n):\"Unknown\"===e?9999:999},g.sort(function(e,t){return n(e)-n(t)})):\"volunteerStatus\"===o?(i=[\"Yet to Volunteer\",\"Volunteered once\",\"Volunteered multiple times\",\"Volunteer 10 Club\",\"Volunteer 25 Club\",\"Volunteer 50 Club\",\"Volunteer 100 Club\",\"Volunteer 250 Club\",\"Volunteer 500 Club\",\"Volunteer 1000 Club\"],a=function(e){var t=i.indexOf(e);return-1!==t?t:(t=e.match(/(\\d+)/))?200+parseInt(t[1],10):\"Has Volunteered\"===e?150:\"Unknown\"===e?9999:999},g.sort(function(e,t){return a(e)-a(t)})):g.sort(),m=(p=c+s)?(c/p*100).toFixed(1):\"0.0\",y=p?(s/p*100).toFixed(1):\"0.0\",f='<div style=\"text-align:center;margin-bottom:0.5em;font-size:1.08em;\">\\n      <strong>Walkers:</strong> '.concat(c,\" (\").concat(m,\"%) &nbsp; | &nbsp; <strong>Runners:</strong> \").concat(s,\" (\").concat(y,\"%) &nbsp; | &nbsp; <strong>Total finishers:</strong> \").concat(p,\"\\n    </div>\"),f+='<table class=\"Results-table\" style=\"margin:1em auto;font-size:1.1em;\">\\n      <thead><tr><th>'.concat(N.find(function(e){return e.key===o}).label,\"</th><th>Walkers (n)</th><th>Walkers (%)</th><th>Runners (n)</th><th>Runners (%)</th><th>Total (n)</th><th>Total (%)</th></tr></thead><tbody>\"),g.forEach(function(t){var e=l.filter(function(e){return(e[o]||\"Unknown\")===t}).length,n=u.filter(function(e){return(e[o]||\"Unknown\")===t}).length,r=e+n;f+=\"<tr><td>\".concat(t,'</td><td style=\"text-align:right\">').concat(e,'</td><td style=\"text-align:right\">').concat(c?(e/c*100).toFixed(1):\"0.0\",'%</td><td style=\"text-align:right\">').concat(n,'</td><td style=\"text-align:right\">').concat(s?(n/s*100).toFixed(1):\"0.0\",'%</td><td style=\"text-align:right\">').concat(r,'</td><td style=\"text-align:right\">').concat(p?(r/p*100).toFixed(1):\"0.0\",\"%</td></tr>\")}),f=f+'<tr style=\"font-weight:bold;\"><td>Total</td><td style=\"text-align:right\">'.concat(c,'</td><td style=\"text-align:right\">100.0%</td><td style=\"text-align:right\">').concat(s,'</td><td style=\"text-align:right\">100.0%</td><td style=\"text-align:right\">').concat(p,'</td><td style=\"text-align:right\">100.0%</td></tr>')+\"</tbody></table>\"),document.getElementById(\"walkerAnalysisContainer\")),y=(m||((m=document.createElement(\"div\")).id=\"walkerAnalysisContainer\",m.style.width=\"100%\",m.style.maxWidth=\"900px\",m.style.margin=\"20px auto\"),m.innerHTML=\"\",document.getElementById(O)),g=(y||((y=document.createElement(\"div\")).id=O),m.appendChild(y),m.appendChild(j),m.appendChild(e),document.querySelector(\"h3\")),b=(g&&g.parentNode?m.parentNode===g.parentNode&&m.previousSibling===g||(g.nextSibling?g.parentNode.insertBefore(m,g.nextSibling):g.parentNode.appendChild(m)):document.body.appendChild(m),D),y=N.find(function(e){return e.key===D}).label,e=O,h=(g=(n=>{var r={},o=1/0,i=0;return _.forEach(function(e){var t;0!==e.timeSec&&(t=Math.floor(e.timeSec/60),o=Math.min(o,t),i=Math.max(i,t),r[t]||(r[t]={}),e=e[n]||\"Unknown\",r[t][e]=(r[t][e]||0)+1)}),{bins:r,minMinute:o,maxMinute:i}})(b)).bins,k=g.maxMinute,v=[],x=g.minMinute;x<=k;x++)v.push(x);var C=new Set,w=(Object.values(h).forEach(function(e){return Object.keys(e).forEach(function(e){return C.add(e)})}),Array.from(C)),E=(w=((e,t)=>{var n,r,o,i,a;return\"ageGroup\"===t?((n=e.filter(function(e){return e&&\"Unknown\"!==e&&\"Not specified\"!==e})).sort(function(e,t){e=parseInt((e||\"\").split(\"-\")[0],10),t=parseInt((t||\"\").split(\"-\")[0],10);return isNaN(e)?1:isNaN(t)?-1:e-t}),e.includes(\"Not specified\")&&n.push(\"Not specified\"),e.includes(\"Unknown\")&&n.push(\"Unknown\"),n):\"parkrunExperience\"===t?(r=[\"First Timer (anywhere)\",\"First Timer (to this event)\",\"Multiple parkruns\",\"parkrun 10 Club\",\"parkrun 25 Club\",\"parkrun 50 Club\",\"parkrun 100 Club\",\"parkrun 250 Club\",\"parkrun 500 Club\",\"parkrun 1000 Club\"],o=function(e){var t,n=r.indexOf(e);return-1!==n?n:(n=e.match(/parkrun (\\d+) Club/))?(n=parseInt(n[1],10),-1!==(t=[10,25,50,100,250,500,1e3].indexOf(n))?3+t:200+n):\"Unknown\"===e?9999:999},e.slice().sort(function(e,t){return o(e)-o(t)})):\"volunteerStatus\"===t?(i=[\"Yet to Volunteer\",\"Volunteered once\",\"Volunteered multiple times\",\"Volunteer 10 Club\",\"Volunteer 25 Club\",\"Volunteer 50 Club\",\"Volunteer 100 Club\",\"Volunteer 250 Club\",\"Volunteer 500 Club\",\"Volunteer 1000 Club\"],a=function(e){var t=i.indexOf(e);return-1!==t?t:(t=e.match(/(\\d+)/))?200+parseInt(t[1],10):\"Has Volunteered\"===e?150:\"Unknown\"===e?9999:999},e.slice().sort(function(e,t){return a(e)-a(t)})):e.slice().sort()})(w,b)).map(function(t){return{label:t,data:v.map(function(e){return h[e]&&h[e][t]?h[e][t]:0}),backgroundColor:(e=t,\"volunteerStatus\"===b?(r=e.match(/(\\d+)/))?(r=parseInt(r[1],10),T[r]||\"#cccccc\"):T[e]||\"#cccccc\":\"parkrunExperience\"===b?(r=e.match(/(\\d+)/))?(r=parseInt(r[1],10),T[r]||\"#cccccc\"):{\"First Timer (anywhere)\":\"#FFE049\",\"First Timer (to this event)\":\"#FFA300\",\"Multiple parkruns\":\"#00CEAE\",Unknown:\"#A1B6B7\"}[e]||\"#cccccc\":\"gender\"===b?{Male:\"#00CEAE\",Female:\"#E21145\",\"Not specified\":\"#FFE049\",Unknown:\"#A1B6B7\"}[e]||\"#FFA300\":\"ageGroup\"===b?\"Not specified\"===e?\"#F2F2F2\":\"Unknown\"===e?\"#A1B6B7\":(r=e.match(/^(\\d+)-/))&&(r=parseInt(r[1],10),n=[\"#DA70D6\",\"#9370DB\",\"#6495ED\",\"#4169E1\",\"#1E90FF\",\"#00BFFF\",\"#00CED1\",\"#20B2AA\",\"#3CB371\",\"#32CD32\",\"#9ACD32\",\"#FFD700\",\"#FFA500\",\"#FF8C00\",\"#FF6347\",\"#DC143C\",\"#DB7093\"],r=Math.floor((r-10)/5),n[Math.min(r,n.length-1)])||\"#cccccc\":[\"#FFA300\",\"#00CEAE\",\"#E21145\",\"#EBE9F0\",\"#FFE049\",\"#2C504A\",\"#6D5698\",\"#C81D31\",\"#A1B6B7\"][w.indexOf(e)%9]),stack:\"stack1\"};var e,n,r}),F=v.map(function(e){var t=Math.floor(e/60),e=e%60;return\"\".concat(t,\":\").concat(e.toString().padStart(2,\"0\"))}),S=document.getElementById(e);S?S.innerHTML=\"\":(S=document.createElement(\"div\")).id=e,S.style.background=\"#2b223d\",S.style.borderRadius=\"8px\",S.style.margin=\"20px auto\",S.style.padding=\"15px\",S.style.maxWidth=\"900px\",S.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",(g=document.createElement(\"h3\")).textContent=\"Finishers per Minute by \".concat(y),g.style.textAlign=\"center\",g.style.marginBottom=\"15px\",g.style.color=\"#FFA300\",S.appendChild(g);var A=document.createElement(\"canvas\");S.appendChild(A),(e=document.createElement(\"button\")).textContent=\"üíæ Save as Image\",e.style.padding=\"6px 12px\",e.style.backgroundColor=\"#FFA300\",e.style.color=\"#2b223d\",e.style.border=\"none\",e.style.borderRadius=\"4px\",e.style.cursor=\"pointer\",e.style.fontWeight=\"bold\",e.style.display=\"inline-block\",e.style.margin=\"10px auto 0 auto\",e.title=\"Download chart as PNG image\",e.addEventListener(\"mouseover\",function(){this.style.backgroundColor=\"#e59200\"}),e.addEventListener(\"mouseout\",function(){this.style.backgroundColor=\"#FFA300\"}),e.addEventListener(\"click\",_asyncToGenerator(_regenerator().m(function e(){var t,n,r,o,i,a,l,u,c,s,d,p;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:try{t=getEventMetadata(),n=S.querySelector(\"h3\"),r=n?n.textContent.replace(/[^a-z0-9]+/gi,\"-\").replace(/^-+|-+$/g,\"\").toLowerCase():\"chart\",o=generateExportFilename(t,r),a=(i=A).width,l=a,u=i.height+100,(c=document.createElement(\"canvas\")).width=l,c.height=u,(s=c.getContext(\"2d\")).fillStyle=\"#2b223d\",s.fillRect(0,0,l,u),s.fillStyle=\"#FFA300\",s.textAlign=\"center\",s.textBaseline=\"middle\",s.font=\"bold 56px Arial\",d=n?n.textContent:\"Finishers per Minute\",s.fillText(d,l/2,50),s.drawImage(i,0,100),(p=document.createElement(\"a\")).download=o,p.href=c.toDataURL(\"image/png\"),p.click()}catch(e){alert(\"Failed to export image: \"+e)}case 1:return e.a(2)}},e)}))),(y=S.querySelector(\".walker-controls-footer\"))||((y=document.createElement(\"div\")).className=\"walker-controls-footer\",y.style.display=\"flex\",y.style.justifyContent=\"center\",y.style.marginTop=\"12px\",S.appendChild(y)),y.innerHTML=\"\",y.appendChild(e),V&&(V.destroy(),V=null),setTimeout(function(){ChartRef&&(V=new ChartRef(A.getContext(\"2d\"),{type:\"bar\",data:{labels:F,datasets:E},options:{responsive:!0,layout:{padding:{left:60,right:60,top:40,bottom:40}},plugins:{legend:{labels:{color:\"#e0e0e0\"}},title:{display:!1}},scales:{x:{stacked:!0,title:{display:!0,text:\"Finish Time\",color:\"#e0e0e0\"},ticks:{color:\"#cccccc\"},grid:{color:\"rgba(200,200,200,0.2)\"}},y:{stacked:!0,beginAtZero:!0,title:{display:!0,text:\"Number of Finishers\",color:\"#e0e0e0\"},ticks:{color:\"#cccccc\",precision:0},grid:{color:\"rgba(200,200,200,0.2)\"}}}}}))},0),(m=document.getElementById(O))&&m.parentNode?m.nextSibling?m.parentNode.insertBefore(j,m.nextSibling):m.parentNode.appendChild(j):document.body.appendChild(j)}e.length&&(_=assignUnknownFinishTimes(e.map(function(e,t){var n=e.querySelector(\".Results-table-td--time .compact\"),n=n?n.textContent.trim():\"\",r=(r=n)?2===(r=r.split(\":\").map(Number)).length?60*r[0]+r[1]:3===r.length?3600*r[0]+60*r[1]+r[2]:0:0,o=(e.getAttribute(\"data-gender\")||\"\").trim(),i=parseInt(e.getAttribute(\"data-runs\"),10),a=parseInt(e.getAttribute(\"data-vols\"),10),l=(e.getAttribute(\"data-achievement\")||\"\").trim(),u=\"Unknown\",l=(!isNaN(i)&&0<i&&(u=1===i?\"First Timer (anywhere)\":\"First Timer!\"===l?\"First Timer (to this event)\":!(i<10)&&d(i,\"parkrun\").status||\"Multiple parkruns\"),\"Unknown\"),i=0,a=(isNaN(a)||(0===a?l=\"Yet to Volunteer\":1===a?l=\"Volunteered once\":1<a&&a<10?l=\"Volunteered multiple times\":(l=(a=d(a,\"Volunteer\")).status||\"Has Volunteered\",i=a.milestone)),e.innerHTML.match(/milestone-v(\\d+)/)),a=(a&&(l=\"Volunteer \".concat(a[1],\" Club\"),i=parseInt(a[1],10)),\"\"),c=e.querySelector(\".Results-table-td--agegrade\"),c=(c&&(c=c.textContent.trim())&&(a=c.replace(\"%\",\"\")),\"Unknown\"),s=e.getAttribute(\"data-agegroup\")||\"\",s=(s?c=s.replace(/^[A-Z]+/,\"\"):(s=e.querySelector(\".Results-table-td--agegroup\"))?c=s.textContent.trim().replace(/^[A-Z]+/,\"\")||(n?\"Not specified\":\"Unknown\"):n&&(c=\"Not specified\"),o.toLowerCase());return{timeStr:n,timeSec:r,gender:s=\"male\"===s||\"m\"===s?\"Male\":\"female\"===s||\"f\"===s?\"Female\":n?\"Not specified\":\"Unknown\",parkrunExperience:u,volunteerStatus:l,volunteerMilestone:i,ageGrade:a,ageGroup:c,_row:e,_idx:t}})),T={10:\"#EBE9F0\",25:\"#6D5698\",50:\"#C81D31\",100:\"#2E393B\",250:\"#2C504A\",500:\"#2E4DA7\",1e3:\"#FFE049\",\"Volunteered once\":\"#90EE90\",\"Volunteered multiple times\":\"#00CEAE\",\"Has Volunteered\":\"#00CEAE\",\"Yet to Volunteer\":\"#FFA300\",Unknown:\"#A1B6B7\"},N=[{key:\"parkrunExperience\",label:\"parkrun Experience\"},{key:\"volunteerStatus\",label:\"Volunteer Experience\"},{key:\"gender\",label:\"Gender\"},{key:\"ageGroup\",label:\"Age Group\"}],D=\"parkrunExperience\",O=\"finishersStackedChart\",V=null,(j=document.getElementById(\"walkerAnalysisControls\"))||((j=document.createElement(\"div\")).id=\"walkerAnalysisControls\",j.style.textAlign=\"center\",j.style.margin=\"20px 0 10px 0\",j.style.color=\"#e0e0e0\",j.style.background=\"#2b223d\",j.style.padding=\"10px\",j.style.borderRadius=\"8px\",j.style.maxWidth=\"900px\",j.style.marginLeft=\"auto\",j.style.marginRight=\"auto\"),n())}parkrunWalkerAnalysisMain(),\"undefined\"!=typeof module&&void 0!==module.exports&&(module.exports={assignUnknownFinishTimes:assignUnknownFinishTimes,getEventMetadata:getEventMetadata,generateExportFilename:generateExportFilename,computeWalkerThreshold:computeWalkerThreshold});"
  },
  "parkrun-charts.user.js": {
    "name": "parkrun Charts",
    "description": "Displays charts on parkrun pages: finishers per minute on results pages and event history on event history pages",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/parkrun-charts.user.js",
    "bookmarklet": "javascript:function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(e,t){var r;if(e)return\"string\"==typeof e?_arrayLikeToArray(e,t):\"Map\"===(r=\"Object\"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}function _iterableToArrayLimit(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var o,n,a,l,i=[],s=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(o=a.call(r)).done)&&(i.push(o.value),i.length!==t);s=!0);}catch(e){c=!0,n=e}finally{try{if(!s&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw n}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}(()=>{var f={backgroundColor:\"#2b223d\",barColor:\"#FFA300\",lineColor:\"#53BA9D\",textColor:\"#e0e0e0\",subtleTextColor:\"#cccccc\",gridColor:\"rgba(200, 200, 200, 0.2)\"},d=!1;function h(e,t,r){var r=2<arguments.length&&void 0!==r?r:800,o=document.createElement(\"div\"),r=(o.className=\"parkrun-chart-container \"+t+\"-container\",o.style.width=\"100%\",o.style.maxWidth=r+\"px\",o.style.margin=\"20px auto\",o.style.padding=\"15px\",o.style.backgroundColor=f.backgroundColor,o.style.borderRadius=\"8px\",o.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",document.createElement(\"h3\")),e=(r.textContent=e,r.style.textAlign=\"center\",r.style.marginBottom=\"15px\",r.style.color=f.barColor,o.appendChild(r),document.createElement(\"canvas\"));return e.id=t,o.appendChild(e),{container:o,canvas:e}}function g(e,t){e=document.querySelector(e);e&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t))}function v(a){var e=document.createElement(\"div\"),l=(e.style.display=\"flex\",e.style.justifyContent=\"center\",e.style.marginTop=\"10px\",e.style.marginBottom=\"10px\",document.createElement(\"button\"));l.textContent=\"üíæ Save as Image\",l.style.padding=\"6px 12px\",l.style.backgroundColor=f.barColor,l.style.color=\"#2b223d\",l.style.border=\"none\",l.style.borderRadius=\"4px\",l.style.cursor=\"pointer\",l.style.fontWeight=\"bold\",l.style.display=\"inline-block\",l.style.margin=\"0 5px\",l.title=\"Download chart as PNG image\",l.addEventListener(\"mouseover\",function(){this.style.backgroundColor=\"#e59200\"}),l.addEventListener(\"mouseout\",function(){this.style.backgroundColor=f.barColor}),l.addEventListener(\"click\",function(){l.style.display=\"none\",html2canvas(a,{backgroundColor:f.backgroundColor,scale:2,logging:!1,allowTaint:!0,useCORS:!0}).then(function(e){l.style.display=\"block\";var t=document.createElement(\"a\"),r=(new Date).toISOString().split(\"T\")[0],o=window.location.pathname.split(\"/\")[1],n=a.classList.contains(\"eventHistoryChart-container\")?\"event-history\":\"finishers\";t.download=\"\".concat(o,\"-\").concat(n,\"-\").concat(r,\".png\"),t.href=e.toDataURL(\"image/png\"),t.click()})}),e.appendChild(l),a.appendChild(e)}function x(e){for(var t=e.getContext(\"2d\"),r=\"parkrun-charts\",o=\"unknown\",n=\"\",a=(\"undefined\"!=typeof GM_info&&GM_info&&GM_info.script&&(r=GM_info.script.name||r,o=GM_info.script.version||o,n=GM_info.script.homepage||\"\"),[\"Generated by \".concat(r,\" v\").concat(o),n]),l=(t.save(),t.font=d?\"bold 16px Arial\":\"10px Arial\",t.fillStyle=d?\"rgba(255, 0, 0, 0.5)\":\"rgba(200, 200, 200, 0.1)\",t.textAlign=\"right\",t.textBaseline=\"bottom\",d?20:14),i=e.width-10,s=e.height-10,c=a.length-1;0<=c;c--){var u=a[c];u&&(t.fillText(u,i,s),s-=l)}t.restore()}function e(){var e,t,r=[[null==(r=document.querySelector(\"h1\"))||null==(r=r.textContent)?void 0:r.trim(),null==(r=document.querySelector(\"h3\"))||null==(r=r.textContent)?void 0:r.trim()].filter(Boolean).join(\" | \"),\"Finishers per Minute\"].filter(Boolean).join(\": \"),o=(e=>{for(var t=e.timeData,r=e.maxMinute,o=[],n=[],a=e.minMinute;a<=r;a++)o.push(a),n.push(t[a]||0);return{labels:o.map(function(e){var t=Math.floor(e/60),e=e%60;return\"\".concat(t,\":\").concat(e.toString().padStart(2,\"0\"))}),data:n}})((()=>{var o={},e=document.querySelectorAll(\"tr.Results-table-row\"),n=1/0,a=0;e.forEach(function(e){e=e.querySelector(\"td.Results-table-td--time\");if(e){var e=e.textContent.trim(),t=e.match(/(\\d+):(\\d+):(\\d+)/);if(t)var r=60*parseInt(t[1])+parseInt(t[2]);else{t=e.match(/(\\d+):(\\d+)/);if(!t)return;r=parseInt(t[1])}n=Math.min(n,r),a=Math.max(a,r),o[r]?o[r]++:o[r]=1}});for(var t=n;t<=a;t++)o[t]||(o[t]=0);return{timeData:o,minMinute:n,maxMinute:a}})());0===o.labels.length?console.log(\"No finish time data found\"):document.getElementById(\"finishersChart\")?console.log(\"Finishers chart already exists, skipping render\"):(e=(r=h(r,\"finishersChart\")).container,t=r.canvas,g(\"h3\",e),v(e),r=t.getContext(\"2d\"),new Chart(r,{type:\"bar\",data:{labels:o.labels,datasets:[{label:\"Number of Finishers\",data:o.data,backgroundColor:f.barColor,borderColor:f.barColor,borderWidth:1}]},options:{animation:!1,responsive:!0,plugins:{legend:{labels:{color:f.textColor}},title:{display:!1,color:f.textColor},tooltip:{callbacks:{title:function(e){var t,r,e=e[0].label;return e.includes(\":\")?(r=(t=_slicedToArray(e.split(\":\"),2))[0],t=t[1],\"\".concat(r,\" hour\").concat(\"1\"===r?\"\":\"s\",\" \").concat(t,\" minute\").concat(\"01\"===t?\"\":\"s\")):(r=e.replace(\"'\",\"\"),\"\".concat(r,\" minute\").concat(\"1\"===r?\"\":\"s\"))},label:function(e){return\"\".concat(e.raw,\" finisher\").concat(1===e.raw?\"\":\"s\")}}}},scales:{x:{title:{display:!0,text:\"Finish Time\",color:f.textColor},ticks:{color:f.subtleTextColor},grid:{color:f.gridColor}},y:{beginAtZero:!0,title:{display:!0,text:\"Number of Finishers\",color:f.textColor},ticks:{precision:0,color:f.subtleTextColor},grid:{color:f.gridColor}}},onHover:function(){setTimeout(function(){return x(t)},0)},onResize:function(){setTimeout(function(){return x(t)},0)},customPlugin:{id:\"watermarkPlugin\",afterDraw:function(){setTimeout(function(){return x(t)},0)}}}}),setTimeout(function(){return x(t)},0))}function C(e,t){for(var r=[],o=0;o<e.length;o++)if(o<t-1)r.push(null);else{for(var n=0,a=0;a<t;a++)n+=e[o-a];r.push(parseFloat((n/t).toFixed(1)))}return r}function k(e,t,r){for(var o=1/0,n=-1/0,a=-1,l=-1,i=0;i<e.length;i++)e[i]<o&&(o=e[i],a=i),e[i]===o&&(a=i),n<e[i]&&(n=e[i],l=i),e[i]===n&&(l=i);return{min:{value:o,eventNumber:t[a],date:r[a],index:a},max:{value:n,eventNumber:t[l],date:r[l],index:l}}}function A(e,t){return 0!==e&&0!==t&&Math.floor(Math.log10(e))===Math.floor(Math.log10(t))}function t(){var n,r,o,a,l,e,t,i,s,c,u,d,p,m,b,y;document.getElementById(\"eventHistoryChart\")?console.log(\"Event history chart already exists, skipping render\"):(t=null!=(t=null==(t=document.querySelector(\"h1\"))?void 0:t.textContent.trim())?t:\"Event History\",r=[],o=[],a=[],l=[],e=document.querySelectorAll(\"tr.Results-table-row\"),Array.from(e).reverse().forEach(function(e){var t=e.getAttribute(\"data-parkrun\"),t=(t&&r.push(t),e.getAttribute(\"data-date\")),t=(t&&(t=new Date(t).toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),o.push(t)),e.getAttribute(\"data-finishers\")),t=(t&&a.push(parseInt(t,10)),e.getAttribute(\"data-volunteers\"));t&&l.push(parseInt(t,10))}),0===(n={title:t,eventNumbers:r,dates:o,finishers:a,volunteers:l}).eventNumbers.length?console.log(\"No event history data found\"):(e=C(n.finishers,12),t=C(n.volunteers,12),m=k(n.finishers,n.eventNumbers,n.dates),b=k(n.volunteers,n.eventNumbers,n.dates),i={\"y-parkrunners\":{type:\"linear\",position:\"left\",beginAtZero:!0,title:{display:!0,text:\"parkrunners\",color:f.textColor},ticks:{precision:0,color:f.subtleTextColor},grid:{color:f.gridColor}},\"y-finishers\":{type:\"linear\",position:\"left\",beginAtZero:!0,title:{display:!0,text:\"Number of Finishers\",color:f.barColor},ticks:{precision:0,color:f.barColor},grid:{color:f.gridColor}},\"y-volunteers\":{type:\"linear\",position:\"right\",beginAtZero:!0,title:{display:!0,text:\"Number of Volunteers\",color:f.lineColor},ticks:{precision:0,color:f.lineColor},grid:{display:!1}}},s=(c=A(m.max.value,b.max.value))?\"y-parkrunners\":\"y-finishers\",c=c?\"y-parkrunners\":\"y-volunteers\",u=(p=h(\"\".concat(n.title,\": Finishers & Volunteers\"),\"eventHistoryChart\",1e3)).container,(d=p.canvas).height=400,d.style.height=\"400px\",d.style.maxHeight=\"400px\",g(\"h1\",u),p=d.getContext(\"2d\"),(y=document.createElement(\"div\")).className=\"chart-stats-footer\",y.style.marginTop=\"10px\",y.style.padding=\"10px\",y.style.backgroundColor=f.backgroundColor,y.style.color=f.textColor,y.style.borderRadius=\"4px\",y.style.fontSize=\"14px\",y.style.textAlign=\"center\",y.innerHTML='\\n      <span style=\"color: '.concat(f.barColor,'\">Finishers:</span> Min: ').concat(m.min.value,\" (\").concat(m.min.date,\", Event #\").concat(m.min.eventNumber,\") |\\n      Max: \").concat(m.max.value,\" (\").concat(m.max.date,\", Event #\").concat(m.max.eventNumber,')<br>\\n      <span style=\"color: ').concat(f.lineColor,'\">Volunteers:</span> Min: ').concat(b.min.value,\" (\").concat(b.min.date,\", Event #\").concat(b.min.eventNumber,\") |\\n      Max: \").concat(b.max.value,\" (\").concat(b.max.date,\", Event #\").concat(b.max.eventNumber,\")\\n    \"),u.appendChild(y),m={title:{display:!0,text:\"Date\",color:f.textColor},ticks:{color:f.subtleTextColor,maxRotation:45,minRotation:45,callback:function(e,t){var r=n.dates.length,o=1;return 100<r?o=10:50<r?o=5:20<r&&(o=2),0===t||t===n.dates.length-1||t%o==0?n.dates[t]:\"\"}},grid:{color:f.gridColor}},b=[{label:\"Finishers\",data:n.finishers,backgroundColor:f.barColor,borderColor:f.barColor,borderWidth:1,yAxisID:s,order:1},{label:\"\".concat(12,\"-Event Avg (Finishers)\"),data:e,type:\"line\",borderColor:f.barColor,backgroundColor:\"transparent\",borderWidth:2,borderDash:[5,5],pointRadius:0,fill:!1,yAxisID:s,order:0},{label:\"Volunteers\",data:n.volunteers,type:\"line\",borderColor:f.lineColor,backgroundColor:\"rgba(83, 186, 157, 0.2)\",borderWidth:1,pointBackgroundColor:f.lineColor,pointRadius:2,fill:!1,tension:.2,yAxisID:c,order:2},{label:\"\".concat(12,\"-Event Avg (Volunteers)\"),data:t,type:\"line\",borderColor:f.lineColor,backgroundColor:\"transparent\",borderWidth:2,borderDash:[5,5],pointRadius:0,fill:!1,yAxisID:c,order:3}],(y={x:m})[s]=i[s],c!=s&&(y[c]=i[c]),new Chart(p,{type:\"bar\",data:{labels:n.dates,datasets:b},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:2.5,plugins:{legend:{labels:{color:f.textColor,usePointStyle:!0}},tooltip:{mode:\"index\",callbacks:{title:function(e){var e=e[0].dataIndex,t=n.eventNumbers[e],e=n.dates[e];return\"\".concat(e,\" (Event #\").concat(t,\")\")},label:function(e){var t=e.dataset.label||\"\";return\"Finishers\"===t?\"Finishers: \".concat(e.raw):\"Volunteers\"===t?\"Volunteers: \".concat(e.raw):t.includes(\"Avg\")?\"\".concat(t,\": \").concat(e.raw):e.formattedValue}}}},scales:y,onHover:function(){setTimeout(function(){return x(d)},0)},onResize:function(){setTimeout(function(){return x(d)},0)},customPlugin:{id:\"watermarkPlugin\",afterDraw:function(){setTimeout(function(){return x(d)},0)}}}}),setTimeout(function(){return x(d)},0),v(u)))}\"undefined\"!=typeof module&&void 0!==module.exports?module.exports.sameOrderOfMagnitude=A:\"undefined\"==typeof Chart?console.error(\"Chart.js not loaded\"):document.querySelector(\".Results-table\")?(window.location.href.includes(\"/eventhistory/\")?t:e)():console.log(\"Results table not found\")})();"
  },
  "parkrun-cancellation-impact.user.js": {
    "name": "parkrun Cancellation Impact",
    "description": "Analyzes the impact of cancelled parkrun events on nearby alternatives",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/parkrun-cancellation-impact.user.js",
    "bookmarklet": "javascript:function _typeof(e){return(_typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function _regenerator(){var g,e=\"function\"==typeof Symbol?Symbol:{},t=e.iterator||\"@@iterator\",n=e.toStringTag||\"@@toStringTag\";function r(e,t,n,r){var o,a,l,s,i,c,d,u,p,t=t&&t.prototype instanceof f?t:f,t=Object.create(t.prototype);return _regeneratorDefine2(t,\"_invoke\",(o=e,a=n,d=r||[],u=!1,p={p:c=0,n:0,v:g,a:y,f:y.bind(g,4),d:function(e,t){return l=e,s=0,i=g,p.n=t,h}},function(e,t,n){if(1<c)throw TypeError(\"Generator is already running\");for(u&&1===t&&y(t,n),s=t,i=n;(m=s<2?g:i)||!u;){l||(s?s<3?(1<s&&(p.n=-1),y(s,i)):p.n=i:p.v=i);try{if(c=2,l){if(m=l[e=s?e:\"next\"]){if(!(m=m.call(l,i)))throw TypeError(\"iterator result is not an object\");if(!m.done)return m;i=m.value,s<2&&(s=0)}else 1===s&&(m=l.return)&&m.call(l),s<2&&(i=TypeError(\"The iterator does not provide a '\"+e+\"' method\"),s=1);l=g}else if((m=(u=p.n<0)?i:o.call(a,p))!==h)break}catch(e){l=g,s=1,i=e}finally{c=1}}return{value:m,done:u}}),!0),t;function y(e,t){for(s=e,i=t,m=0;!u&&c&&!n&&m<d.length;m++){var n,r=d[m],o=p.p,a=r[2];3<e?(n=a===t)&&(i=r[(s=r[4])?5:s=3],r[4]=r[5]=g):r[0]<=o&&((n=e<2&&o<r[1])?(s=0,p.v=t,p.n=r[1]):o<a&&(n=e<3||r[0]>t||a<t)&&(r[4]=e,r[5]=t,p.n=a,s=0))}if(n||1<e)return h;throw u=!0,t}}var h={};function f(){}function o(){}function a(){}var m=Object.getPrototypeOf,e=[][t]?m(m([][t]())):(_regeneratorDefine2(m={},t,function(){return this}),m),l=a.prototype=f.prototype=Object.create(e);function s(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,_regeneratorDefine2(e,n,\"GeneratorFunction\")),e.prototype=Object.create(l),e}return _regeneratorDefine2(l,\"constructor\",o.prototype=a),_regeneratorDefine2(a,\"constructor\",o),_regeneratorDefine2(a,n,o.displayName=\"GeneratorFunction\"),_regeneratorDefine2(l),_regeneratorDefine2(l,n,\"Generator\"),_regeneratorDefine2(l,t,function(){return this}),_regeneratorDefine2(l,\"toString\",function(){return\"[object Generator]\"}),(_regenerator=function(){return{w:r,m:s}})()}function _regeneratorDefine2(e,t,n,r){var a=Object.defineProperty;try{a({},\"\",{})}catch(e){a=0}(_regeneratorDefine2=function(e,t,n,r){function o(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o(\"next\",0),o(\"throw\",1),o(\"return\",2))})(e,t,n,r)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _iterableToArray(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,\"string\");return\"symbol\"==_typeof(e)?e:e+\"\"}function _toPrimitive(e,t){if(\"object\"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return(\"string\"===t?String:Number)(e);n=n.call(e,t||\"default\");if(\"object\"!=_typeof(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(e,t){var n;if(e)return\"string\"==typeof e?_arrayLikeToArray(e,t):\"Map\"===(n=\"Object\"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=n){var r,o,a,l,s=[],i=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);i=!0);}catch(e){c=!0,o=e}finally{try{if(!i&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,n,r,o,a,l){try{var s=e[a](l),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(r,o)}function _asyncToGenerator(s){return function(){var e=this,l=arguments;return new Promise(function(t,n){var r=s.apply(e,l);function o(e){asyncGeneratorStep(r,t,n,o,a,\"next\",e)}function a(e){asyncGeneratorStep(r,t,n,o,a,\"throw\",e)}o(void 0)})}}(()=>{var k={backgroundColor:\"#1c1b2a\",barColor:\"#f59e0b\",alertColor:\"#ef4444\",lineColor:\"#22d3ee\",textColor:\"#f3f4f6\",subtleTextColor:\"#d1d5db\",gridColor:\"rgba(243, 244, 246, 0.18)\",successColor:\"#10b981\"},v=7,i=12,g=864e5,S={currentEvent:null,allParkruns:null,gapInfo:null,nearbyParkruns:[],fetchController:null,analysisComplete:!1,impactData:null,currentCancellationIndex:-1,cancellationDates:[],sortColumn:\"distance\",sortDirection:\"asc\"};function C(e){return new Date(\"\".concat(e,\"T00:00:00Z\"))}function c(e,t){e=document.querySelector(e);e&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t))}function r(){return(r=_asyncToGenerator(_regenerator().m(function e(){var t,n,r,o,a,l;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=\"parkrun_events_cache\",e.p=1,a=localStorage.getItem(t)){if(e.p=2,a=JSON.parse(a),r=a.data,a=a.timestamp,(a=Date.now()-a)<g)return console.log(\"Using cached parkrun events (\".concat(Math.round(a/1e3/60),\" minutes old)\")),e.a(2,r);e.n=3}else e.n=5;break;case 3:e.n=5;break;case 4:e.p=4,a=e.v,console.log(\"Cache parse error, fetching fresh data\",a);case 5:return console.log(\"Fetching parkrun events from https://images.parkrun.com/events.json\"),e.n=6,fetch(\"https://images.parkrun.com/events.json\");case 6:if((n=e.v).ok){e.n=7;break}return console.error(\"Fetch failed with status:\",n.status),e.a(2,[]);case 7:return e.n=8,n.json();case 8:if(r=e.v,(o=(null==(o=r.events)?void 0:o.features)||r.features||[])&&0!==o.length){e.n=9;break}return console.error(\"No features found in response data\"),e.a(2,[]);case 9:try{localStorage.setItem(t,JSON.stringify({data:o,timestamp:Date.now()}))}catch(e){console.warn(\"Failed to cache parkrun events:\",e)}return console.log(\"Successfully loaded\",o.length,\"parkrun events\"),e.a(2,o);case 10:return e.p=10,l=e.v,console.error(\"Failed to fetch parkruns:\",l),e.a(2,[])}},e,null,[[2,4],[1,10]])}))).apply(this,arguments)}function w(){return{eventName:window.location.pathname.split(\"/\")[1],domain:window.location.hostname,url:window.location.origin}}function d(e,t,n,r){var o=(n-e)*Math.PI/180,r=(r-t)*Math.PI/180,t=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371*(2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t)))}function E(t,e,n){for(var r=2<arguments.length&&void 0!==n?n:i,o=C(e.toISOString().split(\"T\")[0]),a=[],l=t.rawDates.length-1;0<=l;l--){var s=C(t.rawDates[l]);if(s<o&&(a.push(l),r<=a.length))break}a.reverse();n={dates:a.map(function(e){return t.dates[e]}),finishers:a.map(function(e){return t.finishers[e]}),volunteers:a.map(function(e){return t.volunteers[e]})},e=(e=>{var t,n;return 0===e.dates.length?{avgFinishers:0,avgVolunteers:0,totalEvents:0,minFinishers:0,maxFinishers:0,minVolunteers:0,maxVolunteers:0}:(t=Math.round(e.finishers.reduce(function(e,t){return e+t},0)/e.dates.length),n=Math.round(e.volunteers.reduce(function(e,t){return e+t},0)/e.dates.length),{avgFinishers:t,avgVolunteers:n,totalEvents:e.dates.length,minFinishers:Math.min.apply(Math,_toConsumableArray(e.finishers)),maxFinishers:Math.max.apply(Math,_toConsumableArray(e.finishers)),minVolunteers:Math.min.apply(Math,_toConsumableArray(e.volunteers)),maxVolunteers:Math.max.apply(Math,_toConsumableArray(e.volunteers))})})(n);return{filtered:n,window:0<a.length?{start:C(t.rawDates[a[0]]),end:C(t.rawDates[a[a.length-1]])}:{start:new Date(o),end:new Date(o)},baseline:e}}function x(){return(x=_asyncToGenerator(_regenerator().m(function e(t,n){var r,o,a,l,s,i,c,d,u,p,y;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=\"parkrun_history_\".concat(t),e.p=1,p=localStorage.getItem(r)){if(e.p=2,p=JSON.parse(p),o=p.data,p=p.timestamp,(p=Date.now()-p)<g)return console.log(\"Using cached history for \".concat(t,\" (\").concat(Math.round(p/1e3/60),\" minutes old)\")),e.a(2,o);e.n=3}else e.n=5;break;case 3:e.n=5;break;case 4:e.p=4,p=e.v,console.log(\"Cache parse error for \".concat(t,\", fetching fresh data\"),p);case 5:return o=\"\".concat(n,\"/\").concat(t,\"/results/eventhistory/\"),e.n=6,fetch(o);case 6:return a=e.v,e.n=7,a.text();case 7:a=e.v,u=new DOMParser,u=u.parseFromString(a,\"text/html\"),y=null!=(y=null==(y=u.querySelector(\"h1\"))?void 0:y.textContent.trim())?y:t,l=[],s=[],i=[],c=[],d=[],u=u.querySelectorAll(\"tr.Results-table-row\"),Array.from(u).reverse().forEach(function(e){var t=e.getAttribute(\"data-parkrun\"),t=(t&&l.push(t),e.getAttribute(\"data-date\")),t=(t&&(i.push(t),t=new Date(t).toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),s.push(t)),e.getAttribute(\"data-finishers\")),t=(t&&c.push(parseInt(t,10)),e.getAttribute(\"data-volunteers\"));t&&d.push(parseInt(t,10))}),u={eventName:t,title:y,eventNumbers:l,dates:s,rawDates:i,finishers:c,volunteers:d};try{localStorage.setItem(r,JSON.stringify({data:u,timestamp:Date.now()}))}catch(e){console.warn(\"Failed to cache history for \".concat(t,\":\"),e)}return e.a(2,u);case 8:return e.p=8,y=e.v,console.error(\"Failed to fetch event history for \".concat(t,\":\"),y),e.a(2,null)}},e,null,[[2,4],[1,8]])}))).apply(this,arguments)}function o(){return(o=_asyncToGenerator(_regenerator().m(function e(){var t,n,r,o,a,l,s,i;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if((t=document.querySelector(\".parkrun-cancellation-impact\"))&&t.remove(),0===(t=(()=>{var e=null!=(e=null==(e=document.querySelector(\"h1\"))?void 0:e.textContent.trim())?e:\"Event History\",n=[],r=[],o=[],a=[],l=[],t=document.querySelectorAll(\"tr.Results-table-row\");return Array.from(t).reverse().forEach(function(e){var t=e.getAttribute(\"data-parkrun\"),t=(t&&n.push(t),e.getAttribute(\"data-date\")),t=(t&&(o.push(t),t=new Date(t).toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),r.push(t)),e.getAttribute(\"data-finishers\")),t=(t&&a.push(parseInt(t,10)),e.getAttribute(\"data-volunteers\"));t&&l.push(parseInt(t,10))}),{title:e,eventNumbers:n,dates:r,rawDates:o,finishers:a,volunteers:l}})()).eventNumbers.length)return console.log(\"No event history data found\"),e.a(2);e.n=1;break;case 1:if(n=((e,t)=>{var n=e.rawDates.map(C);if(!(n.length<1)){for(var r=[],o=1;o<n.length;o++){var a=n[o-1],l=n[o],s=(l-a)/864e5;v<s&&r.push({gapStartDate:a,gapEndDate:l,daysDiff:s,eventsBefore:o,eventsAfter:n.length-o})}if(0<r.length)return e=r[r.length-1],console.log(\"Detected \".concat(r.length,\" gap(s); using latest: \").concat(e.daysDiff.toFixed(1),\" days\")),console.log(\"All gaps detected:\",r),e;if(t&&1<=n.length){var e=n[n.length-1],t=t.toISOString().split(\"T\")[0],i=C(t),c=(i-e)/864e5;if(v<c)return console.log(\"Detected ongoing gap: \".concat(c.toFixed(1),\" days from last event to \").concat(t)),{gapStartDate:e,gapEndDate:i,daysDiff:c,eventsBefore:n.length,eventsAfter:0}}}return null})(t,new Date)){e.n=2;break}return console.log(\"No cancellation gap detected\"),e.a(2);case 2:if(S.currentEvent=_objectSpread(_objectSpread({},t),{},{eventName:w().eventName}),S.gapInfo=n,r=w(),(o=document.createElement(\"div\")).className=\"parkrun-cancellation-impact\",o.style.width=\"100%\",o.style.maxWidth=\"1200px\",o.style.margin=\"20px auto\",o.style.padding=\"15px\",o.style.backgroundColor=k.backgroundColor,o.style.borderRadius=\"8px\",o.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",S.allParkruns&&0!==S.allParkruns.length){e.n=3;break}return(a=document.createElement(\"div\")).style.padding=\"10px\",a.style.color=k.subtleTextColor,a.style.textAlign=\"center\",a.textContent=\"Loading nearby parkruns...\",o.appendChild(a),c(\"h1\",o),e.a(2);case 3:if(S.nearbyParkruns=function(o,e,t){var n,a,l,s,i,c=2<arguments.length&&void 0!==t?t:50,t=e.find(function(e){return e.properties.eventname===o.eventName});return t?(n=_slicedToArray(t.geometry.coordinates,2),a=n[0],l=n[1],s=t.properties.countrycode,i=t.properties.seriesid,e.filter(function(e){var t,n,r;return e.properties.eventname!==o.eventName&&e.properties.countrycode===s&&e.properties.seriesid===i&&(t=(e=_slicedToArray(e.geometry.coordinates,2))[0],e=e[1],n=Math.abs(e-l),r=Math.abs(t-a),!(.5<n||.5<r))&&d(l,a,e,t)<=c}).map(function(e){var t=_slicedToArray(e.geometry.coordinates,2),n=t[0],t=d(l,a,t[1],n);return _objectSpread(_objectSpread({},e),{},{distance:t})}).sort(function(e,t){return e.distance-t.distance})):[]}(r,S.allParkruns),0===S.nearbyParkruns.length)return(a=document.createElement(\"div\")).style.padding=\"10px\",a.style.color=k.subtleTextColor,a.style.textAlign=\"center\",a.textContent=\"No nearby parkruns found within 50km.\",o.appendChild(a),c(\"h1\",o),e.a(2);e.n=4;break;case 4:l=S.allParkruns.find(function(e){return e.properties.eventname===r.eventName}),l=(null==l||null==(l=l.properties)?void 0:l.EventShortName)||null,l=(e=>{var t=document.createElement(\"div\"),n=(t.style.padding=\"20px\",t.style.backgroundColor=\"#2b223d\",t.style.borderRadius=\"8px\",t.style.marginBottom=\"20px\",t.style.border=\"1px solid \".concat(k.gridColor),document.createElement(\"h3\")),r=(n.textContent=\"Cancellation Impact Analysis\",n.style.color=k.barColor,n.style.margin=\"0 0 15px 0\",n.style.fontSize=\"20px\",t.appendChild(n),(n=document.createElement(\"div\")).style.fontSize=\"16px\",n.style.color=k.textColor,n.style.marginBottom=\"15px\",n.innerHTML='<strong style=\"color: '.concat(k.lineColor,';\">').concat(e,\"</strong>\"),t.appendChild(n),(e=document.createElement(\"div\")).style.fontSize=\"14px\",e.style.lineHeight=\"1.8\",e.style.color=k.subtleTextColor,e.style.marginBottom=\"18px\",e.innerHTML=\"üìç Analyzing impact on nearby parkruns within 50km\",t.appendChild(e),document.createElement(\"button\"));return r.textContent=\"‚ñ∂ Start Analysis\",r.className=\"start-analysis-btn\",r.style.padding=\"12px 24px\",r.style.backgroundColor=k.lineColor,r.style.color=\"#1c1b2a\",r.style.border=\"none\",r.style.borderRadius=\"6px\",r.style.cursor=\"pointer\",r.style.fontWeight=\"bold\",r.style.fontSize=\"14px\",r.style.transition=\"all 0.2s\",r.addEventListener(\"mouseenter\",function(){r.style.backgroundColor=\"#0ea5e9\",r.style.transform=\"translateY(-1px)\"}),r.addEventListener(\"mouseleave\",function(){r.style.backgroundColor=k.lineColor,r.style.transform=\"translateY(0)\"}),t.appendChild(r),{section:t,startButton:r}})(l),s=l.section,i=l.startButton,o.appendChild(s),c(\"h1\",o),i.addEventListener(\"click\",function(){i.disabled=!0,i.textContent=\"Starting...\",i.style.opacity=\"0.6\",i.style.cursor=\"not-allowed\";var e=(()=>{var e=document.createElement(\"div\"),t=(e.className=\"parkrun-cancellation-progress\",e.style.padding=\"15px\",e.style.backgroundColor=k.backgroundColor,e.style.borderRadius=\"6px\",e.style.marginBottom=\"15px\",e.style.border=\"1px solid \".concat(k.gridColor),document.createElement(\"h4\")),r=(t.textContent=\"Analyzing Nearby parkrun Impact\",t.style.margin=\"0 0 12px 0\",t.style.color=k.barColor,e.appendChild(t),(t=document.createElement(\"div\")).style.width=\"100%\",t.style.height=\"20px\",t.style.backgroundColor=\"#3a3250\",t.style.borderRadius=\"4px\",t.style.marginBottom=\"10px\",t.style.overflow=\"hidden\",document.createElement(\"div\")),o=(r.style.width=\"0%\",r.style.height=\"100%\",r.style.backgroundColor=k.lineColor,r.style.transition=\"width 0.3s ease\",t.appendChild(r),e.appendChild(t),document.createElement(\"div\")),n=(o.style.fontSize=\"13px\",o.style.color=k.subtleTextColor,o.style.marginBottom=\"12px\",e.appendChild(o),document.createElement(\"div\"));return n.style.fontSize=\"12px\",n.style.color=k.lineColor,n.style.fontWeight=\"bold\",n.style.marginBottom=\"10px\",e.appendChild(n),(t=document.createElement(\"button\")).textContent=\"Stop Analysis\",t.style.padding=\"6px 12px\",t.style.backgroundColor=k.alertColor,t.style.color=k.textColor,t.style.border=\"none\",t.style.borderRadius=\"4px\",t.style.cursor=\"pointer\",t.style.fontWeight=\"bold\",t.style.fontSize=\"12px\",e.appendChild(t),{progressSection:e,updateProgress:function(e,t){var n=Math.round(e/t*100);r.style.width=n+\"%\",o.textContent=\"\".concat(e,\"/\").concat(t,\" parkruns analyzed\")},updateStatus:function(e){n.textContent=e},stop:t,hide:function(){e.style.display=\"none\"}}})();s.insertAdjacentElement(\"afterend\",e.progressSection),S.fetchController=new AbortController,function(){u.apply(this,arguments)}(e,o,s)});case 5:return e.a(2)}},e)}))).apply(this,arguments)}function u(){return(u=_asyncToGenerator(_regenerator().m(function e(t,n,r){var o,a,l,i,s,c,d,u,p,y,g,h,f,m,b;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:o=w(),a=S.nearbyParkruns,s=((e,t)=>{var n=e.rawDates.map(C);if(n.length<1)return[];for(var r,o=[],a=1;a<n.length;a++){var l=n[a-1],s=n[a],i=(s-l)/864e5;v<i&&o.push({gapStartDate:l,gapEndDate:s,daysDiff:i,eventsBefore:a,eventsAfter:n.length-a})}return t&&1<=n.length&&(e=n[n.length-1],t=C(t.toISOString().split(\"T\")[0]),v<(r=(t-e)/864e5))&&o.push({gapStartDate:e,gapEndDate:t,daysDiff:r,eventsBefore:n.length,eventsAfter:0}),console.log(\"Detected \".concat(o.length,\" total gap(s)\")),o})(S.currentEvent,new Date),l=[],s.forEach(function(e){e=((e,t)=>{var n=[],r=(6-(e=C(e.toISOString().split(\"T\")[0])).getUTCDay())%7,o=(0===r&&(r=7),new Date(e));for(o.setUTCDate(o.getUTCDate()+r);o<t;)n.push(new Date(o)),o.setUTCDate(o.getUTCDate()+7);return n})(e.gapStartDate,e.gapEndDate);l.push.apply(l,_toConsumableArray(e))}),l.sort(function(e,t){return t-e}),S.cancellationDates=l,console.log(\"All Cancellation Saturdays:\",l),i=[],s=0;case 1:if(s<a.length){if(S.fetchController.signal.aborted)return console.log(\"Analysis stopped by user\"),e.a(3,8);e.n=2}else e.n=8;break;case 2:return c=a[s],d=c.properties.eventname,u=c.properties.EventShortName||d,p=c.distance.toFixed(1),t.updateStatus(\"Fetching: \".concat(u,\" (\").concat(p,\"km)\")),t.updateProgress(s,a.length),e.p=3,e.n=4,function(){return x.apply(this,arguments)}(d,o.url);case 4:(b=e.v)&&i.push({parkrun:c,historyData:b,shortName:u,distance:p}),e.n=6;break;case 5:e.p=5,b=e.v,console.error(\"Failed to fetch \".concat(d,\":\"),b);case 6:return e.n=7,new Promise(function(e){return setTimeout(e,100)});case 7:s++,e.n=1;break;case 8:if(y={},g=[],l.forEach(function(l){var e=l.toISOString().split(\"T\")[0],s=[];i.forEach(function(e){var t=e.parkrun,n=e.historyData,r=e.shortName,e=e.distance,o=E(n,l),a=((e,t)=>{for(var n=t.toISOString().split(\"T\")[0],r=0;r<e.rawDates.length;r++)if(e.rawDates[r]===n)return{date:e.dates[r],eventNumber:e.eventNumbers[r],finishers:e.finishers[r],volunteers:e.volunteers[r]};return null})(n,l);s.push({eventName:t.properties.eventname,title:n.title,displayName:r,distance:e,baseline:o.baseline,eventOnDate:a,seasonalTrend:o,change:a?{finishersChange:a.finishers-o.baseline.avgFinishers,volunteersChange:a.volunteers-o.baseline.avgVolunteers,finishersPct:0<o.baseline.avgFinishers?(a.finishers-o.baseline.avgFinishers)/o.baseline.avgFinishers*100:0,volunteersPct:0<o.baseline.avgVolunteers?(a.volunteers-o.baseline.avgVolunteers)/o.baseline.avgVolunteers*100:0}:null})}),1<=s.filter(function(e){return e.eventOnDate}).length?(y[e]=s,g.push(l)):console.log(\"Skipping \".concat(e,\": 0/\").concat(s.length,\" parkruns ran (global cancellation)\"))}),h=0<g.length?g:l,t.updateProgress(a.length,a.length),0===g.length)return t.updateStatus(\"No valid cancellation dates found - all detected dates had global cancellations\"),t.stop.textContent=\"Close\",t.stop.style.backgroundColor=k.alertColor,(f=document.createElement(\"div\")).style.padding=\"15px\",f.style.backgroundColor=\"#3a3250\",f.style.borderRadius=\"6px\",f.style.marginTop=\"15px\",f.style.color=k.textColor,f.style.textAlign=\"center\",f.innerHTML='\\n        <h3 style=\"color: '.concat(k.alertColor,'; margin: 0 0 10px 0;\">‚ö† No Valid Analysis Dates</h3>\\n        <p style=\"margin: 0 0 8px 0;\">All detected cancellation dates appear to be part of global cancellation periods (e.g., COVID-19).</p>\\n        <p style=\"margin: 0; color: ').concat(k.subtleTextColor,'; font-size: 13px;\">\\n          No nearby parkruns held events on these dates, indicating system-wide cancellations rather than single-event cancellations.\\n        </p>\\n      '),n.appendChild(f),t.stop.addEventListener(\"click\",function(){t.hide()}),e.a(2);e.n=9;break;case 9:t.updateStatus(\"Analysis complete! Found \".concat(g.length,\" valid cancellation date(s)\")),(f=document.querySelector(\".start-analysis-btn\"))&&(f.style.display=\"none\"),t.stop.textContent=\"Close\",t.stop.style.backgroundColor=k.successColor,S.resultsByDate=y,S.cancellationDates=h,S.analysisComplete=!0,-1===S.currentCancellationIndex&&0<h.length&&(S.currentCancellationIndex=0),m=((r,o,a,l)=>{var e=document.createElement(\"div\"),t=(e.className=\"parkrun-cancellation-nav\",e.style.padding=\"15px\",e.style.backgroundColor=\"#2b223d\",e.style.borderRadius=\"8px\",e.style.marginBottom=\"20px\",e.style.border=\"1px solid \".concat(k.gridColor),document.createElement(\"div\"));t.style.color=k.textColor,t.style.fontSize=\"14px\",t.style.marginBottom=\"12px\",t.innerHTML=\"\\n      <strong>\".concat(a.length,\" Cancellation Date\").concat(1!==a.length?\"s\":\"\",' Available</strong>\\n      <div style=\"color: ').concat(k.subtleTextColor,'; font-size: 12px; margin-top: 4px;\">\\n        Use dropdown or buttons to navigate ‚Ä¢ Keyboard: <kbd style=\"background: #3a3250; padding: 2px 6px; border-radius: 3px; font-family: monospace; border: 1px solid ').concat(k.gridColor,';\">‚Üê</kbd> <kbd style=\"background: #3a3250; padding: 2px 6px; border-radius: 3px; font-family: monospace; border: 1px solid ').concat(k.gridColor,';\">‚Üí</kbd>\\n      </div>\\n    '),e.appendChild(t);(t=document.createElement(\"div\")).style.display=\"flex\",t.style.alignItems=\"center\",t.style.gap=\"8px\",t.style.flexWrap=\"wrap\";var n=document.createElement(\"button\"),s=(n.textContent=\"‚Üê\",n.style.padding=\"6px 10px\",l<a.length-1),i=(n.style.backgroundColor=s?k.lineColor:\"#3a3250\",n.style.color=s?\"#2b223d\":k.subtleTextColor,n.style.border=\"1px solid \".concat(k.gridColor),n.style.borderRadius=\"4px\",n.style.cursor=s?\"pointer\":\"not-allowed\",n.style.fontWeight=\"bold\",n.style.fontSize=\"14px\",n.style.transition=\"all 0.2s ease\",n.disabled=!s,s&&(n.addEventListener(\"mouseenter\",function(){n.style.transform=\"translateY(-1px)\",n.style.boxShadow=\"0 2px 4px rgba(34, 211, 238, 0.3)\"}),n.addEventListener(\"mouseleave\",function(){n.style.transform=\"translateY(0)\",n.style.boxShadow=\"none\"})),document.createElement(\"select\")),c=(i.style.padding=\"6px 8px\",i.style.backgroundColor=\"#3a3250\",i.style.color=k.textColor,i.style.border=\"1px solid \".concat(k.gridColor),i.style.borderRadius=\"4px\",i.style.cursor=\"pointer\",i.style.fontWeight=\"bold\",i.style.fontSize=\"12px\",i.style.minWidth=\"220px\",i.style.flex=\"1\",a.forEach(function(e,t){var n=document.createElement(\"option\"),e=e.toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\",weekday:\"short\"});n.value=t,n.textContent=e,n.selected=t===l,i.appendChild(n)}),document.createElement(\"button\")),s=(c.textContent=\"‚Üí\",c.style.padding=\"6px 10px\",0<l);function d(){var e,t,n=r.querySelector(\".parkrun-cancellation-results\");n&&n.remove(),A(r,o,a,S.currentCancellationIndex),(n=r.querySelector(\".parkrun-cancellation-nav\"))&&((e=n.querySelectorAll(\"select\"))[0]&&(e[0].value=S.currentCancellationIndex),n=(e=n.querySelectorAll(\"button\"))[0],e=e[1],n&&(t=S.currentCancellationIndex<a.length-1,n.disabled=!t,n.style.backgroundColor=t?k.lineColor:\"#3a3250\",n.style.color=t?\"#2b223d\":k.subtleTextColor,n.style.cursor=t?\"pointer\":\"not-allowed\"),e)&&(n=0<S.currentCancellationIndex,e.disabled=!n,e.style.backgroundColor=n?k.lineColor:\"#3a3250\",e.style.color=n?\"#2b223d\":k.subtleTextColor,e.style.cursor=n?\"pointer\":\"not-allowed\")}function u(){S.currentCancellationIndex<a.length-1&&(S.currentCancellationIndex+=1,d())}function p(){0<S.currentCancellationIndex&&(--S.currentCancellationIndex,d())}return c.style.backgroundColor=s?k.lineColor:\"#3a3250\",c.style.color=s?\"#2b223d\":k.subtleTextColor,c.style.border=\"1px solid \".concat(k.gridColor),c.style.borderRadius=\"4px\",c.style.cursor=s?\"pointer\":\"not-allowed\",c.style.fontWeight=\"bold\",c.style.fontSize=\"14px\",c.style.transition=\"all 0.2s ease\",c.disabled=!s,s&&(c.addEventListener(\"mouseenter\",function(){c.style.transform=\"translateY(-1px)\",c.style.boxShadow=\"0 2px 4px rgba(34, 211, 238, 0.3)\"}),c.addEventListener(\"mouseleave\",function(){c.style.transform=\"translateY(0)\",c.style.boxShadow=\"none\"})),t.appendChild(n),t.appendChild(i),t.appendChild(c),e.appendChild(t),n.addEventListener(\"click\",u),c.addEventListener(\"click\",p),i.addEventListener(\"change\",function(e){S.currentCancellationIndex=parseInt(e.target.value,10),d()}),S.keyboardHandler&&document.removeEventListener(\"keydown\",S.keyboardHandler),S.keyboardHandler=function(e){\"ArrowLeft\"===e.key&&u(),\"ArrowRight\"===e.key&&p()},document.addEventListener(\"keydown\",S.keyboardHandler),e})(n,y,h,S.currentCancellationIndex),r.insertAdjacentElement(\"afterend\",m),A(n,y,h,S.currentCancellationIndex),setTimeout(function(){t.hide()},500),t.stop.addEventListener(\"click\",function(){t.hide()});case 10:return e.a(2)}},e,null,[[3,5]])}))).apply(this,arguments)}function T(e,t,n){function r(e){switch(t){case\"name\":return e.displayName||e.eventName;case\"distance\":return parseFloat(e.distance);case\"eventNumber\":return e.eventOnDate?parseInt(e.eventOnDate.eventNumber,10):-1;case\"baseline\":return e.baseline.avgFinishers;case\"onDate\":return e.eventOnDate?e.eventOnDate.finishers:-1;case\"change\":return e.change?e.change.finishersChange:-999999;case\"changePct\":return e.change?e.change.finishersPct:-999999;default:return 0}}e=_toConsumableArray(e);return e.sort(function(e,t){e=r(e),t=r(t);return\"asc\"===n?e-t:t-e}),e}function a(){return(a=_asyncToGenerator(_regenerator().m(function e(t,n){var r,o,a,l;return _regenerator().w(function(e){for(;;)if(0===e.n)return r=t.cloneNode(!0),a=t.querySelectorAll(\"canvas\"),o=r.querySelectorAll(\"canvas\"),a.forEach(function(e,t){try{var n=e.toDataURL(\"image/png\"),r=document.createElement(\"img\");r.src=n,r.alt=\"Chart snapshot\",r.style.maxWidth=\"100%\",r.style.display=\"block\",r.style.backgroundColor=\"#2b223d\",o[t]&&o[t].replaceWith(r)}catch(e){console.error(\"Failed to serialize chart canvas:\",e)}}),a=\"\\n      :root { color-scheme: dark; }\\n      body { margin: 0; padding: 20px; background: \".concat(k.backgroundColor,\"; color: \").concat(k.textColor,'; font-family: \"Segoe UI\", \"Helvetica Neue\", Arial, sans-serif; line-height: 1.5; }\\n      a { color: ').concat(k.lineColor,\"; }\\n      h1, h2, h3, h4 { color: \").concat(k.barColor,\"; margin: 0 0 10px 0; }\\n      table { width: 100%; border-collapse: collapse; }\\n      th, td { border: 1px solid \").concat(k.gridColor,\"; padding: 10px; text-align: left; }\\n      th { background: #2b223d; color: \").concat(k.barColor,\"; }\\n      tr:nth-child(even) td { background: #241c35; }\\n      tr:nth-child(odd) td { background: #1f182e; }\\n      .parkrun-cancellation-results { background: \").concat(k.backgroundColor,\"; padding: 16px; border-radius: 6px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25); }\\n      .chart-img { max-width: 100%; display: block; }\\n      .meta { margin-bottom: 16px; color: \").concat(k.subtleTextColor,\"; font-size: 13px; }\\n      .meta strong { color: \").concat(k.textColor,\"; }\\n    \"),l='\\n      <header>\\n        <h1>parkrun Cancellation Impact</h1>\\n        <div class=\"meta\">\\n          <div><strong>Event:</strong> '.concat(n.eventShortName,\"</div>\\n          <div><strong>Cancelled date:</strong> \").concat(n.cancellationDateStr,\"</div>\\n          <div><strong>Generated:</strong> \").concat(n.generatedAt,\"</div>\\n        </div>\\n      </header>\\n    \"),e.a(2,'<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><title>parkrun Cancellation Impact - '.concat(n.eventShortName,\" - \").concat(n.cancellationDateStr,\"</title><style>\").concat(a,\"</style></head><body>\").concat(l).concat(r.outerHTML,\"</body></html>\"))},e)}))).apply(this,arguments)}function D(){return e.apply(this,arguments)}function e(){return(e=_asyncToGenerator(_regenerator().m(function e(t,n){var r,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,function(){return a.apply(this,arguments)}(t,n);case 1:return r=e.v,o=\"parkrun-cancellation-impact-\".concat(n.eventShortName,\"-\").concat(n.cancellationDateStr,\".html\"),e.a(2,{blob:new Blob([r],{type:\"text/html\"}),filename:o})}},e)}))).apply(this,arguments)}function A(e,t,n,r){function o(e){var t=p.querySelector(\"tbody\"),c=(t&&t.remove(),document.createElement(\"tbody\"));e.forEach(function(e){var t,n,r=document.createElement(\"tr\"),o=(r.style.borderBottom=\"1px solid \".concat(k.gridColor),r.style.transition=\"background-color 0.15s ease\",null!==e.eventOnDate),a=(o||(r.style.opacity=\"0.6\"),r.addEventListener(\"mouseenter\",function(){r.style.backgroundColor=o?\"rgba(34, 211, 238, 0.08)\":\"rgba(243, 244, 246, 0.03)\"}),r.addEventListener(\"mouseleave\",function(){r.style.backgroundColor=\"transparent\"}),document.createElement(\"td\")),l=(a.style.padding=\"10px\",a.style.textAlign=\"left\",a.style.fontWeight=\"bold\",document.createElement(\"a\")),a=(l.href=\"\".concat(w().url,\"/\").concat(e.eventName,\"/results/eventhistory/\"),l.textContent=e.displayName||e.eventName,l.style.color=k.lineColor,l.style.textDecoration=\"none\",l.target=\"_blank\",l.addEventListener(\"mouseenter\",function(){l.style.textDecoration=\"underline\"}),l.addEventListener(\"mouseleave\",function(){l.style.textDecoration=\"none\"}),a.appendChild(l),r.appendChild(a),document.createElement(\"td\")),a=(a.style.padding=\"10px\",a.style.textAlign=\"right\",a.style.color=k.subtleTextColor,a.textContent=\"\".concat(e.distance,\"km\"),r.appendChild(a),document.createElement(\"td\")),a=(a.style.padding=\"10px\",a.style.textAlign=\"right\",e.eventOnDate&&e.eventOnDate.eventNumber?(a.textContent=e.eventOnDate.eventNumber,a.style.color=k.textColor):(a.textContent=\"‚Äî\",a.style.color=k.subtleTextColor),r.appendChild(a),document.createElement(\"td\")),a=(a.style.padding=\"10px\",a.style.textAlign=\"right\",a.innerHTML=\"<strong>\".concat(e.baseline.avgFinishers,\"</strong> / \").concat(e.baseline.avgVolunteers),r.appendChild(a),document.createElement(\"td\")),a=(a.style.padding=\"10px\",a.style.textAlign=\"right\",e.eventOnDate?a.innerHTML=\"<strong>\".concat(e.eventOnDate.finishers,\"</strong> / \").concat(e.eventOnDate.volunteers):(a.textContent=\"‚Äî\",a.style.color=k.subtleTextColor),r.appendChild(a),document.createElement(\"td\")),s=(a.style.padding=\"10px\",a.style.textAlign=\"right\",e.change?(t=0<e.change.finishersChange?\"+\":\"\",i=0<e.change.volunteersChange?\"+\":\"\",s=0<e.change.finishersChange?k.successColor:k.alertColor,n=0<e.change.volunteersChange?k.successColor:k.alertColor,a.innerHTML='\\n          <span style=\"color: '.concat(s,';\">').concat(t).concat(e.change.finishersChange,'</span> /\\n          <span style=\"color: ').concat(n,';\">').concat(i).concat(e.change.volunteersChange,\"</span>\\n        \")):(a.textContent=\"‚Äî\",a.style.color=k.subtleTextColor),r.appendChild(a),document.createElement(\"td\")),i=(s.style.padding=\"10px\",s.style.textAlign=\"right\",e.change?(t=0<e.change.finishersPct?k.successColor:k.alertColor,n=0<e.change.finishersPct?\"+\":\"\",s.innerHTML='<span style=\"color: '.concat(t,';\">').concat(n).concat(e.change.finishersPct.toFixed(1),\"%</span>\")):(s.textContent=\"‚Äî\",s.style.color=k.subtleTextColor),r.appendChild(s),document.createElement(\"td\"));i.style.padding=\"10px\",i.style.textAlign=\"right\",e.eventOnDate?e.change.finishersChange<-5?(i.textContent=\"‚Üì Loss\",i.style.color=k.alertColor):5<e.change.finishersChange?(i.textContent=\"‚Üë Gain\",i.style.color=k.successColor):(i.textContent=\"‚Üí Stable\",i.style.color=k.subtleTextColor):(i.textContent=\"No Event\",i.style.color=k.subtleTextColor),r.appendChild(i),c.appendChild(r)}),p.appendChild(c)}function d(){var t=w(),e=S.allParkruns.find(function(e){return e.properties.eventname===t.eventName});return{eventShortName:(null==e||null==(e=e.properties)?void 0:e.EventShortName)||t.eventName,cancellationDateStr:a.toISOString().split(\"T\")[0]}}var l,a=n[r],s=t[a.toISOString().split(\"T\")[0]]||[],i=a.toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),u=document.createElement(\"div\"),n=(u.className=\"parkrun-cancellation-results\",u.style.marginTop=\"20px\",document.createElement(\"h3\")),r=(n.textContent=\"Nearby parkrun Impact on \".concat(i),n.style.color=k.barColor,n.style.marginTop=\"20px\",n.style.marginBottom=\"12px\",u.appendChild(n),document.createElement(\"div\")),p=(r.style.overflowX=\"auto\",document.createElement(\"table\")),t=(p.style.width=\"100%\",p.style.borderCollapse=\"collapse\",p.style.fontSize=\"13px\",p.style.color=k.textColor,document.createElement(\"thead\")),c=(t.style.position=\"sticky\",t.style.top=\"0\",t.style.backgroundColor=\"#2b223d\",t.style.zIndex=\"10\",document.createElement(\"tr\")),y=(c.style.borderBottom=\"2px solid \".concat(k.gridColor),[{label:\"parkrun\",key:\"name\",align:\"left\",info:\"Click column headers to sort. Default ordering is by distance.\"},{label:\"Distance\",key:\"distance\",align:\"right\",info:\"Distance from cancelled event in kilometers.\"},{label:\"Event #\",key:\"eventNumber\",align:\"right\",info:\"Event number on \".concat(i,\". Lower numbers indicate newer parkruns.\")},{label:\"Baseline (Avg)\",key:\"baseline\",align:\"right\",info:\"12-event baseline average (finishers/volunteers) for events before \".concat(i,\".\")},{label:\"On Date\",key:\"onDate\",align:\"right\",info:\"Actual attendance (finishers/volunteers) on \".concat(i,\".\")},{label:\"Change\",key:\"change\",align:\"right\",info:\"Difference between actual and baseline (finishers/volunteers).\"},{label:\"Change %\",key:\"changePct\",align:\"right\",info:\"Percentage change in finishers compared to baseline.\"},{label:\"Trend\",key:\"trend\",align:\"right\",info:\"Gain (+5 or more finishers), Loss (-5 or fewer), Stable (within ¬±5), or No Event.\"}]),n=(y.forEach(function(t){var e=document.createElement(\"th\"),n=(e.style.padding=\"10px\",e.style.textAlign=t.align,e.style.color=k.barColor,e.style.fontWeight=\"bold\",e.style.cursor=\"pointer\",e.style.userSelect=\"none\",e.style.position=\"relative\",e.style.transition=\"background-color 0.15s ease\",e.addEventListener(\"mouseenter\",function(){e.style.backgroundColor=\"rgba(34, 211, 238, 0.1)\"}),e.addEventListener(\"mouseleave\",function(){e.style.backgroundColor=\"transparent\"}),document.createElement(\"span\")),n=(n.textContent=t.label,n.style.marginRight=\"4px\",e.appendChild(n),document.createElement(\"span\")),r=(n.style.fontSize=\"10px\",n.style.opacity=S.sortColumn===t.key?\"1\":\"0.3\",n.textContent=S.sortColumn!==t.key||\"asc\"===S.sortDirection?\"‚ñ≤\":\"‚ñº\",e.appendChild(n),document.createElement(\"span\"));r.textContent=\" ‚Ñπ\",r.style.fontSize=\"12px\",r.style.opacity=\"0.6\",r.style.cursor=\"help\",r.style.transition=\"opacity 0.2s ease\",r.title=t.info,r.addEventListener(\"mouseenter\",function(){r.style.opacity=\"1\"}),r.addEventListener(\"mouseleave\",function(){r.style.opacity=\"0.6\"}),e.appendChild(r),e.addEventListener(\"click\",function(){S.sortColumn===t.key?S.sortDirection=\"asc\"===S.sortDirection?\"desc\":\"asc\":(S.sortColumn=t.key,S.sortDirection=\"asc\");var e=T(s,S.sortColumn,S.sortDirection);o(e),y.forEach(function(e,t){t=c.children[t].children[1];e.key===S.sortColumn?(t.style.opacity=\"1\",t.textContent=\"asc\"===S.sortDirection?\"‚ñ≤\":\"‚ñº\"):(t.style.opacity=\"0.3\",t.textContent=\"‚ñ≤\")})}),c.appendChild(e)}),t.appendChild(c),p.appendChild(t),T(s,S.sortColumn,S.sortDirection)),g=(o(n),r.appendChild(p),u.appendChild(r),E(S.currentEvent,a)),t=document.createElement(\"div\"),n=(t.style.marginTop=\"16px\",t.style.padding=\"12px\",t.style.backgroundColor=\"#3a3250\",t.style.borderRadius=\"4px\",document.createElement(\"h3\")),r=(n.textContent=\"Cancelled Event Seasonal Trend\",n.style.color=k.barColor,n.style.margin=\"0 0 8px 0\",t.appendChild(n),document.createElement(\"div\")),n=g.window.start.toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),h=g.window.end.toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),n=(r.style.color=k.textColor,r.style.fontSize=\"13px\",r.style.marginBottom=\"6px\",r.innerHTML=\"Window: \".concat(n,\" ‚Üí \").concat(h,\" (12-event baseline)\"),t.appendChild(r),document.createElement(\"div\")),n=(n.style.color=k.textColor,n.style.fontSize=\"13px\",n.style.display=\"grid\",n.style.gridTemplateColumns=\"repeat(auto-fit, minmax(200px, 1fr))\",n.style.gap=\"8px\",n.innerHTML=\"\\n      <div>Average finishers: <strong>\".concat(g.baseline.avgFinishers,\"</strong></div>\\n      <div>Min finishers: <strong>\").concat(g.baseline.minFinishers,\"</strong></div>\\n      <div>Max finishers: <strong>\").concat(g.baseline.maxFinishers,\"</strong></div>\\n      <div>Average volunteers: <strong>\").concat(g.baseline.avgVolunteers,\"</strong></div>\\n      <div>Min volunteers: <strong>\").concat(g.baseline.minVolunteers,\"</strong></div>\\n      <div>Max volunteers: <strong>\").concat(g.baseline.maxVolunteers,\"</strong></div>\\n      <div>Total events: <strong>\").concat(g.baseline.totalEvents,\"</strong></div>\\n    \"),t.appendChild(n),\"undefined\"!=typeof Chart&&g.filtered.finishers&&0<g.filtered.finishers.length?((h=document.createElement(\"canvas\")).style.marginTop=\"12px\",t.appendChild(h),new Chart(h.getContext(\"2d\"),{type:\"line\",data:{labels:g.filtered.dates,datasets:[{label:\"Finishers\",data:g.filtered.finishers,borderColor:k.lineColor,backgroundColor:\"rgba(34, 211, 238, 0.25)\",tension:.2,fill:!0},{label:\"Volunteers\",data:g.filtered.volunteers,borderColor:k.successColor,backgroundColor:\"rgba(16, 185, 129, 0.18)\",tension:.2,fill:!0},{label:\"Finishers baseline avg\",data:g.filtered.dates.map(function(){return g.baseline.avgFinishers}),borderColor:k.barColor,borderDash:[6,4],pointRadius:0},{label:\"Volunteers baseline avg\",data:g.filtered.dates.map(function(){return g.baseline.avgVolunteers}),borderColor:k.gridColor,borderDash:[6,4],pointRadius:0}]},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:1.6,plugins:{legend:{labels:{color:k.textColor}},title:{display:!0,text:\"Finishers & volunteers over baseline window\",color:k.textColor}},scales:{x:{ticks:{color:k.subtleTextColor},grid:{color:k.gridColor}},y:{beginAtZero:!0,ticks:{precision:0,color:k.subtleTextColor},grid:{color:k.gridColor},title:{display:!0,text:\"Finishers\",color:k.textColor}}}}})):((r=document.createElement(\"div\")).style.color=k.subtleTextColor,r.style.fontSize=\"12px\",r.style.marginTop=\"8px\",r.textContent=\"No historical data available for the baseline window.\",t.appendChild(r)),u.appendChild(t),s.filter(function(e){return e.change&&0<e.change.finishersChange&&void 0!==e.change.finishersPct})),h=_toConsumableArray(n).sort(function(e,t){return t.change.finishersChange-e.change.finishersChange}).slice(0,1),r=_toConsumableArray(n).filter(function(e){return 0<e.change.finishersPct}).sort(function(e,t){return t.change.finishersPct-e.change.finishersPct}).slice(0,1),f=document.createElement(\"div\"),t=(f.style.marginTop=\"18px\",f.style.padding=\"12px\",f.style.backgroundColor=\"#2b223d\",f.style.borderRadius=\"4px\",document.createElement(\"h3\")),n=(t.textContent=\"Most Impacted parkruns\",t.style.color=k.barColor,t.style.margin=\"0 0 10px 0\",f.appendChild(t),document.createElement(\"div\")),t=(n.style.color=k.textColor,n.style.fontSize=\"13px\",0===h.length?(n.textContent=\"No nearby parkruns saw an attendance increase on this date.\",f.appendChild(n)):(t=[],h[0]&&(m=h[0],t.push(\"Largest absolute gain: <strong>\".concat(m.displayName||m.eventName,\"</strong> (+\").concat(m.change.finishersChange,\" finishers, \").concat(m.change.finishersPct.toFixed(1),\"%)\"))),r[0]&&(m=r[0],t.push(\"Largest relative gain: <strong>\".concat(m.displayName||m.eventName,\"</strong> (+\").concat(m.change.finishersPct.toFixed(1),\"%, +\").concat(m.change.finishersChange,\" finishers)\"))),n.innerHTML=t.join(\"<br>\"),f.appendChild(n),m=[h[0],r[0]].filter(Boolean),l=new Set,m.forEach(function(e){var t,n,r,o,a;e&&e.seasonalTrend&&e.seasonalTrend.filtered&&(l.has(e.eventName)||(l.add(e.eventName),(t=document.createElement(\"div\")).style.marginTop=\"12px\",t.style.padding=\"10px\",t.style.backgroundColor=\"#3a3250\",t.style.borderRadius=\"4px\",(n=document.createElement(\"div\")).style.color=k.textColor,n.style.fontWeight=\"bold\",n.style.marginBottom=\"6px\",n.textContent=e.displayName||e.eventName,t.appendChild(n),(n=document.createElement(\"div\")).style.color=k.textColor,n.style.fontSize=\"12px\",n.style.display=\"grid\",n.style.gridTemplateColumns=\"repeat(auto-fit, minmax(160px, 1fr))\",n.style.gap=\"6px\",n.innerHTML=\"\\n          <div>Avg finishers: <strong>\".concat(e.seasonalTrend.baseline.avgFinishers,\"</strong></div>\\n          <div>Min finishers: <strong>\").concat(e.seasonalTrend.baseline.minFinishers,\"</strong></div>\\n          <div>Max finishers: <strong>\").concat(e.seasonalTrend.baseline.maxFinishers,\"</strong></div>\\n          <div>Avg volunteers: <strong>\").concat(e.seasonalTrend.baseline.avgVolunteers,\"</strong></div>\\n          <div>Min volunteers: <strong>\").concat(e.seasonalTrend.baseline.minVolunteers,\"</strong></div>\\n          <div>Max volunteers: <strong>\").concat(e.seasonalTrend.baseline.maxVolunteers,\"</strong></div>\\n        \"),t.appendChild(n),\"undefined\"!=typeof Chart&&e.seasonalTrend.filtered.finishers&&0<e.seasonalTrend.filtered.finishers.length&&((n=document.createElement(\"canvas\")).style.marginTop=\"10px\",t.appendChild(n),r=_toConsumableArray(e.seasonalTrend.filtered.dates),o=_toConsumableArray(e.seasonalTrend.filtered.finishers),a=_toConsumableArray(e.seasonalTrend.filtered.volunteers),e.eventOnDate&&(r.push(i),o.push(e.eventOnDate.finishers),a.push(e.eventOnDate.volunteers)),new Chart(n.getContext(\"2d\"),{type:\"line\",data:{labels:r,datasets:[{label:\"Finishers\",data:o,borderColor:k.lineColor,backgroundColor:\"rgba(34, 211, 238, 0.25)\",tension:.2,fill:!0},{label:\"Volunteers\",data:a,borderColor:k.successColor,backgroundColor:\"rgba(16, 185, 129, 0.18)\",tension:.2,fill:!0},{label:\"Finishers baseline avg\",data:r.map(function(){return e.seasonalTrend.baseline.avgFinishers}),borderColor:k.barColor,borderDash:[6,4],pointRadius:0},{label:\"Volunteers baseline avg\",data:r.map(function(){return e.seasonalTrend.baseline.avgVolunteers}),borderColor:k.gridColor,borderDash:[6,4],pointRadius:0}]},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:1.6,plugins:{legend:{labels:{color:k.textColor}},title:{display:!0,text:\"Seasonal trend\",color:k.textColor}},scales:{x:{ticks:{color:k.subtleTextColor},grid:{color:k.gridColor}},y:{beginAtZero:!0,ticks:{precision:0,color:k.subtleTextColor},grid:{color:k.gridColor},title:{display:!0,text:\"Count\",color:k.textColor}}}}})),f.appendChild(t)))})),u.appendChild(f),\"undefined\"!=typeof Chart&&((t=document.createElement(\"div\")).style.marginTop=\"30px\",(n=document.createElement(\"h3\")).textContent=\"Visual Impact Analysis\",n.style.color=k.barColor,n.style.marginBottom=\"15px\",t.appendChild(n),(h=document.createElement(\"div\")).style.display=\"grid\",h.style.gridTemplateColumns=\"1fr 1fr\",h.style.gap=\"20px\",r=document.createElement(\"canvas\"),(m=document.createElement(\"div\")).style.minWidth=\"0\",m.appendChild(r),h.appendChild(m),n=document.createElement(\"canvas\"),(m=document.createElement(\"div\")).style.minWidth=\"0\",m.appendChild(n),h.appendChild(m),t.appendChild(h),u.appendChild(t),m=s.filter(function(e){return e.eventOnDate}).map(function(e){return e.title||e.eventName}),h=s.filter(function(e){return e.eventOnDate}).map(function(e){return e.baseline.avgFinishers}),t=s.filter(function(e){return e.eventOnDate}).map(function(e){return e.eventOnDate.finishers}),new Chart(r.getContext(\"2d\"),{type:\"bar\",data:{labels:m,datasets:[{label:\"Baseline (12-event avg)\",data:h,backgroundColor:k.barColor,borderColor:k.barColor,borderWidth:1},{label:\"Actual on \".concat(i),data:t,backgroundColor:k.lineColor,borderColor:k.lineColor,borderWidth:1}]},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,plugins:{legend:{labels:{color:k.textColor}},title:{display:!0,text:\"Finishers: Baseline vs Actual\",color:k.textColor}},scales:{x:{ticks:{color:k.subtleTextColor,display:!1},grid:{color:k.gridColor}},y:{beginAtZero:!0,title:{display:!0,text:\"Finishers\",color:k.textColor},ticks:{precision:0,color:k.subtleTextColor},grid:{color:k.gridColor}}}}}),r=s.filter(function(e){return e.eventOnDate}).map(function(e){return e.baseline.avgVolunteers}),h=s.filter(function(e){return e.eventOnDate}).map(function(e){return e.eventOnDate.volunteers}),new Chart(n.getContext(\"2d\"),{type:\"bar\",data:{labels:m,datasets:[{label:\"Baseline (12-event avg)\",data:r,backgroundColor:k.barColor,borderColor:k.barColor,borderWidth:1},{label:\"Actual on \".concat(i),data:h,backgroundColor:k.lineColor,borderColor:k.lineColor,borderWidth:1}]},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:1.5,plugins:{legend:{labels:{color:k.textColor}},title:{display:!0,text:\"Volunteers: Baseline vs Actual\",color:k.textColor}},scales:{x:{ticks:{color:k.subtleTextColor,display:!1},grid:{color:k.gridColor}},y:{beginAtZero:!0,title:{display:!0,text:\"Volunteers\",color:k.textColor},ticks:{precision:0,color:k.subtleTextColor},grid:{color:k.gridColor}}}}})),document.createElement(\"div\")),n=(t.style.marginTop=\"20px\",t.style.padding=\"12px\",t.style.backgroundColor=\"#3a3250\",t.style.borderRadius=\"4px\",document.createElement(\"h4\")),m=(n.textContent=\"Summary\",n.style.margin=\"0 0 8px 0\",n.style.color=k.lineColor,t.appendChild(n),s.filter(function(e){return e.eventOnDate&&e.change})),r=m.reduce(function(e,t){return e+t.change.finishersChange},0),h=m.reduce(function(e,t){return e+t.change.volunteersChange},0),n=0<m.length?Math.round(r/m.length):0,b=0<m.length?Math.round(m.reduce(function(e,t){return e+t.change.volunteersChange},0)/m.length):0,v=document.createElement(\"div\"),m=(v.style.fontSize=\"13px\",v.style.color=k.textColor,v.innerHTML='\\n      <p style=\"margin: 4px 0;\">\\n        <strong>'.concat(s.length,'</strong> nearby parkruns analyzed\\n        <span style=\"color: ').concat(k.subtleTextColor,'; font-size: 11px; margin-left: 8px;\" title=\"parkruns within 50km of the cancelled event in the same country and series\">‚Ñπ</span>\\n      </p>\\n      <p style=\"margin: 4px 0;\">\\n        <strong>').concat(m.length,\"</strong> held events on \").concat(i,'\\n        <span style=\"color: ').concat(k.subtleTextColor,'; font-size: 11px; margin-left: 8px;\" title=\"Number of nearby parkruns that ran on this date\">‚Ñπ</span>\\n      </p>\\n      <p style=\"margin: 4px 0;\">\\n        Average change in finishers: <span style=\"color: ').concat(n<0?k.alertColor:k.successColor,'; font-weight: bold;\">').concat(0<n?\"+\":\"\").concat(n,'</span>\\n        <span style=\"color: ').concat(k.subtleTextColor,'; font-size: 11px; margin-left: 8px;\" title=\"Mean difference between actual finishers and 12-event baseline average across events that ran\">‚Ñπ</span>\\n      </p>\\n      <p style=\"margin: 4px 0;\">\\n        Average change in volunteers: <span style=\"color: ').concat(b<0?k.alertColor:k.successColor,'; font-weight: bold;\">').concat(0<b?\"+\":\"\").concat(b,'</span>\\n        <span style=\"color: ').concat(k.subtleTextColor,'; font-size: 11px; margin-left: 8px;\" title=\"Mean difference between actual volunteers and 12-event baseline average across events that ran\">‚Ñπ</span>\\n      </p>\\n      <p style=\"margin: 4px 0;\">\\n        Estimated total additional finishers: <span style=\"color: ').concat(r<0?k.alertColor:k.successColor,'; font-weight: bold;\">').concat(0<r?\"+\":\"\").concat(r,'</span>\\n        <span style=\"color: ').concat(k.subtleTextColor,'; font-size: 11px; margin-left: 8px;\" title=\"Sum of all finisher changes across nearby parkruns - positive indicates runners redistributed from the cancelled event\">‚Ñπ</span>\\n      </p>\\n      <p style=\"margin: 4px 0;\">\\n        Estimated total additional volunteers: <span style=\"color: ').concat(h<0?k.alertColor:k.successColor,'; font-weight: bold;\">').concat(0<h?\"+\":\"\").concat(h,'</span>\\n        <span style=\"color: ').concat(k.subtleTextColor,'; font-size: 11px; margin-left: 8px;\" title=\"Sum of all volunteer changes across nearby parkruns - indicates how many extra volunteers were needed on the day\">‚Ñπ</span>\\n      </p>\\n    '),t.appendChild(v),u.appendChild(t),document.createElement(\"div\")),C=(m.style.display=\"flex\",m.style.justifyContent=\"center\",m.style.marginTop=\"20px\",m.style.gap=\"10px\",m.style.flexWrap=\"wrap\",document.createElement(\"button\")),x=(C.textContent=\"üìÑ Export HTML\",C.style.padding=\"8px 16px\",C.style.backgroundColor=k.barColor,C.style.color=\"#1c1b2a\",C.style.border=\"none\",C.style.borderRadius=\"4px\",C.style.cursor=\"pointer\",C.style.fontWeight=\"bold\",C.style.fontSize=\"14px\",C.addEventListener(\"click\",_asyncToGenerator(_regenerator().m(function e(){var t,n,r,o,a,l,s;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=C.textContent,n=C.style.display,C.textContent=\"Exporting...\",C.disabled=!0,C.style.display=\"none\",e.p=1,o=d(),r=o.eventShortName,o=o.cancellationDateStr,e.n=2,D(u,{eventShortName:r,cancellationDateStr:o,generatedAt:(new Date).toLocaleString()});case 2:r=e.v,o=r.blob,s=r.filename,a=URL.createObjectURL(o),(l=document.createElement(\"a\")).href=a,l.download=s,l.click(),setTimeout(function(){return URL.revokeObjectURL(a)},1e3),console.log(\"HTML export complete\"),e.n=4;break;case 3:e.p=3,s=e.v,console.error(\"HTML export failed:\",s),alert(\"Error exporting HTML: \"+s.message);case 4:return e.p=4,C.disabled=!1,C.textContent=t,C.style.display=n,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))),document.createElement(\"button\"));x.textContent=\"üì§ Share Report\",x.style.padding=\"8px 16px\",x.style.backgroundColor=k.lineColor,x.style.color=\"#2b223d\",x.style.border=\"none\",x.style.borderRadius=\"4px\",x.style.cursor=\"pointer\",x.style.fontWeight=\"bold\",x.style.fontSize=\"14px\",x.addEventListener(\"click\",_asyncToGenerator(_regenerator().m(function e(){var t,n,r,o,a,l,s,i,c;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=x.textContent,n=x.style.display,x.textContent=\"Sharing...\",x.disabled=!0,x.style.display=\"none\",e.p=1,o=d(),r=o.eventShortName,o=o.cancellationDateStr,e.n=2,D(u,{eventShortName:r,cancellationDateStr:o,generatedAt:(new Date).toLocaleString()});case 2:if(l=e.v,a=l.blob,l=l.filename,i=new File([a],l,{type:\"text/html\"}),navigator.canShare&&navigator.canShare({files:[i]}))return e.n=3,navigator.share({title:\"parkrun Cancellation Impact - \".concat(r),text:\"Cancellation date: \".concat(o),files:[i]});e.n=4;break;case 3:console.log(\"Report shared via Web Share API\"),e.n=5;break;case 4:s=URL.createObjectURL(a),(i=document.createElement(\"a\")).href=s,i.download=l,i.click(),setTimeout(function(){return URL.revokeObjectURL(s)},1e3),alert(\"Sharing is not supported in this browser, so the HTML report was downloaded instead.\");case 5:e.n=7;break;case 6:e.p=6,c=e.v,console.error(\"Share failed:\",c),alert(\"Error sharing report: \"+c.message);case 7:return e.p=7,x.disabled=!1,x.textContent=t,x.style.display=n,e.f(7);case 8:return e.a(2)}},e,null,[[1,6,7,8]])}))),m.appendChild(C),m.appendChild(x),u.appendChild(m),e.appendChild(u)}function t(){return(t=_asyncToGenerator(_regenerator().m(function e(){var t,n;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t=document.querySelector(\".Results-table\"),n=window.location.href,n=n.includes(\"/eventhistory/\"),t&&n){e.n=1;break}return e.a(2);case 1:return e.n=2,function(){return r.apply(this,arguments)}();case 2:S.allParkruns=e.v,!function(){o.apply(this,arguments)}();case 3:return e.a(2)}},e)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()})();"
  },
  "parkrun-annual-summary.user.js": {
    "name": "parkrun Annual Summary",
    "description": "Adds an annual participation summary (totals, averages, min/max) to parkrun event history pages",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/parkrun-annual-summary.user.js",
    "bookmarklet": "javascript:function _typeof(e){return(_typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _iterableToArray(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _regenerator(){var m,e=\"function\"==typeof Symbol?Symbol:{},t=e.iterator||\"@@iterator\",r=e.toStringTag||\"@@toStringTag\";function n(e,t,r,n){var o,a,l,i,s,c,u,d,p,t=t&&t.prototype instanceof f?t:f,t=Object.create(t.prototype);return _regeneratorDefine2(t,\"_invoke\",(o=e,a=r,u=n||[],d=!1,p={p:c=0,n:0,v:m,a:y,f:y.bind(m,4),d:function(e,t){return l=e,i=0,s=m,p.n=t,h}},function(e,t,r){if(1<c)throw TypeError(\"Generator is already running\");for(d&&1===t&&y(t,r),i=t,s=r;(g=i<2?m:s)||!d;){l||(i?i<3?(1<i&&(p.n=-1),y(i,s)):p.n=s:p.v=s);try{if(c=2,l){if(g=l[e=i?e:\"next\"]){if(!(g=g.call(l,s)))throw TypeError(\"iterator result is not an object\");if(!g.done)return g;s=g.value,i<2&&(i=0)}else 1===i&&(g=l.return)&&g.call(l),i<2&&(s=TypeError(\"The iterator does not provide a '\"+e+\"' method\"),i=1);l=m}else if((g=(d=p.n<0)?s:o.call(a,p))!==h)break}catch(e){l=m,i=1,s=e}finally{c=1}}return{value:g,done:d}}),!0),t;function y(e,t){for(i=e,s=t,g=0;!d&&c&&!r&&g<u.length;g++){var r,n=u[g],o=p.p,a=n[2];3<e?(r=a===t)&&(s=n[(i=n[4])?5:i=3],n[4]=n[5]=m):n[0]<=o&&((r=e<2&&o<n[1])?(i=0,p.v=t,p.n=n[1]):o<a&&(r=e<3||n[0]>t||a<t)&&(n[4]=e,n[5]=t,p.n=a,i=0))}if(r||1<e)return h;throw d=!0,t}}var h={};function f(){}function o(){}function a(){}var g=Object.getPrototypeOf,e=[][t]?g(g([][t]())):(_regeneratorDefine2(g={},t,function(){return this}),g),l=a.prototype=f.prototype=Object.create(e);function i(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,_regeneratorDefine2(e,r,\"GeneratorFunction\")),e.prototype=Object.create(l),e}return _regeneratorDefine2(l,\"constructor\",o.prototype=a),_regeneratorDefine2(a,\"constructor\",o),_regeneratorDefine2(a,r,o.displayName=\"GeneratorFunction\"),_regeneratorDefine2(l),_regeneratorDefine2(l,r,\"Generator\"),_regeneratorDefine2(l,t,function(){return this}),_regeneratorDefine2(l,\"toString\",function(){return\"[object Generator]\"}),(_regenerator=function(){return{w:n,m:i}})()}function _regeneratorDefine2(e,t,r,n){var a=Object.defineProperty;try{a({},\"\",{})}catch(e){a=0}(_regeneratorDefine2=function(e,t,r,n){function o(t,r){_regeneratorDefine2(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o(\"next\",0),o(\"throw\",1),o(\"return\",2))})(e,t,r,n)}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,\"string\");return\"symbol\"==_typeof(e)?e:e+\"\"}function _toPrimitive(e,t){if(\"object\"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return(\"string\"===t?String:Number)(e);r=r.call(e,t||\"default\");if(\"object\"!=_typeof(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(e,t){var r;if(e)return\"string\"==typeof e?_arrayLikeToArray(e,t):\"Map\"===(r=\"Object\"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a,l,i=[],s=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=a.call(r)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw o}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,r,n,o,a,l){try{var i=e[a](l),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(i){return function(){var e=this,l=arguments;return new Promise(function(t,r){var n=i.apply(e,l);function o(e){asyncGeneratorStep(n,t,r,o,a,\"next\",e)}function a(e){asyncGeneratorStep(n,t,r,o,a,\"throw\",e)}o(void 0)})}}(()=>{var w={backgroundColor:\"#1c1b2a\",barColor:\"#f59e0b\",lineColor:\"#22d3ee\",textColor:\"#f3f4f6\",subtleTextColor:\"#d1d5db\",gridColor:\"rgba(243, 244, 246, 0.18)\"},E=[\"#f59e0b\",\"#22d3ee\",\"#f97316\",\"#10b981\",\"#a855f7\",\"#ef4444\",\"#3b82f6\",\"#84cc16\"],S={currentEvent:null,comparisonEvents:[],allParkruns:null};function n(){return(n=_asyncToGenerator(_regenerator().m(function e(){var t,r,n,o,a,l;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=\"parkrun_events_cache\",e.p=1,a=localStorage.getItem(t)){if(e.p=2,a=JSON.parse(a),n=a.data,a=a.timestamp,(a=Date.now()-a)<864e5)return console.log(\"Using cached parkrun events (\".concat(Math.round(a/1e3/60),\" minutes old)\")),e.a(2,n);e.n=3}else e.n=5;break;case 3:e.n=5;break;case 4:e.p=4,a=e.v,console.log(\"Cache parse error, fetching fresh data\",a);case 5:return console.log(\"Fetching parkrun events from https://images.parkrun.com/events.json\"),e.n=6,fetch(\"https://images.parkrun.com/events.json\");case 6:if(r=e.v,console.log(\"Fetch response status:\",r.status,r.statusText),r.ok){e.n=7;break}return console.error(\"Fetch failed with status:\",r.status),e.a(2,[]);case 7:return e.n=8,r.json();case 8:if(n=e.v,o=(null==(o=n.events)?void 0:o.features)||n.features||[],console.log(\"Features array length:\",o.length),o&&0!==o.length){e.n=9;break}return console.error(\"No features found in response data\"),e.a(2,[]);case 9:try{localStorage.setItem(t,JSON.stringify({data:o,timestamp:Date.now()})),console.log(\"Cached\",o.length,\"parkrun events for 24 hours\")}catch(e){console.warn(\"Failed to cache parkrun events:\",e)}return console.log(\"Successfully loaded\",o.length,\"parkrun events\"),e.a(2,o);case 10:return e.p=10,l=e.v,console.error(\"Failed to fetch parkruns:\",l),console.error(\"Error details:\",l.message,l.stack),e.a(2,[])}},e,null,[[2,4],[1,10]])}))).apply(this,arguments)}function _(){return{eventName:window.location.pathname.split(\"/\")[1],domain:window.location.hostname,url:window.location.origin}}function A(e,t,r,n){var o=(r-e)*Math.PI/180,n=(n-t)*Math.PI/180,t=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t)))}function a(){return(a=_asyncToGenerator(_regenerator().m(function e(t,r){var n,o,a,l;return _regenerator().w(function(e){for(;;)if(0===e.n)return n=t.cloneNode(!0),a=t.querySelectorAll(\"canvas\"),o=n.querySelectorAll(\"canvas\"),a.forEach(function(e,t){try{var r=e.toDataURL(\"image/png\"),n=document.createElement(\"img\");n.src=r,n.alt=\"Chart snapshot\",n.style.maxWidth=\"100%\",n.style.display=\"block\",n.style.backgroundColor=\"#2b223d\",o[t]&&o[t].replaceWith(n)}catch(e){console.error(\"Failed to serialize chart canvas:\",e)}}),a=\"\\n      :root { color-scheme: dark; }\\n      body { margin: 0; padding: 20px; background: \".concat(w.backgroundColor,\"; color: \").concat(w.textColor,'; font-family: \"Segoe UI\", \"Helvetica Neue\", Arial, sans-serif; line-height: 1.5; }\\n      a { color: ').concat(w.lineColor,\"; }\\n      h1, h2, h3, h4 { color: \").concat(w.barColor,\"; margin: 0 0 10px 0; }\\n      table { width: 100%; border-collapse: collapse; }\\n      th, td { border: 1px solid \").concat(w.gridColor,\"; padding: 10px; text-align: left; }\\n      th { background: #2b223d; color: \").concat(w.barColor,\"; }\\n      tr:nth-child(even) td { background: #241c35; }\\n      tr:nth-child(odd) td { background: #1f182e; }\\n      .parkrun-annual-summary { background: \").concat(w.backgroundColor,\"; padding: 16px; border-radius: 6px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25); }\\n      .chart-img { max-width: 100%; display: block; }\\n      .meta { margin-bottom: 16px; color: \").concat(w.subtleTextColor,\"; font-size: 13px; }\\n      .meta strong { color: \").concat(w.textColor,\"; }\\n    \"),l='\\n      <header>\\n        <h1>parkrun Annual Summary</h1>\\n        <div class=\"meta\">\\n          <div><strong>Event:</strong> '.concat(r.eventShortName,\"</div>\\n          <div><strong>Generated:</strong> \").concat(r.generatedAt,\"</div>\\n        </div>\\n      </header>\\n    \"),e.a(2,'<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><title>parkrun Annual Summary - '.concat(r.eventShortName,\"</title><style>\").concat(a,\"</style></head><body>\").concat(l).concat(n.outerHTML,\"</body></html>\"))},e)}))).apply(this,arguments)}function T(){return e.apply(this,arguments)}function e(){return(e=_asyncToGenerator(_regenerator().m(function e(t,r){var n,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,function(){return a.apply(this,arguments)}(t,r);case 1:return n=e.v,o=\"parkrun-annual-summary-\".concat(r.eventShortName,\"-\").concat(r.generatedAtISO,\".html\"),e.a(2,{blob:new Blob([n],{type:\"text/html\"}),filename:o})}},e)}))).apply(this,arguments)}function i(){return(i=_asyncToGenerator(_regenerator().m(function e(t,r){var n,o,a,l,i,s,c;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n=\"\".concat(r,\"/\").concat(t,\"/results/eventhistory/\"),e.n=1,fetch(n);case 1:return n=e.v,e.n=2,n.text();case 2:return o=e.v,c=new DOMParser,c=c.parseFromString(o,\"text/html\"),o=null!=(o=null==(o=c.querySelector(\"h1\"))?void 0:o.textContent.trim())?o:\"\".concat(t,\" Event History\"),a=[],l=[],i=[],s=[],c=c.querySelectorAll(\"tr.Results-table-row\"),Array.from(c).reverse().forEach(function(e){var t=e.getAttribute(\"data-parkrun\"),t=(t&&a.push(t),e.getAttribute(\"data-date\")),t=(t&&(t=new Date(t).toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),l.push(t)),e.getAttribute(\"data-finishers\")),t=(t&&i.push(parseInt(t,10)),e.getAttribute(\"data-volunteers\"));t&&s.push(parseInt(t,10))}),e.a(2,{eventName:t,title:o,eventNumbers:a,dates:l,finishers:i,volunteers:s});case 3:return e.p=3,c=e.v,console.error(\"Failed to fetch event history for \".concat(t,\":\"),c),e.a(2,null)}},e,null,[[0,3]])}))).apply(this,arguments)}function F(a){var l={};return a.dates.forEach(function(e,t){var e=new Date(e).getFullYear(),r=null!=(r=a.finishers[t])?r:0,n=null!=(n=a.volunteers[t])?n:0,o=a.eventNumbers[t],e=(l[e]||(l[e]={year:e,eventCount:0,totalFinishers:0,totalVolunteers:0,minFinishers:null,maxFinishers:null,minVolunteers:null,maxVolunteers:null}),l[e]);e.eventCount++,e.totalFinishers+=r,e.totalVolunteers+=n,(null===e.minFinishers||r<e.minFinishers.value)&&(e.minFinishers={value:r,date:a.dates[t],eventNumber:o}),(null===e.maxFinishers||r>e.maxFinishers.value)&&(e.maxFinishers={value:r,date:a.dates[t],eventNumber:o}),(null===e.minVolunteers||n<e.minVolunteers.value)&&(e.minVolunteers={value:n,date:a.dates[t],eventNumber:o}),(null===e.maxVolunteers||n>e.maxVolunteers.value)&&(e.maxVolunteers={value:n,date:a.dates[t],eventNumber:o})}),Object.keys(l).map(Number).sort(function(e,t){return e-t}).map(function(e){var t=l[e];return{year:e,eventCount:t.eventCount,totalFinishers:t.totalFinishers,totalVolunteers:t.totalVolunteers,avgFinishers:Math.round(t.totalFinishers/t.eventCount),avgVolunteers:Math.round(t.totalVolunteers/t.eventCount),minFinishers:t.minFinishers,maxFinishers:t.maxFinishers,minVolunteers:t.minVolunteers,maxVolunteers:t.maxVolunteers,finishersGrowth:null,volunteersGrowth:null}}).map(function(e,t,r){return 0===t?e:(t=(r=r[t-1]).avgFinishers?(e.avgFinishers-r.avgFinishers)/r.avgFinishers*100:null,r=r.avgVolunteers?(e.avgVolunteers-r.avgVolunteers)/r.avgVolunteers*100:null,_objectSpread(_objectSpread({},e),{},{finishersGrowth:t,volunteersGrowth:r}))})}function p(e){return e?e.value.toLocaleString():\"-\"}function y(e){var t,r;return null===e||Number.isNaN(e)?\"-\":(t=0<e?\"+\":\"\",r=0<e?\"#53BA9D\":e<0?\"#ff6b6b\":w.subtleTextColor,'<span style=\"color: '.concat(r,';\">').concat(t).concat(e.toFixed(1),\"%</span>\"))}function N(o){var e=document.createElement(\"div\"),t=(e.style.marginBottom=\"15px\",e.style.padding=\"10px\",e.style.backgroundColor=w.backgroundColor,e.style.borderRadius=\"6px\",e.style.display=\"flex\",e.style.alignItems=\"center\",e.style.gap=\"10px\",e.style.flexWrap=\"wrap\",document.createElement(\"span\")),a=(t.textContent=\"Compare with:\",t.style.color=w.textColor,t.style.fontWeight=\"bold\",e.appendChild(t),document.createElement(\"select\")),t=(a.style.padding=\"6px 12px\",a.style.backgroundColor=\"#3a3250\",a.style.color=w.textColor,a.style.border=\"1px solid \".concat(w.gridColor),a.style.borderRadius=\"4px\",a.style.cursor=\"pointer\",document.createElement(\"option\")),l=(t.value=\"\",t.textContent=\"-- Select parkrun --\",a.appendChild(t),o.forEach(function(e){var t=document.createElement(\"option\");t.value=e.properties.eventname,t.textContent=\"\".concat(e.properties.EventShortName,\" (\").concat(e.distance.toFixed(1),\"km)\"),a.appendChild(t)}),document.createElement(\"button\"));return l.textContent=\"+ Add\",l.style.padding=\"6px 12px\",l.style.backgroundColor=w.lineColor,l.style.color=\"#2b223d\",l.style.border=\"none\",l.style.borderRadius=\"4px\",l.style.cursor=\"pointer\",l.style.fontWeight=\"bold\",l.addEventListener(\"click\",_asyncToGenerator(_regenerator().m(function e(){var t,r,n;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t=a.value){e.n=1;break}return e.a(2);case 1:if(S.comparisonEvents.some(function(e){return e.eventName===t}))return alert(\"This parkrun is already selected for comparison\"),e.a(2);e.n=2;break;case 2:return l.disabled=!0,l.textContent=\"Loading...\",r=_(),e.n=3,function(){return i.apply(this,arguments)}(t,r.url);case 3:(r=e.v)?(n=o.find(function(e){return e.properties.eventname===t}),S.comparisonEvents.push(_objectSpread(_objectSpread({},r),{},{distance:null==n?void 0:n.distance})),G()):alert(\"Failed to fetch event history\"),l.disabled=!1,l.textContent=\"+ Add\",a.value=\"\";case 4:return e.a(2)}},e)}))),e.appendChild(a),e.appendChild(l),e}function j(e,t){var r=F(e);if(0===r.length)return null;var e=document.createElement(\"div\"),n=(e.className=\"tab-content\",e.style.display=0===t?\"block\":\"none\",e.style.backgroundColor=w.backgroundColor,e.style.padding=\"15px\",e.style.borderRadius=\"6px\",document.createElement(\"div\")),o=(n.style.overflowX=\"auto\",document.createElement(\"table\")),a=(o.className=\"annualSummaryTable\",o.style.width=\"100%\",o.style.borderCollapse=\"collapse\",o.style.fontSize=\"14px\",o.style.color=w.textColor,o.style.backgroundColor=w.backgroundColor,{key:\"year\",dir:\"asc\"}),l=[{key:\"year\",label:\"Year\",align:\"left\"},{key:\"eventCount\",label:\"Events\",align:\"center\"},{key:\"totalFinishers\",label:\"Finishers Total\",align:\"right\",color:w.barColor},{key:\"minFinishers\",label:\"Finishers Min\",align:\"right\",color:w.barColor},{key:\"maxFinishers\",label:\"Finishers Max\",align:\"right\",color:w.barColor},{key:\"avgFinishers\",label:\"Finishers Avg\",align:\"right\",color:w.barColor},{key:\"finishersGrowth\",label:\"Finishers YoY\",align:\"right\"},{key:\"totalVolunteers\",label:\"Volunteers Total\",align:\"right\",color:w.lineColor},{key:\"minVolunteers\",label:\"Volunteers Min\",align:\"right\",color:w.lineColor},{key:\"maxVolunteers\",label:\"Volunteers Max\",align:\"right\",color:w.lineColor},{key:\"avgVolunteers\",label:\"Volunteers Avg\",align:\"right\",color:w.lineColor},{key:\"volunteersGrowth\",label:\"Volunteers YoY\",align:\"right\"}],i=document.createElement(\"thead\"),s=document.createElement(\"tr\"),c=(s.style.borderBottom=\"2px solid \".concat(w.gridColor),l.forEach(function(e){var t=document.createElement(\"th\");t.textContent=e.label,t.style.padding=\"10px\",t.style.textAlign=e.align,t.style.cursor=\"pointer\",e.color&&(t.style.color=e.color),t.addEventListener(\"click\",function(){a.key===e.key?a.dir=\"asc\"===a.dir?\"desc\":\"asc\":(a.key=e.key,a.dir=\"desc\"),u()}),s.appendChild(t)}),i.appendChild(s),o.appendChild(i),document.createElement(\"tbody\"));function u(){c.innerHTML=\"\",_toConsumableArray(r).sort(function(e,t){function r(e){return null==(e=e[n])?-1/0:\"object\"===_typeof(e)&&void 0!==e.value?e.value:e}var n=a.key,o=\"asc\"===a.dir?1:-1,e=r(e),t=r(t);return e===t?0:t<e?o:-o}).forEach(function(e){var t=document.createElement(\"tr\");t.style.borderBottom=\"1px solid \".concat(w.gridColor),t.innerHTML='\\n          <td style=\"padding: 10px; text-align: left; font-weight: bold;\">'.concat(e.year,'</td>\\n          <td style=\"padding: 10px; text-align: center;\">').concat(e.eventCount,'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.barColor,';\">').concat(e.totalFinishers.toLocaleString(),'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.barColor,';\">').concat(p(e.minFinishers),'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.barColor,';\">').concat(p(e.maxFinishers),'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.barColor,';\">').concat(e.avgFinishers,'</td>\\n          <td style=\"padding: 10px; text-align: right;\">').concat(y(e.finishersGrowth),'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.lineColor,';\">').concat(e.totalVolunteers.toLocaleString(),'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.lineColor,';\">').concat(p(e.minVolunteers),'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.lineColor,';\">').concat(p(e.maxVolunteers),'</td>\\n          <td style=\"padding: 10px; text-align: right; color: ').concat(w.lineColor,';\">').concat(e.avgVolunteers,'</td>\\n          <td style=\"padding: 10px; text-align: right;\">').concat(y(e.volunteersGrowth),\"</td>\\n        \"),c.appendChild(t)})}o.appendChild(c),n.appendChild(o),e.appendChild(n),u();var l=document.createElement(\"div\"),i=(l.style.display=\"grid\",l.style.gridTemplateColumns=\"1fr 1fr\",l.style.gap=\"20px\",l.style.marginTop=\"20px\",document.createElement(\"div\")),o=(i.style.minWidth=\"0\",document.createElement(\"canvas\")),n=(o.className=\"annualTotalsChart-\".concat(t),i.appendChild(o),document.createElement(\"div\")),d=(n.style.minWidth=\"0\",document.createElement(\"canvas\"));return d.className=\"annualGrowthChart-\".concat(t),n.appendChild(d),l.appendChild(i),l.appendChild(n),e.appendChild(l),\"undefined\"!=typeof Chart&&(t=o.getContext(\"2d\"),i=d.getContext(\"2d\"),n=r.map(function(e){return e.year.toString()}),new Chart(t,{type:\"bar\",data:{labels:n,datasets:[{label:\"Total Finishers\",data:r.map(function(e){return e.totalFinishers}),backgroundColor:w.barColor,borderColor:w.barColor,borderWidth:1},{label:\"Total Volunteers\",data:r.map(function(e){return e.totalVolunteers}),backgroundColor:w.lineColor,borderColor:w.lineColor,borderWidth:1}]},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:1.3,plugins:{legend:{labels:{color:w.textColor}},title:{display:!0,text:\"Annual Totals\",color:w.textColor}},scales:{x:{title:{display:!0,text:\"Year\",color:w.textColor},ticks:{color:w.subtleTextColor},grid:{color:w.gridColor}},y:{beginAtZero:!0,title:{display:!0,text:\"Participants\",color:w.textColor},ticks:{precision:0,color:w.subtleTextColor},grid:{color:w.gridColor}}}}}),l=r.filter(function(e){return null!==e.finishersGrowth}),new Chart(i,{type:\"line\",data:{labels:l.map(function(e){return e.year.toString()}),datasets:[{label:\"Finishers Growth\",data:l.map(function(e){return e.finishersGrowth}),borderColor:w.barColor,backgroundColor:w.barColor,borderWidth:2,pointRadius:4,pointBackgroundColor:w.barColor,fill:!1,tension:.2},{label:\"Volunteers Growth\",data:l.map(function(e){return e.volunteersGrowth}),borderColor:w.lineColor,backgroundColor:w.lineColor,borderWidth:2,pointRadius:4,pointBackgroundColor:w.lineColor,fill:!1,tension:.2}]},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:1.3,plugins:{legend:{labels:{color:w.textColor}},title:{display:!0,text:\"Year-over-Year Growth (%)\",color:w.textColor}},scales:{x:{title:{display:!0,text:\"Year\",color:w.textColor},ticks:{color:w.subtleTextColor},grid:{color:w.gridColor}},y:{title:{display:!0,text:\"Growth (%)\",color:w.textColor},ticks:{color:w.subtleTextColor,callback:function(e){return e+\"%\"}},grid:{color:w.gridColor}}}}})),e}function O(e){var t=document.createElement(\"div\");return t.style.minWidth=\"0\",t.appendChild(e),t}function V(e,t,o,r,a,n,l){l=6<arguments.length&&void 0!==l&&l,r=r.map(function(e,t){var r=e.event,n=e.yearly,e=E[t%E.length],t=o.map(function(t){var e=n.find(function(e){return e.year===t});return e&&null!=(e=a(e))?e:null});return{label:r.title||r.eventName,data:t,borderColor:e,backgroundColor:e,borderWidth:2,pointRadius:4,pointBackgroundColor:e,fill:!1,tension:.2,spanGaps:!0}}),e=e.getContext(\"2d\");new Chart(e,{type:\"line\",data:{labels:o.map(function(e){return e.toString()}),datasets:r},options:{animation:!1,responsive:!0,maintainAspectRatio:!0,aspectRatio:1.3,plugins:{legend:{labels:{color:w.textColor}},title:{display:!0,text:t,color:w.textColor}},scales:{x:{title:{display:!0,text:\"Year\",color:w.textColor},ticks:{color:w.subtleTextColor},grid:{color:w.gridColor}},y:{beginAtZero:!l,title:{display:!0,text:n,color:w.textColor},ticks:{precision:0,color:w.subtleTextColor,callback:l?function(e){return e+\"%\"}:void 0},grid:{color:w.gridColor}}}}})}function G(){var r,n,o,a,l,i,e,s,c,t,u,d,p,y,m,h,f,g,b,v,x=document.querySelector(\".parkrun-annual-summary\"),C=(x&&x.remove(),x=null!=(x=null==(x=document.querySelector(\"h1\"))?void 0:x.textContent.trim())?x:\"Event History\",r=[],n=[],o=[],a=[],C=document.querySelectorAll(\"tr.Results-table-row\"),Array.from(C).reverse().forEach(function(e){var t=e.getAttribute(\"data-parkrun\"),t=(t&&r.push(t),e.getAttribute(\"data-date\")),t=(t&&(t=new Date(t).toLocaleDateString(void 0,{year:\"numeric\",month:\"short\",day:\"numeric\"}),n.push(t)),e.getAttribute(\"data-finishers\")),t=(t&&o.push(parseInt(t,10)),e.getAttribute(\"data-volunteers\"));t&&a.push(parseInt(t,10))}),{title:x,eventNumbers:r,dates:n,finishers:o,volunteers:a});function k(){l.innerHTML=\"\",[S.currentEvent].concat(_toConsumableArray(S.comparisonEvents)).forEach(function(e,t){var r=document.createElement(\"div\"),n=(r.style.display=\"inline-flex\",r.style.alignItems=\"center\",r.style.gap=\"6px\",r.style.padding=\"4px 10px\",r.style.backgroundColor=E[t%E.length],r.style.color=\"#2b223d\",r.style.borderRadius=\"12px\",r.style.fontSize=\"12px\",r.style.fontWeight=\"bold\",document.createElement(\"span\"));n.textContent=e.title||e.eventName,r.appendChild(n),0<t&&((e=document.createElement(\"span\")).textContent=\"√ó\",e.style.cursor=\"pointer\",e.style.marginLeft=\"4px\",e.style.fontSize=\"16px\",e.addEventListener(\"click\",function(){S.comparisonEvents.splice(t-1,1),G()}),r.appendChild(e)),l.appendChild(r)})}0===C.eventNumbers.length?console.log(\"No event history data found\"):(S.currentEvent=_objectSpread(_objectSpread({},C),{},{eventName:_().eventName}),x=[S.currentEvent].concat(_toConsumableArray(S.comparisonEvents)),(C=document.createElement(\"div\")).className=\"parkrun-annual-summary\",C.style.width=\"100%\",C.style.maxWidth=\"1200px\",C.style.margin=\"20px auto\",C.style.padding=\"15px\",C.style.backgroundColor=w.backgroundColor,C.style.borderRadius=\"8px\",C.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",(t=document.createElement(\"h3\")).textContent=\"Annual Participation Summary\",t.style.textAlign=\"center\",t.style.marginBottom=\"15px\",t.style.color=w.barColor,C.appendChild(t),null===S.allParkruns?((t=document.createElement(\"div\")).style.padding=\"10px\",t.style.color=w.subtleTextColor,t.style.textAlign=\"center\",t.style.fontSize=\"13px\",t.textContent=\"Loading parkrun events for comparison...\",C.appendChild(t)):0===S.allParkruns.length?((t=document.createElement(\"div\")).style.padding=\"10px\",t.style.color=\"#ff6b6b\",t.style.textAlign=\"center\",t.style.fontSize=\"13px\",t.textContent=\"Failed to load parkrun events data. Check console for details.\",C.appendChild(t),console.error(\"No parkrun events loaded. Expected data from https://images.parkrun.com/events.json\")):0<(t=function(o,e,t){var r,a,l,i,s,c=2<arguments.length&&void 0!==t?t:50,t=e.find(function(e){return e.properties.eventname===o.eventName});return t?(r=_slicedToArray(t.geometry.coordinates,2),a=r[0],l=r[1],i=t.properties.countrycode,s=t.properties.seriesid,e.filter(function(e){var t,r,n;return e.properties.eventname!==o.eventName&&e.properties.countrycode===i&&e.properties.seriesid===s&&(t=(e=_slicedToArray(e.geometry.coordinates,2))[0],e=e[1],r=Math.abs(e-l),n=Math.abs(t-a),!(.5<r||.5<n))&&A(l,a,e,t)<=c}).map(function(e){var t=_slicedToArray(e.geometry.coordinates,2),r=t[0],t=A(l,a,t[1],r);return _objectSpread(_objectSpread({},e),{},{distance:t})}).sort(function(e,t){return e.distance-t.distance})):[]}(_(),S.allParkruns)).length?((t=N(t)).className=\"parkrun-comparison-selector-controls\",C.appendChild(t)):((t=document.createElement(\"div\")).style.padding=\"10px\",t.style.color=w.subtleTextColor,t.style.textAlign=\"center\",t.style.fontSize=\"13px\",e=_(),t.textContent=\"No nearby parkruns found for comparison (within 50km of \".concat(e.eventName,\")\"),C.appendChild(t),console.log(\"Current event:\",e.eventName,\"Total parkruns loaded:\",S.allParkruns.length)),0<S.comparisonEvents.length&&((l=document.createElement(\"div\")).id=\"selectedEventsDisplay\",l.style.display=\"flex\",l.style.gap=\"8px\",l.style.flexWrap=\"wrap\",l.style.marginTop=\"10px\",k(),t={container:l,updateDisplay:k},C.appendChild(t.container)),e=x,(t=document.createElement(\"div\")).id=\"eventTabs\",t.style.marginTop=\"15px\",(s=document.createElement(\"div\")).style.display=\"flex\",s.style.gap=\"5px\",s.style.borderBottom=\"2px solid \".concat(w.gridColor),s.style.marginBottom=\"15px\",(c=document.createElement(\"div\")).id=\"tabContents\",e.forEach(function(e,r){var t=document.createElement(\"button\");t.textContent=e.title||e.eventName,t.style.padding=\"10px 20px\",t.style.backgroundColor=0===r?E[r%E.length]:\"#3a3250\",t.style.color=0===r?\"#2b223d\":w.textColor,t.style.border=\"none\",t.style.borderRadius=\"6px 6px 0 0\",t.style.cursor=\"pointer\",t.style.fontWeight=\"bold\",t.dataset.index=r,t.addEventListener(\"click\",function(){s.querySelectorAll(\"button\").forEach(function(e,t){e.style.backgroundColor=t===r?E[t%E.length]:\"#3a3250\",e.style.color=t===r?\"#2b223d\":w.textColor}),c.querySelectorAll(\".tab-content\").forEach(function(e,t){e.style.display=t===r?\"block\":\"none\"})}),s.appendChild(t)}),t.appendChild(s),t.appendChild(c),i=(t={tabsContainer:t,tabContents:c}).tabContents,C.appendChild(t.tabsContainer),x.forEach(function(e,t){e=j(e,t);e&&i.appendChild(e)}),1<x.length&&(y=(t=x).length<2?null:((x=document.createElement(\"div\")).id=\"comparisonSection\",x.style.marginTop=\"30px\",x.style.padding=\"15px\",x.style.backgroundColor=w.backgroundColor,x.style.borderRadius=\"8px\",(u=document.createElement(\"h3\")).textContent=\"Comparison Charts\",u.style.textAlign=\"center\",u.style.color=w.barColor,u.style.marginBottom=\"20px\",x.appendChild(u),u=t.map(function(e){return{event:e,yearly:F(e)}}),d=new Set,u.forEach(function(e){e.yearly.forEach(function(e){return d.add(e.year)})}),t=Array.from(d).sort(function(e,t){return e-t}),(y=document.createElement(\"div\")).style.display=\"grid\",y.style.gridTemplateColumns=\"1fr 1fr\",y.style.gap=\"20px\",g=document.createElement(\"canvas\"),y.appendChild(O(g)),b=document.createElement(\"canvas\"),y.appendChild(O(b)),v=document.createElement(\"canvas\"),y.appendChild(O(v)),p=document.createElement(\"canvas\"),y.appendChild(O(p)),x.appendChild(y),(y=document.createElement(\"div\")).style.display=\"flex\",y.style.justifyContent=\"center\",y.style.marginTop=\"20px\",y.style.gap=\"10px\",y.style.flexWrap=\"wrap\",(m=document.createElement(\"button\")).textContent=\"üìÑ Export HTML\",m.style.padding=\"8px 16px\",m.style.backgroundColor=w.barColor,m.style.color=\"#1c1b2a\",m.style.border=\"none\",m.style.borderRadius=\"4px\",m.style.cursor=\"pointer\",m.style.fontWeight=\"bold\",m.style.fontSize=\"14px\",(h=document.createElement(\"button\")).textContent=\"üì§ Share Report\",h.style.padding=\"8px 16px\",h.style.backgroundColor=w.lineColor,h.style.color=\"#2b223d\",h.style.border=\"none\",h.style.borderRadius=\"4px\",h.style.cursor=\"pointer\",h.style.fontWeight=\"bold\",h.style.fontSize=\"14px\",f=function(){var t=_(),e=null==(e=S.allParkruns)?void 0:e.find(function(e){return e.properties.eventname===t.eventName}),e=(null==e||null==(e=e.properties)?void 0:e.EventShortName)||t.eventName,r=new Date,n=r.toISOString().split(\"T\")[0];return{eventShortName:e,generatedAt:r.toLocaleString(),generatedAtISO:n}},m.addEventListener(\"click\",_asyncToGenerator(_regenerator().m(function e(){var t,r,n,o,a,l,i;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=m.textContent,r=m.style.display,m.textContent=\"Exporting...\",m.disabled=!0,m.style.display=\"none\",e.p=1,n=document.querySelector(\".parkrun-annual-summary\")){e.n=2;break}throw new Error(\"Report container not found\");case 2:return o=f(),e.n=3,T(n,o);case 3:o=e.v,l=o.blob,i=o.filename,a=URL.createObjectURL(l),(l=document.createElement(\"a\")).href=a,l.download=i,l.click(),setTimeout(function(){return URL.revokeObjectURL(a)},1e3),console.log(\"Annual summary HTML export complete\"),e.n=5;break;case 4:e.p=4,i=e.v,console.error(\"Annual summary export failed:\",i),alert(\"Error exporting HTML: \"+i.message);case 5:return e.p=5,m.disabled=!1,m.textContent=t,m.style.display=r,e.f(5);case 6:return e.a(2)}},e,null,[[1,4,5,6]])}))),h.addEventListener(\"click\",_asyncToGenerator(_regenerator().m(function e(){var t,r,n,o,a,l,i,s,c;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=h.textContent,r=h.style.display,h.textContent=\"Sharing...\",h.disabled=!0,h.style.display=\"none\",e.p=1,n=document.querySelector(\".parkrun-annual-summary\")){e.n=2;break}throw new Error(\"Report container not found\");case 2:return o=f(),e.n=3,T(n,o);case 3:if(l=e.v,a=l.blob,l=l.filename,s=new File([a],l,{type:\"text/html\"}),navigator.canShare&&navigator.canShare({files:[s]}))return e.n=4,navigator.share({title:\"parkrun Annual Summary - \".concat(o.eventShortName),text:\"Annual participation summary report\",files:[s]});e.n=5;break;case 4:console.log(\"Annual summary shared via Web Share API\"),e.n=6;break;case 5:i=URL.createObjectURL(a),(s=document.createElement(\"a\")).href=i,s.download=l,s.click(),setTimeout(function(){return URL.revokeObjectURL(i)},1e3),alert(\"Sharing is not supported in this browser, so the HTML report was downloaded instead.\");case 6:e.n=8;break;case 7:e.p=7,c=e.v,console.error(\"Annual summary share failed:\",c),alert(\"Error sharing report: \"+c.message);case 8:return e.p=8,h.disabled=!1,h.textContent=t,h.style.display=r,e.f(8);case 9:return e.a(2)}},e,null,[[1,7,8,9]])}))),y.appendChild(m),y.appendChild(h),x.appendChild(y),\"undefined\"!=typeof Chart&&(V(g,\"Annual Totals - Finishers\",t,u,function(e){return e.totalFinishers},\"Finishers\"),V(b,\"Annual Totals - Volunteers\",t,u,function(e){return e.totalVolunteers},\"Volunteers\"),V(v,\"YoY Growth - Finishers (%)\",t,u,function(e){return e.finishersGrowth},\"Growth (%)\",!0),V(p,\"YoY Growth - Volunteers (%)\",t,u,function(e){return e.volunteersGrowth},\"Growth (%)\",!0)),x))&&C.appendChild(y),(g=document.getElementById(\"eventHistoryChart\"))&&g.parentElement?g.parentElement.parentNode.insertBefore(C,g.parentElement.nextSibling):(b=\"h1\",v=C,(b=document.querySelector(b))&&b.parentNode&&(b.nextSibling?b.parentNode.insertBefore(v,b.nextSibling):b.parentNode.appendChild(v))))}function t(){return(t=_asyncToGenerator(_regenerator().m(function e(){var t,r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t=document.querySelector(\".Results-table\"),r=window.location.href,r=r.includes(\"/eventhistory/\"),t&&r){e.n=1;break}return e.a(2);case 1:return e.n=2,function(){return n.apply(this,arguments)}();case 2:S.allParkruns=e.v,document.getElementById(\"annualSummaryTable\")||document.getElementById(\"eventTabs\")?console.log(\"Annual summary already exists, skipping render\"):G();case 3:return e.a(2)}},e)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()})();"
  },
  "p-index.user.js": {
    "name": "parkrun p-index display",
    "description": "The parkrun p-index is an unofficial statistic that measures the number of different parkrun events a person has completed a specific number of times. To achieve a p-index of 10, you must have completed at least 10 different parkrun events 10 times each. This script calculate the p-index for a parkrunner and displays it on their results page.",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/p-index.user.js",
    "bookmarklet": "javascript:function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(t,e){var n;if(t)return\"string\"==typeof t?_arrayLikeToArray(t,e):\"Map\"===(n=\"Object\"===(n={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||\"Set\"===n?Array.from(t):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _iterableToArrayLimit(t,e){var n=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=n){var r,o,i,a,l=[],d=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;d=!1}else for(;!(d=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);d=!0);}catch(t){s=!0,o=t}finally{try{if(!d&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}function _arrayWithHoles(t){if(Array.isArray(t))return t}(()=>{function t(){return window.innerWidth<768?{isMobile:!0,spacing:{small:\"10px\",medium:\"15px\"},container:{padding:\"10px\",marginTop:\"10px\",width:\"100%\",maxWidth:\"800px\",aspectRatio:\"auto\"},typography:{pIndex:\"1.2em\",listItem:\"0.9em\"},listItem:{marginBottom:\"5px\",textAlign:\"left\"},button:{padding:\"6px 12px\",fontSize:\"0.9em\",marginTop:\"10px\"}}:{isMobile:!1,spacing:{small:\"20px\",medium:\"20px\"},container:{padding:\"20px\",marginTop:\"20px\",width:\"auto\",maxWidth:\"none\",aspectRatio:\"1\"},typography:{pIndex:\"1.5em\",listItem:\"1em\"},listItem:{marginBottom:\"8px\",textAlign:\"center\"},button:{padding:\"8px 15px\",fontSize:\"1em\",marginTop:\"15px\"}}}var e,n,r,o,i,a,l,d;function s(t){var r=[],t=(t.querySelectorAll(\"tbody > tr\").forEach(function(t){var e=t.querySelector(\"td:nth-child(1) > a\").textContent.trim(),n=t.querySelector(\"td:nth-child(2)\").textContent.trim(),t=t.querySelector(\"td:nth-child(3)\").textContent.trim();r.unshift({eventName:e,date:n,eventNumber:t})}),r.reduce(function(t,e){var n=e.eventName,r=e.date,e=e.eventNumber;return t[n]||(t[n]=[]),t[n].push({date:r,eventNumber:e}),t},{}));return Object.entries(t).sort(function(t,e){return e[1].length-t[1].length})}function u(){var t=document.querySelectorAll(\"#results\");return t[t.length-1]}function c(t){var t=t.filter(function(t,e){return _slicedToArray(t,2)[1].length>e}),o=t.length;function i(t){return new Date(t.split(\"/\").reverse().join(\"-\"))}t=t.map(function(t){var t=_slicedToArray(t,2),e=t[0],t=t[1],n=t[0],r=t[o-1];return{eventName:e,eventCount:t.length,firstDate:n.date,firstEventNumber:n.eventNumber,pIndexDate:r.date,pIndexEventNumber:r.eventNumber,firstDateForSorting:i(n.date),pIndexDateForSorting:i(r.date)}}).sort(function(t,e){return t.pIndexDateForSorting-e.pIndexDateForSorting}).slice(0,o).map(function(t){return t.eventName+\" (\"+t.eventCount+\"): \"+t.firstDate+\" (#\"+t.firstEventNumber+\") - \"+t.pIndexDate+\" (#\"+t.pIndexEventNumber+\")\"});return{pIndex:o,contributingEvents:t}}\"undefined\"!=typeof module&&module.exports?module.exports={calculatePIndex:c,extractEventDetails:s,findResultsTable:u}:(d=u())?(e=(d=c(s(d))).pIndex,d=d.contributingEvents,a=t(),(l=document.querySelector(\"h2\"))&&((n=document.createElement(\"div\")).textContent=\"p-index: \"+e,n.style.fontSize=a.typography.pIndex,n.style.fontWeight=\"bold\",n.style.marginTop=a.container.marginTop,n.style.backgroundColor=\"#2b223d\",n.style.color=\"#ffa300\",n.style.padding=a.container.padding,n.style.borderRadius=\"5px\",n.style.display=\"flex\",n.style.flexDirection=\"column\",n.style.alignItems=\"center\",n.style.justifyContent=\"center\",n.style.width=a.container.width,n.style.maxWidth=a.container.maxWidth,n.style.marginLeft=\"auto\",n.style.marginRight=\"auto\",n.style.aspectRatio=a.container.aspectRatio,n.setAttribute(\"id\",\"p-index-display\"),(r=document.createElement(\"ul\")).style.listStyleType=\"none\",r.style.padding=\"0\",r.style.marginTop=a.spacing.small,r.style.width=\"100%\",d.forEach(function(t){var e=document.createElement(\"li\");e.textContent=t,e.style.fontWeight=\"normal\",e.style.fontSize=a.typography.listItem,e.style.marginBottom=a.listItem.marginBottom,e.style.textAlign=a.listItem.textAlign,e.style.wordBreak=\"break-word\",r.appendChild(e)}),n.appendChild(r),o=n,e=t(),(d=document.createElement(\"div\")).style.marginTop=e.button.marginTop,d.id=\"p-index-download-btn-container\",(i=document.createElement(\"button\")).textContent=\"üíæ Save as Image\",i.style.padding=e.button.padding,i.style.backgroundColor=\"#ffa300\",i.style.color=\"#2b223d\",i.style.border=\"none\",i.style.borderRadius=\"4px\",i.style.cursor=\"pointer\",i.style.fontWeight=\"bold\",i.style.fontSize=e.button.fontSize,i.addEventListener(\"mouseover\",function(){this.style.backgroundColor=\"#e59200\"}),i.addEventListener(\"mouseout\",function(){this.style.backgroundColor=\"#ffa300\"}),i.addEventListener(\"click\",function(){i.style.display=\"none\",html2canvas(o,{backgroundColor:\"#2b223d\",scale:2,logging:!1,allowTaint:!0,useCORS:!0}).then(function(t){i.style.display=\"block\";var e=document.createElement(\"a\"),n=(new Date).toISOString().split(\"T\")[0],r=window.location.pathname.split(\"/\")[2]||\"parkrunner\";e.download=\"p-index-\".concat(r,\"-\").concat(n,\".png\"),e.href=t.toDataURL(\"image/png\"),e.click()})}),d.appendChild(i),o.appendChild(d),l.parentNode.insertBefore(n,l.nextSibling),a.isMobile||setTimeout(function(){var t=n.getBoundingClientRect(),t=Math.max(t.width,t.height);n.style.width=t+\"px\",n.style.height=t+\"px\"},0))):console.error(\"Results table not found\")})();"
  },
  "launch-returnees.user.js": {
    "name": "parkrun Launch Returnees",
    "description": "Identifies and displays participants who attended both the launch event and the latest event",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/launch-returnees.user.js",
    "bookmarklet": "javascript:function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(e,r){var t;if(e)return\"string\"==typeof e?_arrayLikeToArray(e,r):\"Map\"===(t=\"Object\"===(t={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||\"Set\"===t?Array.from(e):\"Arguments\"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}function _iterableToArray(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function _regenerator(){var d,e=\"function\"==typeof Symbol?Symbol:{},r=e.iterator||\"@@iterator\",t=e.toStringTag||\"@@toStringTag\";function n(e,r,t,n){var o,a,i,c,u,l,f,s,p,r=r&&r.prototype instanceof g?r:g,r=Object.create(r.prototype);return _regeneratorDefine2(r,\"_invoke\",(o=e,a=t,f=n||[],s=!1,p={p:l=0,n:0,v:d,a:y,f:y.bind(d,4),d:function(e,r){return i=e,c=0,u=d,p.n=r,h}},function(e,r,t){if(1<l)throw TypeError(\"Generator is already running\");for(s&&1===r&&y(r,t),c=r,u=t;(m=c<2?d:u)||!s;){i||(c?c<3?(1<c&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(m=i[e=c?e:\"next\"]){if(!(m=m.call(i,u)))throw TypeError(\"iterator result is not an object\");if(!m.done)return m;u=m.value,c<2&&(c=0)}else 1===c&&(m=i.return)&&m.call(i),c<2&&(u=TypeError(\"The iterator does not provide a '\"+e+\"' method\"),c=1);i=d}else if((m=(s=p.n<0)?u:o.call(a,p))!==h)break}catch(e){i=d,c=1,u=e}finally{l=1}}return{value:m,done:s}}),!0),r;function y(e,r){for(c=e,u=r,m=0;!s&&l&&!t&&m<f.length;m++){var t,n=f[m],o=p.p,a=n[2];3<e?(t=a===r)&&(u=n[(c=n[4])?5:c=3],n[4]=n[5]=d):n[0]<=o&&((t=e<2&&o<n[1])?(c=0,p.v=r,p.n=n[1]):o<a&&(t=e<3||n[0]>r||a<r)&&(n[4]=e,n[5]=r,p.n=a,c=0))}if(t||1<e)return h;throw s=!0,r}}var h={};function g(){}function o(){}function a(){}var m=Object.getPrototypeOf,e=[][r]?m(m([][r]())):(_regeneratorDefine2(m={},r,function(){return this}),m),i=a.prototype=g.prototype=Object.create(e);function c(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,_regeneratorDefine2(e,t,\"GeneratorFunction\")),e.prototype=Object.create(i),e}return _regeneratorDefine2(i,\"constructor\",o.prototype=a),_regeneratorDefine2(a,\"constructor\",o),_regeneratorDefine2(a,t,o.displayName=\"GeneratorFunction\"),_regeneratorDefine2(i),_regeneratorDefine2(i,t,\"Generator\"),_regeneratorDefine2(i,r,function(){return this}),_regeneratorDefine2(i,\"toString\",function(){return\"[object Generator]\"}),(_regenerator=function(){return{w:n,m:c}})()}function _regeneratorDefine2(e,r,t,n){var a=Object.defineProperty;try{a({},\"\",{})}catch(e){a=0}(_regeneratorDefine2=function(e,r,t,n){function o(r,t){_regeneratorDefine2(e,r,function(e){return this._invoke(r,t,e)})}r?a?a(e,r,{value:t,enumerable:!n,configurable:!n,writable:!n}):e[r]=t:(o(\"next\",0),o(\"throw\",1),o(\"return\",2))})(e,r,t,n)}function asyncGeneratorStep(e,r,t,n,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void t(e)}c.done?r(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(r,t){var n=c.apply(e,i);function o(e){asyncGeneratorStep(n,r,t,o,a,\"next\",e)}function a(e){asyncGeneratorStep(n,r,t,o,a,\"throw\",e)}o(void 0)})}}_asyncToGenerator(_regenerator().m(function e(){var i,f,a,c,r,u,l,s,p,y,d,h,t,n;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(n=function(){return(n=_asyncToGenerator(_regenerator().m(function e(){var r,t,n,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return o=window.location.pathname,o=o.match(/\\/([^/]+)\\/results\\/latestresults/),o=o[1],r=window.location.origin,o=\"\".concat(r,\"/\").concat(o,\"/results/1/\"),t=a(),e.n=1,c(o);case 1:n=e.v,o=_toConsumableArray(t.keys()).filter(function(e){return n.has(e)}),h(o,t,n,r);case 2:return e.a(2)}},e)}))).apply(this,arguments)},t=function(){return n.apply(this,arguments)},h=function(e,r,t,n){var o=d(),a=l(\"Participants Who Attended the Launch Event\");o.appendChild(a),0===e.length?(a=s(\"No attendees from the launch event were present at the latest event.\"),o.appendChild(a)):(a=y(e,r,t,n),o.appendChild(a)),u(o)},d=function(){var e=document.createElement(\"div\");return e.id=\"parkrun-launch-returnees\",e.style.width=\"100%\",e.style.maxWidth=\"800px\",e.style.margin=\"20px auto\",e.style.padding=\"15px\",e.style.backgroundColor=i.backgroundColor,e.style.borderRadius=\"8px\",e.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",e.style.color=i.textColor,e},y=function(e,r,t,n){var o=document.createElement(\"div\"),a=(o.style.maxHeight=\"400px\",o.style.overflow=\"auto\",document.createElement(\"ul\"));return a.style.listStyleType=\"none\",a.style.padding=\"0\",a.style.margin=\"0\",a.style.textAlign=\"center\",e.forEach(function(e){e=p(e,r,t,n);a.appendChild(e)}),o.appendChild(a),o},p=function(e,r,t,n){var o=document.createElement(\"li\"),a=document.createElement(\"a\"),n=(a.href=\"\".concat(n,\"/parkrunner/\").concat(e,\"/\"),a.target=\"_blank\",r.get(e)||t.get(e)||\"Unknown parkrunner\");return a.textContent=\"\".concat(n,\" (A\").concat(e,\")\"),a.style.color=i.linkColor,a.style.textDecoration=\"none\",o.appendChild(a),o},s=function(e){var r=document.createElement(\"p\");return r.textContent=e,r.style.textAlign=\"center\",r.style.fontWeight=\"bold\",r},l=function(e){var r=document.createElement(\"h3\");return r.textContent=e,r.style.textAlign=\"center\",r.style.marginBottom=\"15px\",r.style.color=i.headerColor,r},u=function(e){var r=document.querySelector(\"h1\");r&&r.parentNode?r.nextSibling?r.parentNode.insertBefore(e,r.nextSibling):r.parentNode.appendChild(e):document.body.insertBefore(e,document.body.firstChild)},r=function(){return(r=_asyncToGenerator(_regenerator().m(function e(r){var t,n,o,a,i,c,u,l;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=\"parkrun-launch-returnees-\".concat(r),e.p=1,n=localStorage.getItem(t))if(n=JSON.parse(n),o=n.data,n=n.timestamp,Date.now()-n<f)return e.a(2,new Map(o));e.n=2;break;case 2:return e.n=3,fetch(r);case 3:return n=e.v,e.n=4,n.text();case 4:for(o=e.v,l=new DOMParser,l=l.parseFromString(o,\"text/html\"),a=l.querySelectorAll('a[href*=\"/parkrunner/\"]'),i=new Map,c=0;c<a.length;c++)(u=a[c].href.match(/\\/parkrunner\\/(\\d+)/))&&i.set(u[1],a[c].textContent.trim());return l={data:Array.from(i.entries()),timestamp:Date.now()},localStorage.setItem(t,JSON.stringify(l)),e.a(2,i);case 5:return e.p=5,l=e.v,console.error(\"Error fetching or parsing:\",r,l),e.a(2,new Map)}},e,null,[[1,5]])}))).apply(this,arguments)},c=function(e){return r.apply(this,arguments)},a=function(){for(var e=document.querySelectorAll('a[href*=\"/parkrunner/\"]'),r=new Map,t=0;t<e.length;t++){var n=e[t].href.match(/\\/parkrunner\\/(\\d+)/);n&&r.set(n[1],e[t].textContent.trim())}return r},document.getElementById(\"parkrun-launch-returnees\"))return e.a(2);e.n=1;break;case 1:i={backgroundColor:\"#2b223d\",headerColor:\"#FFA300\",textColor:\"#EEE\",linkColor:\"#53BA9D\"},f=864e5,t();case 2:return e.a(2)}},e)}))();"
  },
  "junior-group-sunday-link.user.js": {
    "name": "junior parkrun Group Sunday Link",
    "description": "Adds a link to the consolidated club report for the most recent Sunday on junior parkrun group pages",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/junior-group-sunday-link.user.js",
    "bookmarklet": "javascript:function findConsolidatedClubLink(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;return Array.from(t.querySelectorAll(\"a\")).find(function(t){return t.href.includes(\"/consolidatedclub/?\")})||null}function extractClubNumFromLink(t){try{return new URL(t.href).searchParams.get(\"clubNum\")}catch(t){return null}}function getMostRecentSunday(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Date,e=new Date(t);return e.setDate(t.getDate()-t.getDay()),e}function formatDateYYYYMMDD(t){var e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,\"0\"),t=String(t.getDate()).padStart(2,\"0\");return\"\".concat(e,\"-\").concat(n,\"-\").concat(t)}function buildSundayLink(t,e,n){e=\"https://www.parkrun.com/results/consolidatedclub/?clubNum=\".concat(e,\"&eventdate=\").concat(n),n=t.cloneNode(!0);return n.href=e,n.textContent=\"View the consolidated club report for member participation at last Sunday's junior parkruns\",n}function insertAfter(t,e){t.parentNode.insertBefore(document.createElement(\"br\"),t.nextSibling),t.parentNode.insertBefore(e,t.nextSibling.nextSibling)}(()=>{var t,e=findConsolidatedClubLink();e&&(t=extractClubNumFromLink(e))&&insertAfter(e,buildSundayLink(e,t,formatDateYYYYMMDD(getMostRecentSunday())))})(),\"undefined\"!=typeof module&&void 0!==module.exports&&(module.exports={findConsolidatedClubLink:findConsolidatedClubLink,extractClubNumFromLink:extractClubNumFromLink,getMostRecentSunday:getMostRecentSunday,formatDateYYYYMMDD:formatDateYYYYMMDD,buildSundayLink:buildSundayLink,insertAfter:insertAfter});"
  },
  "compass-challenge.user.js": {
    "name": "parkrun Compass Challenge",
    "description": "Visualizes your progress on the compass challenge (North, South, East, West parkruns)",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/compass-challenge.user.js",
    "bookmarklet": "javascript:function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(t,e){var n;if(t)return\"string\"==typeof t?_arrayLikeToArray(t,e):\"Map\"===(n=\"Object\"===(n={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||\"Set\"===n?Array.from(t):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=Array(e);n<e;n++)o[n]=t[n];return o}function _iterableToArrayLimit(t,e){var n=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=n){var o,a,r,i,c=[],s=!0,l=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=r.call(n)).done)&&(c.push(o.value),c.length!==e);s=!0);}catch(t){l=!0,a=t}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw a}}return c}}function _arrayWithHoles(t){if(Array.isArray(t))return t}(()=>{var t,e,h={backgroundColor:\"#2b223d\",accentColor:\"#FFA300\",completedColor:\"#53BA9D\",pendingColor:\"#666\",textColor:\"#e0e0e0\",subtleTextColor:\"#cccccc\"},y={north:/north/i,south:/south/i,east:/east/i,west:/west/i};function s(){return window.innerWidth<768?{isMobile:!0,spacing:{small:\"10px\",medium:\"15px\",statsMarginBottom:\"8px\",completionMarginTop:\"8px\"},container:{padding:\"10px\",marginTop:\"10px\"},typography:{heading:\"1.1em\",stats:\"1em\",statsSubtext:\"0.9em\",completion:\"0.95em\"},compass:{baseSize:320},button:{padding:\"6px 12px\",fontSize:\"0.9em\",marginTop:\"10px\"}}:{isMobile:!1,spacing:{small:\"20px\",medium:\"20px\",statsMarginBottom:\"10px\",completionMarginTop:\"10px\"},container:{padding:\"20px\",marginTop:\"20px\"},typography:{heading:\"1.3em\",stats:\"1.2em\",statsSubtext:\"1em\",completion:\"1.1em\"},compass:{baseSize:700},button:{padding:\"8px 15px\",fontSize:\"1em\",marginTop:\"15px\"}}}function n(t){var e=s(),n=(n=\"Compass Challenge\",o=s(),(r=document.createElement(\"div\")).className=\"parkrun-compass-container\",r.style.width=\"100%\",r.style.maxWidth=\"800px\",r.style.margin=\"\".concat(o.container.marginTop,\" auto\"),r.style.padding=o.container.padding,r.style.backgroundColor=h.backgroundColor,r.style.borderRadius=\"8px\",r.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",r.style.textAlign=\"center\",(a=document.createElement(\"h3\")).textContent=n,a.style.marginBottom=o.spacing.small,a.style.color=h.accentColor,a.style.fontSize=o.typography.heading,r.appendChild(a),r),o=document.createElement(\"div\"),a=(o.style.marginBottom=e.spacing.small,o.style.color=h.textColor,'<div style=\"font-size: '.concat(e.typography.stats,\"; margin-bottom: \").concat(e.spacing.statsMarginBottom,';\"><strong>').concat(t.completedCount,\" of 4</strong> compass directions completed</div>\")),r=(a+='<div style=\"font-size: '.concat(e.typography.statsSubtext,';\">After ').concat(t.totalEvents,\" parkruns</div>\"),t.dateOfCompletion&&(a+='<div style=\"margin-top: '.concat(e.spacing.completionMarginTop,\"; font-size: \").concat(e.typography.completion,';\">üß≠ Challenge completed on ').concat(t.dateOfCompletion,\"</div>\")),o.innerHTML=a,n.appendChild(o),e.isMobile?Math.min(e.compass.baseSize,window.innerWidth-40):e.compass.baseSize),a=document.createElement(\"div\"),p=(a.style.position=\"relative\",a.style.width=\"\".concat(r,\"px\"),a.style.height=\"\".concat(r,\"px\"),a.style.margin=\"0 auto\",a.style.boxSizing=\"content-box\",document.createElementNS(\"http://www.w3.org/2000/svg\",\"svg\")),m=(p.setAttribute(\"width\",\"100%\"),p.setAttribute(\"height\",\"100%\"),p.setAttribute(\"viewBox\",\"0 0 \".concat(700,\" \").concat(700)),p.style.position=\"absolute\",p.style.top=\"0\",p.style.left=\"0\",350),b=350,o=document.createElementNS(\"http://www.w3.org/2000/svg\",\"circle\");o.setAttribute(\"cx\",m),o.setAttribute(\"cy\",b),o.setAttribute(\"r\",230),o.setAttribute(\"fill\",\"#334\"),o.setAttribute(\"stroke\",h.accentColor),o.setAttribute(\"stroke-width\",\"5\"),p.appendChild(o);[{name:\"north\",angle:270,label:\"N\",data:t.directions.north},{name:\"east\",angle:0,label:\"E\",data:t.directions.east},{name:\"south\",angle:90,label:\"S\",data:t.directions.south},{name:\"west\",angle:180,label:\"W\",data:t.directions.west}].forEach(function(t){var e=t.angle*(Math.PI/180),n=m+230*Math.cos(e),o=b+230*Math.sin(e),a=230*.12,r=m+115*Math.cos(e),i=b+115*Math.sin(e),c=e+Math.PI/2,s=r+a*Math.cos(c),l=i+a*Math.sin(c),r=r-a*Math.cos(c),i=i-a*Math.sin(c),a=document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),c=\"M \".concat(m,\" \").concat(b,\" L \").concat(s,\" \").concat(l,\" L \").concat(n,\" \").concat(o,\" L \").concat(r,\" \").concat(i,\" Z\"),s=(a.setAttribute(\"d\",c),a.setAttribute(\"fill\",t.data?h.completedColor:h.pendingColor),a.setAttribute(\"stroke\",\"#000\"),a.setAttribute(\"stroke-width\",\"1\"),a.setAttribute(\"stroke-opacity\",\"0.3\"),p.appendChild(a),m+115*Math.cos(e)),l=b+115*Math.sin(e),n=document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\");if(n.setAttribute(\"x\",s),n.setAttribute(\"y\",l),n.setAttribute(\"text-anchor\",\"middle\"),n.setAttribute(\"dominant-baseline\",\"middle\"),n.setAttribute(\"fill\",\"#fff\"),n.setAttribute(\"font-size\",\"28px\"),n.setAttribute(\"font-weight\",\"bold\"),n.setAttribute(\"stroke\",\"#000\"),n.setAttribute(\"stroke-width\",\"1\"),n.setAttribute(\"paint-order\",\"stroke\"),n.textContent=t.label,p.appendChild(n),t.data){var o=t.data.eventName.match(/(.+?)(?:\\s+parkrun)?$/i),r=o?o[1]:t.data.eventName,i=\"\".concat(r,\" - \").concat(t.data.date),c=\"text-path-\".concat(t.name),a=document.createElementNS(\"http://www.w3.org/2000/svg\",\"path\"),d=\"\",u=245;switch(t.name){case\"north\":d=\"M \".concat(180,\" \").concat(105,\" A \").concat(u,\" \").concat(u,\" 0 0 1 \").concat(520,\" \").concat(105);break;case\"east\":d=\"M \".concat(595,\" \").concat(180,\" A \").concat(u,\" \").concat(u,\" 0 0 1 \").concat(595,\" \").concat(520);break;case\"south\":d=\"M \".concat(180,\" \").concat(595,\" A \").concat(u,\" \").concat(u,\" 0 0 0 \").concat(520,\" \").concat(595);break;case\"west\":d=\"M \".concat(105,\" \").concat(520,\" A \").concat(u,\" \").concat(u,\" 0 0 1 \").concat(105,\" \").concat(180);break;default:console.warn(\"Unknown direction: \".concat(t.name))}a.setAttribute(\"id\",c),a.setAttribute(\"d\",d),a.setAttribute(\"fill\",\"none\"),p.appendChild(a);e=document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\"),s=(e.setAttribute(\"fill\",\"#FFFFFF\"),e.setAttribute(\"font-size\",\"14px\"),e.setAttribute(\"font-weight\",\"bold\"),document.createElementNS(\"http://www.w3.org/2000/svg\",\"textPath\"));s.setAttribute(\"href\",\"#\".concat(c)),s.setAttribute(\"startOffset\",\"50%\"),s.setAttribute(\"text-anchor\",\"middle\"),\"south\"===t.name&&s.setAttribute(\"side\",\"left\"),s.textContent=i,e.appendChild(s),p.appendChild(e)}});var i,c,e=document.createElementNS(\"http://www.w3.org/2000/svg\",\"defs\"),r=document.createElementNS(\"http://www.w3.org/2000/svg\",\"filter\"),o=(r.setAttribute(\"id\",\"text-shadow\"),r.setAttribute(\"x\",\"-20%\"),r.setAttribute(\"y\",\"-20%\"),r.setAttribute(\"width\",\"140%\"),r.setAttribute(\"height\",\"140%\"),document.createElementNS(\"http://www.w3.org/2000/svg\",\"feDropShadow\")),o=(o.setAttribute(\"dx\",\"0\"),o.setAttribute(\"dy\",\"0\"),o.setAttribute(\"stdDeviation\",\"2\"),o.setAttribute(\"flood-color\",\"#000000\"),o.setAttribute(\"flood-opacity\",\"0.7\"),r.appendChild(o),e.appendChild(r),p.appendChild(e),document.createElementNS(\"http://www.w3.org/2000/svg\",\"circle\")),r=(o.setAttribute(\"cx\",m),o.setAttribute(\"cy\",b),o.setAttribute(\"r\",30),o.setAttribute(\"fill\",h.accentColor),p.appendChild(o),document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\"));return r.setAttribute(\"x\",m),r.setAttribute(\"y\",b),r.setAttribute(\"text-anchor\",\"middle\"),r.setAttribute(\"dominant-baseline\",\"middle\"),r.setAttribute(\"fill\",h.backgroundColor),r.setAttribute(\"font-size\",\"24px\"),r.setAttribute(\"font-weight\",\"bold\"),r.textContent=\"\".concat(Math.round(t.completedCount/4*100),\"%\"),p.appendChild(r),a.appendChild(p),n.appendChild(a),i=n,e=s(),(o=document.createElement(\"div\")).style.marginTop=e.button.marginTop,o.id=\"compass-download-btn-container\",(c=document.createElement(\"button\")).textContent=\"üíæ Save as Image\",c.style.padding=e.button.padding,c.style.backgroundColor=h.accentColor,c.style.color=h.backgroundColor,c.style.border=\"none\",c.style.borderRadius=\"4px\",c.style.cursor=\"pointer\",c.style.fontWeight=\"bold\",c.style.fontSize=e.button.fontSize,c.addEventListener(\"mouseover\",function(){this.style.backgroundColor=\"#e59200\"}),c.addEventListener(\"mouseout\",function(){this.style.backgroundColor=h.accentColor}),c.addEventListener(\"click\",function(){c.style.display=\"none\",html2canvas(i,{backgroundColor:h.backgroundColor,scale:2,logging:!1,allowTaint:!0,useCORS:!0}).then(function(t){c.style.display=\"block\";var e=document.createElement(\"a\"),n=(new Date).toISOString().split(\"T\")[0],o=window.location.pathname.split(\"/\")[2]||\"parkrunner\";e.download=\"compass-challenge-\".concat(o,\"-\").concat(n,\".png\"),e.href=t.toDataURL(\"image/png\"),e.click()})}),o.appendChild(c),i.appendChild(o),n}document.querySelector(\"#results\")?(t=t=n((t=>{for(var e={north:null,south:null,east:null,west:null},n=0,o=null,a=0,t=t.querySelectorAll(\"tr\"),r=[],i=(t.forEach(function(t){var e,n,o,t=t.querySelectorAll(\"td\");t.length<5||(e=t[0].textContent.trim(),n=t[1].textContent.trim(),o=t[2].textContent.trim(),(t=t[4].textContent.trim())&&o&&n&&e&&r.push({eventName:e,date:n,eventNumber:o,time:t}))}),r.reverse()),c=0;!o&&c<i.length;c++){var s=i[c],l=s.eventName,d=s.date,u=s.eventNumber,p=s.time;a++;for(var m=0,b=Object.entries(y);m<b.length;m++){var h=_slicedToArray(b[m],2),g=h[0];h[1].test(l)&&!e[g]&&(e[g]={eventName:l,date:d,eventNumber:u,time:p},4===++n)&&(o=o||d)}}return{directions:e,completedCount:n,dateOfCompletion:o,totalEvents:a}})((t=document.querySelectorAll(\"#results\"))[t.length-1])),(e=document.querySelector(\"h2\"))&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t))):console.log(\"Results table not found\")})();"
  },
  "alphabet-challenge.user.js": {
    "name": "parkrun Alphabet Challenge",
    "description": "Tracks progress on the unofficial parkrun alphabet challenge (A-Z, excluding X) with a 5x5 grid visualization and download feature.",
    "rawUrl": "https://raw.githubusercontent.com/johnsyweb/tampermonkey-parkrun/refs/heads/main/alphabet-challenge.user.js",
    "bookmarklet": "javascript:function _createForOfIteratorHelper(e,t){var n,o,r,a,l=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(l)return r=!(o=!0),{s:function(){l=l.call(e)},n:function(){var e=l.next();return o=e.done,e},e:function(e){r=!0,n=e},f:function(){try{o||null==l.return||l.return()}finally{if(r)throw n}}};if(Array.isArray(e)||(l=_unsupportedIterableToArray(e))||t&&e&&\"number\"==typeof e.length)return l&&(e=l),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function _unsupportedIterableToArray(e,t){var n;if(e)return\"string\"==typeof e?_arrayLikeToArray(e,t):\"Map\"===(n=\"Object\"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}(()=>{var e,t,p=\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\".split(\"\").filter(function(e){return\"X\"!==e});function d(){return window.innerWidth<768?{isMobile:!0,spacing:{small:\"8px\",medium:\"10px\",large:\"10px\"},container:{padding:\"10px\",marginTop:\"10px\"},typography:{heading:\"1.1em\",stats:\"1em\",statsSubtext:\"0.9em\"},grid:{gapSize:\"5px\",marginTop:\"10px\",cellPadding:\"5px\",letterFontSize:\"1.2em\",letterMarginBottom:\"2px\",eventFontSize:\"0.7em\",dateFontSize:\"0.65em\"},button:{padding:\"6px 12px\",fontSize:\"0.9em\",marginTop:\"10px\"},heading:{marginBottom:\"10px\"}}:{isMobile:!1,spacing:{small:\"10px\",medium:\"15px\",large:\"20px\"},container:{padding:\"20px\",marginTop:\"20px\"},typography:{heading:\"1.3em\",stats:\"1.2em\",statsSubtext:\"1em\"},grid:{gapSize:\"10px\",marginTop:\"20px\",cellPadding:\"10px\",letterFontSize:\"1.5em\",letterMarginBottom:\"5px\",eventFontSize:\"0.8em\",dateFontSize:\"0.7em\"},button:{padding:\"8px 15px\",fontSize:\"1em\",marginTop:\"15px\"},heading:{marginBottom:\"15px\"}}}function n(a){var e,t,r,n=d(),o=document.createElement(\"div\"),l=(o.className=\"parkrun-alphabet-container\",o.style.width=\"100%\",o.style.maxWidth=\"800px\",o.style.margin=\"\".concat(n.container.marginTop,\" auto\"),o.style.padding=n.container.padding,o.style.backgroundColor=\"#2b223d\",o.style.borderRadius=\"8px\",o.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.1)\",o.style.color=\"#e0e0e0\",o.style.textAlign=\"center\",document.createElement(\"h3\")),l=(l.textContent=\"Alphabet Challenge\",l.style.marginBottom=n.heading.marginBottom,l.style.color=\"#FFA300\",l.style.fontSize=n.typography.heading,o.appendChild(l),document.createElement(\"div\")),i=(l.innerHTML='<div style=\"font-size: '.concat(n.typography.stats,\"; margin-bottom: \").concat(n.spacing.small,';\">')+\"<strong>\"+a.completedCount+\" of 25</strong> letters completed</div>\"+'<div style=\"font-size: '.concat(n.typography.statsSubtext,';\">After ')+a.totalEvents+\" parkruns</div>\"+(a.dateOfCompletion?'<div style=\"font-size: '.concat(n.typography.statsSubtext,';\">üéâ Challenge completed on: ').concat(a.dateOfCompletion,\"</div>\"):\"\"),o.appendChild(l),document.createElement(\"div\"));return i.style.display=\"grid\",i.style.gridTemplateColumns=\"repeat(5, 1fr)\",i.style.gap=n.grid.gapSize,i.style.marginTop=n.grid.marginTop,p.forEach(function(r){var e=document.createElement(\"div\"),t=(e.style.aspectRatio=\"1\",e.style.position=\"relative\",e.style.border=\"1px solid #666\",e.style.borderRadius=\"4px\",e.style.backgroundColor=a.completedLetters[r]?\"#FFA300\":\"#008080\",e.style.color=\"#fff\",e.style.display=\"flex\",e.style.flexDirection=\"column\",e.style.alignItems=\"flex-start\",e.style.justifyContent=\"flex-start\",e.style.padding=n.grid.cellPadding,e.style.fontWeight=\"bold\",e.style.fontSize=\"1em\",e.style.cursor=a.completedLetters[r]?\"pointer\":\"default\",document.createElement(\"div\"));t.textContent=r,t.style.fontSize=n.grid.letterFontSize,t.style.marginBottom=n.grid.letterMarginBottom,e.appendChild(t),a.completedLetters[r]&&((t=document.createElement(\"div\")).innerHTML='<div style=\"font-size: '.concat(n.grid.eventFontSize,'; text-align: left;\">')+a.completedLetters[r].eventName+\"<br>\"+'<span style=\"font-size: '.concat(n.grid.dateFontSize,';\">(')+a.completedLetters[r].date+\")</span></div>\",n.isMobile&&(t.style.display=\"none\"),e.appendChild(t),e.addEventListener(\"click\",function(){var e=d(),t=document.createElement(\"div\"),n=(t.style.position=\"fixed\",t.style.top=\"0\",t.style.left=\"0\",t.style.width=\"100%\",t.style.height=\"100%\",t.style.backgroundColor=\"rgba(0, 0, 0, 0.5)\",t.style.zIndex=\"999\",t.addEventListener(\"click\",function(){document.body.removeChild(t)}),document.createElement(\"div\")),o=(n.style.position=\"fixed\",n.style.top=\"50%\",n.style.left=\"50%\",n.style.transform=\"translate(-50%, -50%)\",n.style.backgroundColor=\"#2b223d\",n.style.color=\"#fff\",e.isMobile?\"15px\":\"20px\"),o=(n.style.padding=o,n.style.borderRadius=\"8px\",n.style.boxShadow=\"0 2px 4px rgba(0,0,0,0.5)\",n.style.zIndex=\"1000\",n.style.maxWidth=e.isMobile?\"95%\":\"90%\",n.style.maxHeight=e.isMobile?\"85%\":\"80%\",n.style.overflowY=\"auto\",n.style.fontSize=e.isMobile?\"0.9em\":\"1em\",document.createElement(\"h4\")),e=(o.textContent=\"Letter \".concat(r),o.style.marginBottom=\"10px\",o.style.color=\"#FFA300\",n.appendChild(o),document.createElement(\"div\"));e.style.marginBottom=\"10px\",e.innerHTML=\"<strong>\"+a.completedLetters[r].eventName+'</strong><br><span style=\"font-size: 0.9em;\">'+a.completedLetters[r].date+\"</span>\",n.appendChild(e),t.appendChild(n),document.body.appendChild(t)})),i.appendChild(e)}),o.appendChild(i),e=o,l=d(),(t=document.createElement(\"div\")).style.marginTop=l.button.marginTop,t.id=\"alphabet-download-btn-container\",(r=document.createElement(\"button\")).textContent=\"üíæ Save as Image\",r.style.padding=l.button.padding,r.style.backgroundColor=\"#FFA300\",r.style.color=\"#2b223d\",r.style.border=\"none\",r.style.borderRadius=\"4px\",r.style.cursor=\"pointer\",r.style.fontWeight=\"bold\",r.style.fontSize=l.button.fontSize,r.addEventListener(\"mouseover\",function(){this.style.backgroundColor=\"#e59200\"}),r.addEventListener(\"mouseout\",function(){this.style.backgroundColor=\"#FFA300\"}),r.addEventListener(\"click\",function(){r.style.display=\"none\",html2canvas(e,{backgroundColor:\"#2b223d\",scale:2,logging:!1,allowTaint:!0,useCORS:!0}).then(function(e){r.style.display=\"block\";var t=document.createElement(\"a\"),n=(new Date).toISOString().split(\"T\")[0],o=window.location.pathname.split(\"/\")[2]||\"parkrunner\";t.download=\"alphabet-challenge-\".concat(o,\"-\").concat(n,\".png\"),t.href=e.toDataURL(\"image/png\"),t.click()})}),t.appendChild(r),e.appendChild(t),o}(t=(t=document.querySelectorAll(\"#results\"))[t.length-1])?(t=t=n((e=>{var t,n={},o=0,r=null,a=_createForOfIteratorHelper(Array.from(e.querySelectorAll(\"tr\")).reverse());try{for(a.s();!(t=a.n()).done;){var l=t.value.querySelectorAll(\"td\");if(!(l.length<1)){var i=l[0].textContent.trim(),d=l[1].textContent.trim(),s=i.charAt(0).toUpperCase();if(o++,p.includes(s)&&!n[s]&&(n[s]={eventName:i,date:d},25===Object.keys(n).length)){r=d;break}}}}catch(e){a.e(e)}finally{a.f()}return e=Object.keys(n).length,{completedLetters:n,remainingLetters:p.filter(function(e){return!n[e]}),completedCount:e,dateOfCompletion:r,totalEvents:o}})(t)),(e=document.querySelector(\"h2\"))&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t))):console.log(\"Results table not found\")})();"
  }
}
